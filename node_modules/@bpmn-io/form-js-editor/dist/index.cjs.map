{"version":3,"file":"index.cjs","sources":["../../../node_modules/diagram-js/lib/core/EventBus.js","../src/core/Debounce.js","../src/core/FieldFactory.js","../src/core/FormFieldRegistry.js","../src/import/Importer.js","../src/import/index.js","../src/render/context/DragAndDropContext.js","../src/render/context/FormEditorContext.js","../src/render/hooks/useService.js","../src/features/properties-panel/icons/pp-list-delete.svg","../src/render/components/icons/Button.svg","../src/render/components/icons/Checkbox.svg","../src/render/components/icons/Checklist.svg","../src/render/components/icons/Taglist.svg","../src/render/components/icons/Form.svg","../src/render/components/icons/Group.svg","../src/render/components/icons/Number.svg","../src/render/components/icons/Radio.svg","../src/render/components/icons/Select.svg","../src/render/components/icons/Text.svg","../src/render/components/icons/Textfield.svg","../src/render/components/icons/index.js","../src/render/components/FormEditor.js","../src/render/Renderer.js","../src/render/index.js","../src/core/index.js","../../../node_modules/diagram-js/lib/features/editor-actions/EditorActions.js","../../../node_modules/diagram-js/lib/features/editor-actions/index.js","../src/features/editor-actions/FormEditorActions.js","../src/features/editor-actions/index.js","../../../node_modules/diagram-js/lib/features/keyboard/KeyboardUtil.js","../../../node_modules/diagram-js/lib/features/keyboard/Keyboard.js","../../../node_modules/diagram-js/lib/features/keyboard/KeyboardBindings.js","../../../node_modules/diagram-js/lib/features/keyboard/index.js","../src/features/keyboard/FormEditorKeyboardBindings.js","../src/features/keyboard/index.js","../src/features/modeling/cmd/Util.js","../src/features/modeling/cmd/AddFormFieldHandler.js","../src/features/modeling/cmd/EditFormFieldHandler.js","../src/features/modeling/cmd/MoveFormFieldHandler.js","../src/features/modeling/cmd/RemoveFormFieldHandler.js","../src/features/modeling/cmd/UpdateIdClaimHandler.js","../src/features/modeling/cmd/UpdateKeyClaimHandler.js","../src/features/modeling/Modeling.js","../../../node_modules/diagram-js/lib/command/CommandInterceptor.js","../src/features/modeling/behavior/IdBehavior.js","../src/features/modeling/behavior/KeyBehavior.js","../src/features/modeling/behavior/index.js","../../../node_modules/diagram-js/lib/command/CommandStack.js","../../../node_modules/diagram-js/lib/command/index.js","../src/features/modeling/index.js","../src/features/selection/Selection.js","../src/features/selection/SelectionBehavior.js","../src/features/selection/index.js","../src/features/palette/components/Palette.js","../src/features/palette/PaletteRenderer.js","../src/features/palette/index.js","../../../node_modules/@bpmn-io/properties-panel/dist/index.esm.js","../src/features/properties-panel/context/FormPropertiesPanelContext.js","../src/features/properties-panel/Util.js","../src/features/properties-panel/PropertiesPanelHeaderProvider.js","../src/features/properties-panel/PropertiesPanelPlaceholderProvider.js","../src/features/properties-panel/entries/ActionEntry.js","../src/features/properties-panel/hooks/usePropertiesPanelService.js","../src/features/properties-panel/entries/ColumnsEntry.js","../src/features/properties-panel/entries/DescriptionEntry.js","../src/features/properties-panel/entries/DefaultValueEntry.js","../src/features/properties-panel/entries/DisabledEntry.js","../src/features/properties-panel/entries/IdEntry.js","../src/features/properties-panel/entries/KeyEntry.js","../src/features/properties-panel/entries/LabelEntry.js","../src/features/properties-panel/entries/TextEntry.js","../src/features/properties-panel/entries/ValueEntry.js","../src/features/properties-panel/entries/CustomValueEntry.js","../src/features/properties-panel/entries/ValuesSourceUtil.js","../src/features/properties-panel/entries/ValuesSourceSelectEntry.js","../src/features/properties-panel/entries/InputKeyValuesSourceEntry.js","../src/features/properties-panel/entries/StaticValuesSourceEntry.js","../src/features/properties-panel/groups/GeneralGroup.js","../src/features/properties-panel/groups/ValidationGroup.js","../src/features/properties-panel/groups/ValuesGroups.js","../src/features/properties-panel/groups/CustomValuesGroup.js","../src/features/properties-panel/PropertiesPanel.js","../src/features/properties-panel/PropertiesPanelRenderer.js","../src/features/properties-panel/index.js","../src/FormEditor.js","../src/index.js"],"sourcesContent":["import {\n  isFunction,\n  isArray,\n  isNumber,\n  bind,\n  assign\n} from 'min-dash';\n\nvar FN_REF = '__fn';\n\nvar DEFAULT_PRIORITY = 1000;\n\nvar slice = Array.prototype.slice;\n\n/**\n * A general purpose event bus.\n *\n * This component is used to communicate across a diagram instance.\n * Other parts of a diagram can use it to listen to and broadcast events.\n *\n *\n * ## Registering for Events\n *\n * The event bus provides the {@link EventBus#on} and {@link EventBus#once}\n * methods to register for events. {@link EventBus#off} can be used to\n * remove event registrations. Listeners receive an instance of {@link Event}\n * as the first argument. It allows them to hook into the event execution.\n *\n * ```javascript\n *\n * // listen for event\n * eventBus.on('foo', function(event) {\n *\n *   // access event type\n *   event.type; // 'foo'\n *\n *   // stop propagation to other listeners\n *   event.stopPropagation();\n *\n *   // prevent event default\n *   event.preventDefault();\n * });\n *\n * // listen for event with custom payload\n * eventBus.on('bar', function(event, payload) {\n *   console.log(payload);\n * });\n *\n * // listen for event returning value\n * eventBus.on('foobar', function(event) {\n *\n *   // stop event propagation + prevent default\n *   return false;\n *\n *   // stop event propagation + return custom result\n *   return {\n *     complex: 'listening result'\n *   };\n * });\n *\n *\n * // listen with custom priority (default=1000, higher is better)\n * eventBus.on('priorityfoo', 1500, function(event) {\n *   console.log('invoked first!');\n * });\n *\n *\n * // listen for event and pass the context (`this`)\n * eventBus.on('foobar', function(event) {\n *   this.foo();\n * }, this);\n * ```\n *\n *\n * ## Emitting Events\n *\n * Events can be emitted via the event bus using {@link EventBus#fire}.\n *\n * ```javascript\n *\n * // false indicates that the default action\n * // was prevented by listeners\n * if (eventBus.fire('foo') === false) {\n *   console.log('default has been prevented!');\n * };\n *\n *\n * // custom args + return value listener\n * eventBus.on('sum', function(event, a, b) {\n *   return a + b;\n * });\n *\n * // you can pass custom arguments + retrieve result values.\n * var sum = eventBus.fire('sum', 1, 2);\n * console.log(sum); // 3\n * ```\n */\nexport default function EventBus() {\n  this._listeners = {};\n\n  // cleanup on destroy on lowest priority to allow\n  // message passing until the bitter end\n  this.on('diagram.destroy', 1, this._destroy, this);\n}\n\n\n/**\n * Register an event listener for events with the given name.\n *\n * The callback will be invoked with `event, ...additionalArguments`\n * that have been passed to {@link EventBus#fire}.\n *\n * Returning false from a listener will prevent the events default action\n * (if any is specified). To stop an event from being processed further in\n * other listeners execute {@link Event#stopPropagation}.\n *\n * Returning anything but `undefined` from a listener will stop the listener propagation.\n *\n * @param {string|Array<string>} events\n * @param {number} [priority=1000] the priority in which this listener is called, larger is higher\n * @param {Function} callback\n * @param {Object} [that] Pass context (`this`) to the callback\n */\nEventBus.prototype.on = function(events, priority, callback, that) {\n\n  events = isArray(events) ? events : [ events ];\n\n  if (isFunction(priority)) {\n    that = callback;\n    callback = priority;\n    priority = DEFAULT_PRIORITY;\n  }\n\n  if (!isNumber(priority)) {\n    throw new Error('priority must be a number');\n  }\n\n  var actualCallback = callback;\n\n  if (that) {\n    actualCallback = bind(callback, that);\n\n    // make sure we remember and are able to remove\n    // bound callbacks via {@link #off} using the original\n    // callback\n    actualCallback[FN_REF] = callback[FN_REF] || callback;\n  }\n\n  var self = this;\n\n  events.forEach(function(e) {\n    self._addListener(e, {\n      priority: priority,\n      callback: actualCallback,\n      next: null\n    });\n  });\n};\n\n\n/**\n * Register an event listener that is executed only once.\n *\n * @param {string} event the event name to register for\n * @param {number} [priority=1000] the priority in which this listener is called, larger is higher\n * @param {Function} callback the callback to execute\n * @param {Object} [that] Pass context (`this`) to the callback\n */\nEventBus.prototype.once = function(event, priority, callback, that) {\n  var self = this;\n\n  if (isFunction(priority)) {\n    that = callback;\n    callback = priority;\n    priority = DEFAULT_PRIORITY;\n  }\n\n  if (!isNumber(priority)) {\n    throw new Error('priority must be a number');\n  }\n\n  function wrappedCallback() {\n    wrappedCallback.__isTomb = true;\n\n    var result = callback.apply(that, arguments);\n\n    self.off(event, wrappedCallback);\n\n    return result;\n  }\n\n  // make sure we remember and are able to remove\n  // bound callbacks via {@link #off} using the original\n  // callback\n  wrappedCallback[FN_REF] = callback;\n\n  this.on(event, priority, wrappedCallback);\n};\n\n\n/**\n * Removes event listeners by event and callback.\n *\n * If no callback is given, all listeners for a given event name are being removed.\n *\n * @param {string|Array<string>} events\n * @param {Function} [callback]\n */\nEventBus.prototype.off = function(events, callback) {\n\n  events = isArray(events) ? events : [ events ];\n\n  var self = this;\n\n  events.forEach(function(event) {\n    self._removeListener(event, callback);\n  });\n\n};\n\n\n/**\n * Create an EventBus event.\n *\n * @param {Object} data\n *\n * @return {Object} event, recognized by the eventBus\n */\nEventBus.prototype.createEvent = function(data) {\n  var event = new InternalEvent();\n\n  event.init(data);\n\n  return event;\n};\n\n\n/**\n * Fires a named event.\n *\n * @example\n *\n * // fire event by name\n * events.fire('foo');\n *\n * // fire event object with nested type\n * var event = { type: 'foo' };\n * events.fire(event);\n *\n * // fire event with explicit type\n * var event = { x: 10, y: 20 };\n * events.fire('element.moved', event);\n *\n * // pass additional arguments to the event\n * events.on('foo', function(event, bar) {\n *   alert(bar);\n * });\n *\n * events.fire({ type: 'foo' }, 'I am bar!');\n *\n * @param {string} [name] the optional event name\n * @param {Object} [event] the event object\n * @param {...Object} additional arguments to be passed to the callback functions\n *\n * @return {boolean} the events return value, if specified or false if the\n *                   default action was prevented by listeners\n */\nEventBus.prototype.fire = function(type, data) {\n  var event,\n      firstListener,\n      returnValue,\n      args;\n\n  args = slice.call(arguments);\n\n  if (typeof type === 'object') {\n    data = type;\n    type = data.type;\n  }\n\n  if (!type) {\n    throw new Error('no event type specified');\n  }\n\n  firstListener = this._listeners[type];\n\n  if (!firstListener) {\n    return;\n  }\n\n  // we make sure we fire instances of our home made\n  // events here. We wrap them only once, though\n  if (data instanceof InternalEvent) {\n\n    // we are fine, we alread have an event\n    event = data;\n  } else {\n    event = this.createEvent(data);\n  }\n\n  // ensure we pass the event as the first parameter\n  args[0] = event;\n\n  // original event type (in case we delegate)\n  var originalType = event.type;\n\n  // update event type before delegation\n  if (type !== originalType) {\n    event.type = type;\n  }\n\n  try {\n    returnValue = this._invokeListeners(event, args, firstListener);\n  } finally {\n\n    // reset event type after delegation\n    if (type !== originalType) {\n      event.type = originalType;\n    }\n  }\n\n  // set the return value to false if the event default\n  // got prevented and no other return value exists\n  if (returnValue === undefined && event.defaultPrevented) {\n    returnValue = false;\n  }\n\n  return returnValue;\n};\n\n\nEventBus.prototype.handleError = function(error) {\n  return this.fire('error', { error: error }) === false;\n};\n\n\nEventBus.prototype._destroy = function() {\n  this._listeners = {};\n};\n\nEventBus.prototype._invokeListeners = function(event, args, listener) {\n\n  var returnValue;\n\n  while (listener) {\n\n    // handle stopped propagation\n    if (event.cancelBubble) {\n      break;\n    }\n\n    returnValue = this._invokeListener(event, args, listener);\n\n    listener = listener.next;\n  }\n\n  return returnValue;\n};\n\nEventBus.prototype._invokeListener = function(event, args, listener) {\n\n  var returnValue;\n\n  if (listener.callback.__isTomb) {\n    return returnValue;\n  }\n\n  try {\n\n    // returning false prevents the default action\n    returnValue = invokeFunction(listener.callback, args);\n\n    // stop propagation on return value\n    if (returnValue !== undefined) {\n      event.returnValue = returnValue;\n      event.stopPropagation();\n    }\n\n    // prevent default on return false\n    if (returnValue === false) {\n      event.preventDefault();\n    }\n  } catch (error) {\n    if (!this.handleError(error)) {\n      console.error('unhandled error in event listener', error);\n\n      throw error;\n    }\n  }\n\n  return returnValue;\n};\n\n/*\n * Add new listener with a certain priority to the list\n * of listeners (for the given event).\n *\n * The semantics of listener registration / listener execution are\n * first register, first serve: New listeners will always be inserted\n * after existing listeners with the same priority.\n *\n * Example: Inserting two listeners with priority 1000 and 1300\n *\n *    * before: [ 1500, 1500, 1000, 1000 ]\n *    * after: [ 1500, 1500, (new=1300), 1000, 1000, (new=1000) ]\n *\n * @param {string} event\n * @param {Object} listener { priority, callback }\n */\nEventBus.prototype._addListener = function(event, newListener) {\n\n  var listener = this._getListeners(event),\n      previousListener;\n\n  // no prior listeners\n  if (!listener) {\n    this._setListeners(event, newListener);\n\n    return;\n  }\n\n  // ensure we order listeners by priority from\n  // 0 (high) to n > 0 (low)\n  while (listener) {\n\n    if (listener.priority < newListener.priority) {\n\n      newListener.next = listener;\n\n      if (previousListener) {\n        previousListener.next = newListener;\n      } else {\n        this._setListeners(event, newListener);\n      }\n\n      return;\n    }\n\n    previousListener = listener;\n    listener = listener.next;\n  }\n\n  // add new listener to back\n  previousListener.next = newListener;\n};\n\n\nEventBus.prototype._getListeners = function(name) {\n  return this._listeners[name];\n};\n\nEventBus.prototype._setListeners = function(name, listener) {\n  this._listeners[name] = listener;\n};\n\nEventBus.prototype._removeListener = function(event, callback) {\n\n  var listener = this._getListeners(event),\n      nextListener,\n      previousListener,\n      listenerCallback;\n\n  if (!callback) {\n\n    // clear listeners\n    this._setListeners(event, null);\n\n    return;\n  }\n\n  while (listener) {\n\n    nextListener = listener.next;\n\n    listenerCallback = listener.callback;\n\n    if (listenerCallback === callback || listenerCallback[FN_REF] === callback) {\n      if (previousListener) {\n        previousListener.next = nextListener;\n      } else {\n\n        // new first listener\n        this._setListeners(event, nextListener);\n      }\n    }\n\n    previousListener = listener;\n    listener = nextListener;\n  }\n};\n\n/**\n * A event that is emitted via the event bus.\n */\nfunction InternalEvent() { }\n\nInternalEvent.prototype.stopPropagation = function() {\n  this.cancelBubble = true;\n};\n\nInternalEvent.prototype.preventDefault = function() {\n  this.defaultPrevented = true;\n};\n\nInternalEvent.prototype.init = function(data) {\n  assign(this, data || {});\n};\n\n\n/**\n * Invoke function. Be fast...\n *\n * @param {Function} fn\n * @param {Array<Object>} args\n *\n * @return {Any}\n */\nfunction invokeFunction(fn, args) {\n  return fn.apply(null, args);\n}\n","import { debounce } from 'min-dash';\n\n/**\n * A factory to create a configurable debouncer.\n *\n * @param {number|boolean} [config=true]\n */\nexport default function DebounceFactory(config = true) {\n\n  const timeout = typeof config === 'number' ? config : config ? 300 : 0;\n\n  if (timeout) {\n    return fn => debounce(fn, timeout);\n  } else {\n    return fn => fn;\n  }\n}\n\nDebounceFactory.$inject = [ 'config.debounce' ];","export default class FieldFactory {\n\n  /**\n   * @constructor\n   *\n   * @param { import('./FormFieldRegistry').default } formFieldRegistry\n   * @param { import('@bpmn-io/form-js-viewer').FormFields } formFields\n   */\n  constructor(formFieldRegistry, formFields) {\n    this._formFieldRegistry = formFieldRegistry;\n    this._formFields = formFields;\n  }\n\n  create(attrs, applyDefaults = true) {\n\n    const {\n      id,\n      key,\n      type\n    } = attrs;\n\n    const fieldDefinition = this._formFields.get(type);\n\n    if (!fieldDefinition) {\n      throw new Error(`form field of type <${ type }> not supported`);\n    }\n\n    if (id && this._formFieldRegistry._ids.assigned(id)) {\n      throw new Error(`ID <${ id }> already assigned`);\n    }\n\n    if (key && this._formFieldRegistry._keys.assigned(key)) {\n      throw new Error(`key <${ key }> already assigned`);\n    }\n\n    const labelAttrs = applyDefaults && fieldDefinition.label ? {\n      label: fieldDefinition.label\n    } : {};\n\n    const field = fieldDefinition.create({\n      ...labelAttrs,\n      ...attrs\n    });\n\n    this._ensureId(field);\n\n    if (fieldDefinition.keyed) {\n      this._ensureKey(field, applyDefaults);\n    }\n\n    return field;\n  }\n\n  _ensureId(field) {\n\n    if (field.id) {\n      this._formFieldRegistry._ids.claim(field.id, field);\n\n      return;\n    }\n\n    let prefix = 'Field';\n\n    if (field.type === 'default') {\n      prefix = 'Form';\n    }\n\n    field.id = this._formFieldRegistry._ids.nextPrefixed(`${prefix}_`, field);\n  }\n\n  _ensureKey(field, applyDefaults) {\n\n    if (field.key) {\n      this._formFieldRegistry._keys.claim(field.key, field);\n\n      return;\n    }\n\n    if (applyDefaults) {\n      let prefix = 'field';\n\n      field.key = this._formFieldRegistry._keys.nextPrefixed(`${prefix}_`, field);\n    }\n  }\n}\n\n\nFieldFactory.$inject = [\n  'formFieldRegistry',\n  'formFields'\n];","import {\n  FormFieldRegistry as BaseFieldRegistry\n} from '@bpmn-io/form-js-viewer';\n\n\nexport default class FormFieldRegistry extends BaseFieldRegistry {\n\n  /**\n   * Updates a form fields id.\n   *\n   * @param {Object} formField\n   * @param {string} newId\n   */\n  updateId(formField, newId) {\n\n    this._validateId(newId);\n\n    this._eventBus.fire('formField.updateId', {\n      formField,\n      newId: newId\n    });\n\n    this.remove(formField);\n\n    formField.id = newId;\n\n    this.add(formField);\n\n    // TODO(nikku): make this a proper object graph so we\n    // do not have to deal with IDs this way...\n    if ('components' in formField) {\n      for (const component of formField.components) {\n        component._parent = newId;\n      }\n    }\n\n  }\n\n\n  /**\n   * Validate the suitability of the given id and signals a problem\n   * with an exception.\n   *\n   * @param {string} id\n   *\n   * @throws {Error} if id is empty or already assigned\n   */\n  _validateId(id) {\n    if (!id) {\n      throw new Error('formField must have an id');\n    }\n\n    if (this.get(id)) {\n      throw new Error('formField with id ' + id + ' already added');\n    }\n  }\n\n}","import { clone } from '@bpmn-io/form-js-viewer';\n\n\nexport default class Importer {\n\n  /**\n   * @constructor\n   * @param { import('../core/FormFieldRegistry').default } formFieldRegistry\n   * @param { import('../core/FieldFactory').default } fieldFactory\n   */\n  constructor(formFieldRegistry, fieldFactory) {\n    this._formFieldRegistry = formFieldRegistry;\n    this._fieldFactory = fieldFactory;\n  }\n\n  /**\n   * Import schema creating fields, attaching additional\n   * information to each field and adding fields to the\n   * field registry.\n   *\n   * Additional information attached:\n   *\n   *   * `id` (unless present)\n   *   * `_parent`\n   *   * `_path`\n   *\n   * @param {any} schema\n   *\n   * @typedef {{ warnings: Error[], schema: any }} ImportResult\n   * @returns {ImportResult}\n   */\n  importSchema(schema) {\n\n    // TODO: Add warnings\n    const warnings = [];\n\n    try {\n      const importedSchema = this.importFormField(clone(schema));\n\n      return {\n        schema: importedSchema,\n        warnings\n      };\n    } catch (err) {\n      err.warnings = warnings;\n\n      throw err;\n    }\n  }\n\n  /**\n   * @param {{[x: string]: any}} fieldAttrs\n   * @param {String} [parentId]\n   * @param {number} [index]\n   *\n   * @return {any} field\n   */\n  importFormField(fieldAttrs, parentId, index) {\n    const {\n      components,\n      id,\n      key\n    } = fieldAttrs;\n\n    let parent, path;\n\n    if (parentId) {\n      parent = this._formFieldRegistry.get(parentId);\n    }\n\n    // validate <id> uniqueness\n    if (id && this._formFieldRegistry._ids.assigned(id)) {\n      throw new Error(`form field with id <${ id }> already exists`);\n    }\n\n    // validate <key> uniqueness\n    if (key && this._formFieldRegistry._keys.assigned(key)) {\n      throw new Error(`form field with key <${ key }> already exists`);\n    }\n\n    // set form field path\n    path = parent ? [ ...parent._path, 'components', index ] : [];\n\n    const field = this._fieldFactory.create({\n      ...fieldAttrs,\n      _path: path,\n      _parent: parent && parent.id\n    }, false);\n\n    this._formFieldRegistry.add(field);\n\n    if (components) {\n      field.components = this.importFormFields(components, field.id);\n    }\n\n    return field;\n  }\n\n  /**\n   * @param {Array<any>} components\n   * @param {string} parentId\n   *\n   * @return {Array<any>} imported components\n   */\n  importFormFields(components, parentId) {\n    return components.map((component, index) => {\n      return this.importFormField(component, parentId, index);\n    });\n  }\n\n}\n\nImporter.$inject = [ 'formFieldRegistry', 'fieldFactory' ];","import Importer from './Importer';\n\nexport default {\n  importer: [ 'type', Importer ]\n};","import { createContext } from 'preact';\n\nconst DragAndDropContext = createContext({\n  drake: null\n});\n\nexport default DragAndDropContext;","import { createContext } from 'preact';\n\n/**\n * @param {string} type\n * @param {boolean} [strict]\n *\n * @returns {any}\n */\nfunction getService(type, strict) {}\n\nconst FormEditorContext = createContext({\n  getService\n});\n\nexport default FormEditorContext;","import {\n  useContext\n} from 'preact/hooks';\n\nimport { FormEditorContext } from '../context';\n\n\nexport default function(type, strict) {\n  const {\n    getService\n  } = useContext(FormEditorContext);\n\n  return getService(type, strict);\n}","function _extends() { _extends = Object.assign ? Object.assign.bind() : function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; }; return _extends.apply(this, arguments); }\n\nimport React from \"react\";\nexport default (({\n  styles = {},\n  ...props\n}) => /*#__PURE__*/React.createElement(\"svg\", _extends({\n  xmlns: \"http://www.w3.org/2000/svg\",\n  width: \"11\",\n  height: \"14\"\n}, props), /*#__PURE__*/React.createElement(\"path\", {\n  d: \"M10 4v8c0 1.1-.9 2-2 2H3c-1.1 0-2-.9-2-2V4h9zM8 6H3v4.8c0 .66.5 1.2 1.111 1.2H6.89C7.5 12 8 11.46 8 10.8V6zm3-5H8.5l-1-1h-4l-1 1H0v1.5h11V1z\"\n})));","function _extends() { _extends = Object.assign ? Object.assign.bind() : function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; }; return _extends.apply(this, arguments); }\n\nimport React from \"react\";\nexport default (({\n  styles = {},\n  ...props\n}) => /*#__PURE__*/React.createElement(\"svg\", _extends({\n  xmlns: \"http://www.w3.org/2000/svg\",\n  width: \"54\",\n  height: \"54\"\n}, props), /*#__PURE__*/React.createElement(\"path\", {\n  fillRule: \"evenodd\",\n  d: \"M45 17a3 3 0 013 3v14a3 3 0 01-3 3H9a3 3 0 01-3-3V20a3 3 0 013-3h36zm-9 8.889H18v2.222h18V25.89z\"\n})));","function _extends() { _extends = Object.assign ? Object.assign.bind() : function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; }; return _extends.apply(this, arguments); }\n\nimport React from \"react\";\nexport default (({\n  styles = {},\n  ...props\n}) => /*#__PURE__*/React.createElement(\"svg\", _extends({\n  xmlns: \"http://www.w3.org/2000/svg\",\n  width: \"54\",\n  height: \"54\"\n}, props), /*#__PURE__*/React.createElement(\"path\", {\n  d: \"M34 18H20a2 2 0 00-2 2v14a2 2 0 002 2h14a2 2 0 002-2V20a2 2 0 00-2-2zm-9 14l-5-5 1.41-1.41L25 29.17l7.59-7.59L34 23l-9 9z\"\n})));","function _extends() { _extends = Object.assign ? Object.assign.bind() : function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; }; return _extends.apply(this, arguments); }\n\nimport React from \"react\";\nexport default (({\n  styles = {},\n  ...props\n}) => /*#__PURE__*/React.createElement(\"svg\", _extends({\n  width: \"54\",\n  height: \"54\",\n  fill: \"none\",\n  xmlns: \"http://www.w3.org/2000/svg\"\n}, props), /*#__PURE__*/React.createElement(\"path\", {\n  fillRule: \"evenodd\",\n  clipRule: \"evenodd\",\n  d: \"M19 24h-6v6h6v-6zm-6-2a2 2 0 00-2 2v6a2 2 0 002 2h6a2 2 0 002-2v-6a2 2 0 00-2-2h-6zm6 18h-6v6h6v-6zm-6-2a2 2 0 00-2 2v6a2 2 0 002 2h6a2 2 0 002-2v-6a2 2 0 00-2-2h-6zm6-30h-6v6h6V8zm-6-2a2 2 0 00-2 2v6a2 2 0 002 2h6a2 2 0 002-2V8a2 2 0 00-2-2h-6z\",\n  fill: \"#22242A\"\n}), /*#__PURE__*/React.createElement(\"path\", {\n  d: \"M26 26a1 1 0 011-1h15a1 1 0 011 1v2a1 1 0 01-1 1H27a1 1 0 01-1-1v-2zm0 16a1 1 0 011-1h15a1 1 0 011 1v2a1 1 0 01-1 1H27a1 1 0 01-1-1v-2zm0-32a1 1 0 011-1h15a1 1 0 011 1v2a1 1 0 01-1 1H27a1 1 0 01-1-1v-2z\",\n  fill: \"#22242A\"\n})));","function _extends() { _extends = Object.assign ? Object.assign.bind() : function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; }; return _extends.apply(this, arguments); }\n\nimport React from \"react\";\nexport default (({\n  styles = {},\n  ...props\n}) => /*#__PURE__*/React.createElement(\"svg\", _extends({\n  width: \"54\",\n  height: \"54\",\n  fill: \"none\",\n  xmlns: \"http://www.w3.org/2000/svg\"\n}, props), /*#__PURE__*/React.createElement(\"path\", {\n  fillRule: \"evenodd\",\n  clipRule: \"evenodd\",\n  d: \"M45 16a3 3 0 013 3v16a3 3 0 01-3 3H9a3 3 0 01-3-3V19a3 3 0 013-3h36zm0 2H9a1 1 0 00-1 1v16a1 1 0 001 1h36a1 1 0 001-1V19a1 1 0 00-1-1z\",\n  fill: \"#000\"\n}), /*#__PURE__*/React.createElement(\"path\", {\n  d: \"M11 22a1 1 0 011-1h19a1 1 0 011 1v10a1 1 0 01-1 1H12a1 1 0 01-1-1V22z\",\n  fill: \"#505562\"\n})));","function _extends() { _extends = Object.assign ? Object.assign.bind() : function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; }; return _extends.apply(this, arguments); }\n\nimport React from \"react\";\nexport default (({\n  styles = {},\n  ...props\n}) => /*#__PURE__*/React.createElement(\"svg\", _extends({\n  xmlns: \"http://www.w3.org/2000/svg\",\n  width: \"54\",\n  height: \"54\"\n}, props), /*#__PURE__*/React.createElement(\"rect\", {\n  x: \"15\",\n  y: \"17\",\n  width: \"24\",\n  height: \"4\",\n  rx: \"1\"\n}), /*#__PURE__*/React.createElement(\"rect\", {\n  x: \"15\",\n  y: \"25\",\n  width: \"24\",\n  height: \"4\",\n  rx: \"1\"\n}), /*#__PURE__*/React.createElement(\"rect\", {\n  x: \"15\",\n  y: \"33\",\n  width: \"13\",\n  height: \"4\",\n  rx: \"1\"\n})));","function _extends() { _extends = Object.assign ? Object.assign.bind() : function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; }; return _extends.apply(this, arguments); }\n\nimport React from \"react\";\nexport default (({\n  styles = {},\n  ...props\n}) => /*#__PURE__*/React.createElement(\"svg\", _extends({\n  xmlns: \"http://www.w3.org/2000/svg\",\n  width: \"54\",\n  height: \"54\"\n}, props), /*#__PURE__*/React.createElement(\"path\", {\n  fillRule: \"evenodd\",\n  d: \"M8 33v5a1 1 0 001 1h4v2H9a3 3 0 01-3-3v-5h2zm18 6v2H15v-2h11zm13 0v2H28v-2h11zm9-6v5a3 3 0 01-3 3h-4v-2h4a1 1 0 00.993-.883L46 38v-5h2zM8 22v9H6v-9h2zm40 0v9h-2v-9h2zm-35-9v2H9a1 1 0 00-.993.883L8 16v4H6v-4a3 3 0 013-3h4zm32 0a3 3 0 013 3v4h-2v-4a1 1 0 00-.883-.993L45 15h-4v-2h4zm-6 0v2H28v-2h11zm-13 0v2H15v-2h11z\"\n})));","function _extends() { _extends = Object.assign ? Object.assign.bind() : function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; }; return _extends.apply(this, arguments); }\n\nimport React from \"react\";\nexport default (({\n  styles = {},\n  ...props\n}) => /*#__PURE__*/React.createElement(\"svg\", _extends({\n  xmlns: \"http://www.w3.org/2000/svg\",\n  width: \"54\",\n  height: \"54\"\n}, props), /*#__PURE__*/React.createElement(\"path\", {\n  fillRule: \"evenodd\",\n  d: \"M45 16a3 3 0 013 3v16a3 3 0 01-3 3H9a3 3 0 01-3-3V19a3 3 0 013-3h36zm0 2H9a1 1 0 00-1 1v16a1 1 0 001 1h36a1 1 0 001-1V19a1 1 0 00-1-1zM35 28.444h7l-3.5 4-3.5-4zM35 26h7l-3.5-4-3.5 4z\"\n})));","function _extends() { _extends = Object.assign ? Object.assign.bind() : function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; }; return _extends.apply(this, arguments); }\n\nimport React from \"react\";\nexport default (({\n  styles = {},\n  ...props\n}) => /*#__PURE__*/React.createElement(\"svg\", _extends({\n  xmlns: \"http://www.w3.org/2000/svg\",\n  width: \"54\",\n  height: \"54\"\n}, props), /*#__PURE__*/React.createElement(\"path\", {\n  d: \"M27 22c-2.76 0-5 2.24-5 5s2.24 5 5 5 5-2.24 5-5-2.24-5-5-5zm0-5c-5.52 0-10 4.48-10 10s4.48 10 10 10 10-4.48 10-10-4.48-10-10-10zm0 18c-4.42 0-8-3.58-8-8s3.58-8 8-8 8 3.58 8 8-3.58 8-8 8z\"\n})));","function _extends() { _extends = Object.assign ? Object.assign.bind() : function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; }; return _extends.apply(this, arguments); }\n\nimport React from \"react\";\nexport default (({\n  styles = {},\n  ...props\n}) => /*#__PURE__*/React.createElement(\"svg\", _extends({\n  xmlns: \"http://www.w3.org/2000/svg\",\n  width: \"54\",\n  height: \"54\"\n}, props), /*#__PURE__*/React.createElement(\"path\", {\n  fillRule: \"evenodd\",\n  d: \"M45 16a3 3 0 013 3v16a3 3 0 01-3 3H9a3 3 0 01-3-3V19a3 3 0 013-3h36zm0 2H9a1 1 0 00-1 1v16a1 1 0 001 1h36a1 1 0 001-1V19a1 1 0 00-1-1zm-12 7h9l-4.5 6-4.5-6z\"\n})));","function _extends() { _extends = Object.assign ? Object.assign.bind() : function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; }; return _extends.apply(this, arguments); }\n\nimport React from \"react\";\nexport default (({\n  styles = {},\n  ...props\n}) => /*#__PURE__*/React.createElement(\"svg\", _extends({\n  xmlns: \"http://www.w3.org/2000/svg\",\n  width: \"54\",\n  height: \"54\"\n}, props), /*#__PURE__*/React.createElement(\"path\", {\n  d: \"M20.58 33.77h-3l-1.18-3.08H11l-1.1 3.08H7l5.27-13.54h2.89zm-5-5.36l-1.86-5-1.83 5zM22 20.23h5.41a15.47 15.47 0 012.4.14 3.42 3.42 0 011.41.55 3.47 3.47 0 011 1.14 3 3 0 01.42 1.58 3.26 3.26 0 01-1.91 2.94 3.63 3.63 0 011.91 1.22 3.28 3.28 0 01.66 2 4 4 0 01-.43 1.8 3.63 3.63 0 01-1.09 1.4 3.89 3.89 0 01-1.83.65q-.69.07-3.3.09H22zm2.73 2.25v3.13h3.8a1.79 1.79 0 001.1-.49 1.41 1.41 0 00.41-1 1.49 1.49 0 00-.35-1 1.54 1.54 0 00-1-.48c-.27 0-1.05-.05-2.34-.05zm0 5.39v3.62h2.57a11.52 11.52 0 001.88-.09 1.65 1.65 0 001-.54 1.6 1.6 0 00.38-1.14 1.75 1.75 0 00-.29-1 1.69 1.69 0 00-.86-.62 9.28 9.28 0 00-2.41-.23zM44.35 28.79l2.65.84a5.94 5.94 0 01-2 3.29A5.74 5.74 0 0141.38 34a5.87 5.87 0 01-4.44-1.84 7.09 7.09 0 01-1.73-5A7.43 7.43 0 0137 21.87 6 6 0 0141.54 20a5.64 5.64 0 014 1.47A5.33 5.33 0 0147 24l-2.7.65a2.8 2.8 0 00-2.86-2.27A3.09 3.09 0 0039 23.42a5.31 5.31 0 00-.93 3.5 5.62 5.62 0 00.93 3.65 3 3 0 002.4 1.09 2.72 2.72 0 001.82-.66 4 4 0 001.13-2.21z\"\n})));","function _extends() { _extends = Object.assign ? Object.assign.bind() : function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; }; return _extends.apply(this, arguments); }\n\nimport React from \"react\";\nexport default (({\n  styles = {},\n  ...props\n}) => /*#__PURE__*/React.createElement(\"svg\", _extends({\n  xmlns: \"http://www.w3.org/2000/svg\",\n  width: \"54\",\n  height: \"54\"\n}, props), /*#__PURE__*/React.createElement(\"path\", {\n  fillRule: \"evenodd\",\n  d: \"M45 16a3 3 0 013 3v16a3 3 0 01-3 3H9a3 3 0 01-3-3V19a3 3 0 013-3h36zm0 2H9a1 1 0 00-1 1v16a1 1 0 001 1h36a1 1 0 001-1V19a1 1 0 00-1-1zm-32 4v10h-2V22h2z\"\n})));","import ButtonIcon from './Button.svg';\nimport CheckboxIcon from './Checkbox.svg';\nimport ChecklistIcon from './Checklist.svg';\nimport TaglistIcon from './Taglist.svg';\nimport FormIcon from './Form.svg';\nimport ColumnsIcon from './Group.svg';\nimport NumberIcon from './Number.svg';\nimport RadioIcon from './Radio.svg';\nimport SelectIcon from './Select.svg';\nimport TextIcon from './Text.svg';\nimport TextfieldIcon from './Textfield.svg';\n\nexport const iconsByType = {\n  button: ButtonIcon,\n  checkbox: CheckboxIcon,\n  checklist: ChecklistIcon,\n  columns: ColumnsIcon,\n  number: NumberIcon,\n  radio: RadioIcon,\n  select: SelectIcon,\n  taglist: TaglistIcon,\n  text: TextIcon,\n  textfield: TextfieldIcon,\n  default: FormIcon\n};","import { render } from 'preact';\nimport {\n  useCallback,\n  useContext,\n  useEffect,\n  useRef,\n  useState\n} from 'preact/hooks';\n\nimport {\n  FormComponent,\n  FormContext,\n  FormRenderContext\n} from '@bpmn-io/form-js-viewer';\n\nimport useService from '../hooks/useService';\n\nimport { DragAndDropContext } from '../context';\n\nimport dragula from 'dragula';\n\nimport { ListDeleteIcon } from '../../features/properties-panel/icons';\n\nimport { iconsByType } from './icons';\n\nfunction ContextPad(props) {\n  if (!props.children) {\n    return null;\n  }\n\n  return (\n    <div class=\"fjs-context-pad\">\n      {\n        props.children\n      }\n    </div>\n  );\n}\n\nfunction Empty(props) {\n  return null;\n}\n\nfunction Element(props) {\n  const eventBus = useService('eventBus'),\n        formEditor = useService('formEditor'),\n        formFieldRegistry = useService('formFieldRegistry'),\n        modeling = useService('modeling'),\n        selection = useService('selection');\n\n  const { field } = props;\n\n  const {\n    id,\n    type\n  } = field;\n\n  const ref = useRef();\n\n  function scrollIntoView({ selection }) {\n    if (!selection || selection.id !== id || !ref.current) {\n      return;\n    }\n\n    const elementBounds = ref.current.getBoundingClientRect(),\n          containerBounds = formEditor._container.getBoundingClientRect();\n\n    if (elementBounds.top < 0 || elementBounds.top > containerBounds.bottom) {\n      ref.current.scrollIntoView();\n    }\n  }\n\n  useEffect(() => {\n    eventBus.on('selection.changed', scrollIntoView);\n\n    return () => eventBus.off('selection.changed', scrollIntoView);\n  }, [ id ]);\n\n  function onClick(event) {\n    event.stopPropagation();\n\n    selection.toggle(field);\n  }\n\n  const classes = [ 'fjs-element' ];\n\n  if (props.class) {\n    classes.push(...props.class.split(' '));\n  }\n\n  if (selection.isSelected(field)) {\n    classes.push('fjs-editor-selected');\n  }\n\n  const onRemove = (event) => {\n    event.stopPropagation();\n\n    const parentField = formFieldRegistry.get(field._parent);\n\n    const index = getFormFieldIndex(parentField, field);\n\n    modeling.removeFormField(field, parentField, index);\n  };\n\n  return (\n    <div\n      class={ classes.join(' ') }\n      data-id={ id }\n      data-field-type={ type }\n      onClick={ onClick }\n      ref={ ref }>\n      <ContextPad>\n        {\n          selection.isSelected(field) && field.type !== 'default'\n            ? <button class=\"fjs-context-pad-item\" onClick={ onRemove }><ListDeleteIcon /></button>\n            : null\n        }\n      </ContextPad>\n      { props.children }\n    </div>\n  );\n}\n\nfunction Children(props) {\n  const { field } = props;\n\n  const { id } = field;\n\n  const classes = [ 'fjs-children', 'fjs-drag-container' ];\n\n  if (props.class) {\n    classes.push(...props.class.split(' '));\n  }\n\n  return (\n    <div\n      class={ classes.join(' ') }\n      data-id={ id }>\n      { props.children }\n    </div>\n  );\n}\n\nexport default function FormEditor(props) {\n  const eventBus = useService('eventBus'),\n        formEditor = useService('formEditor'),\n        formFieldRegistry = useService('formFieldRegistry'),\n        injector = useService('injector'),\n        modeling = useService('modeling'),\n        selection = useService('selection'),\n        palette = useService('palette'),\n        paletteConfig = useService('config.palette'),\n        propertiesPanel = useService('propertiesPanel'),\n        propertiesPanelConfig = useService('config.propertiesPanel');\n\n  const { schema } = formEditor._getState();\n\n  const paletteRef = useRef(null);\n  const propertiesPanelRef = useRef(null);\n\n  const [ , setSelection ] = useState(schema);\n\n  useEffect(() => {\n    function handleSelectionChanged(event) {\n      setSelection(event.selection || schema);\n    }\n\n    eventBus.on('selection.changed', handleSelectionChanged);\n\n    setSelection(selection.get() || schema);\n\n    return () => {\n      eventBus.off('selection.changed', handleSelectionChanged);\n    };\n  }, [ schema, selection ]);\n\n  const [ drake, setDrake ] = useState(null);\n\n  const dragAndDropContext = {\n    drake\n  };\n\n  useEffect(() => {\n    const createDragulaInstance = () => {\n      const dragulaInstance = dragula({\n        isContainer(el) {\n          return el.classList.contains('fjs-drag-container');\n        },\n        copy(el) {\n          return el.classList.contains('fjs-drag-copy');\n        },\n        accepts(el, target) {\n          return !target.classList.contains('fjs-no-drop');\n        },\n        slideFactorX: 10,\n        slideFactorY: 5\n      });\n\n      dragulaInstance.on('drop', (el, target, source, sibling) => {\n        dragulaInstance.remove();\n\n        if (!target) {\n          return;\n        }\n\n        const targetFormField = formFieldRegistry.get(target.dataset.id);\n\n        const siblingFormField = sibling && formFieldRegistry.get(sibling.dataset.id),\n              targetIndex = siblingFormField ? getFormFieldIndex(targetFormField, siblingFormField) : targetFormField.components.length;\n\n        if (source.classList.contains('fjs-palette-fields')) {\n          const type = el.dataset.fieldType;\n\n          modeling.addFormField({ type }, targetFormField, targetIndex);\n        } else {\n          const formField = formFieldRegistry.get(el.dataset.id),\n                sourceFormField = formFieldRegistry.get(source.dataset.id),\n                sourceIndex = getFormFieldIndex(sourceFormField, formField);\n\n          modeling.moveFormField(formField, sourceFormField, targetFormField, sourceIndex, targetIndex);\n        }\n      });\n\n      eventBus.fire('dragula.created');\n\n      setDrake(dragulaInstance);\n\n      return dragulaInstance;\n    };\n\n    let dragulaInstance = createDragulaInstance();\n\n    const onDetach = () => {\n      if (dragulaInstance) {\n        dragulaInstance.destroy();\n\n        eventBus.fire('dragula.destroyed');\n      }\n    };\n\n    const onAttach = () => {\n      onDetach();\n\n      dragulaInstance = createDragulaInstance();\n    };\n\n    eventBus.on('attach', onAttach);\n    eventBus.on('detach', onDetach);\n\n    return () => {\n      onDetach();\n\n      eventBus.off('attach', onAttach);\n      eventBus.off('detach', onDetach);\n    };\n  }, []);\n\n  // fire event after render to notify interested parties\n  useEffect(() => {\n    eventBus.fire('formEditor.rendered');\n  }, []);\n\n  const formRenderContext = {\n    Children,\n    Element,\n    Empty\n  };\n\n  const formContext = {\n    getService(type, strict = true) {\n\n      // TODO(philippfromme): clean up\n      if (type === 'formFieldRegistry') {\n        return new Map();\n      } else if (type === 'form') {\n        return {\n          _getState() {\n            return {\n              data: {},\n              errors: {},\n              properties: {\n                readOnly: true\n              },\n              schema\n            };\n          }\n        };\n      }\n\n      return injector.get(type, strict);\n    },\n    formId: formEditor._id\n  };\n\n  const onSubmit = useCallback(() => {}, []);\n\n  const onReset = useCallback(() => {}, []);\n\n  // attach default palette\n  const hasDefaultPalette = defaultPalette(paletteConfig);\n\n  useEffect(() => {\n    if (hasDefaultPalette) {\n      palette.attachTo(paletteRef.current);\n    }\n  }, [ palette, paletteRef, hasDefaultPalette ]);\n\n  // attach default properties panel\n  const hasDefaultPropertiesPanel = defaultPropertiesPanel(propertiesPanelConfig);\n\n  useEffect(() => {\n    if (hasDefaultPropertiesPanel) {\n      propertiesPanel.attachTo(propertiesPanelRef.current);\n    }\n  }, [ propertiesPanelRef, propertiesPanel, hasDefaultPropertiesPanel ]);\n\n  return (\n    <div class=\"fjs-form-editor\">\n\n      <DragAndDropContext.Provider value={ dragAndDropContext }>\n        { hasDefaultPalette && <div class=\"fjs-editor-palette-container\" ref={ paletteRef } /> }\n        <div class=\"fjs-form-container\">\n\n          <FormContext.Provider value={ formContext }>\n            <FormRenderContext.Provider value={ formRenderContext }>\n              <FormComponent onSubmit={ onSubmit } onReset={ onReset } />\n            </FormRenderContext.Provider>\n          </FormContext.Provider>\n\n        </div>\n        <CreatePreview />\n      </DragAndDropContext.Provider>\n\n      { hasDefaultPropertiesPanel && <div class=\"fjs-editor-properties-container\" ref={ propertiesPanelRef } /> }\n    </div>\n  );\n}\n\nfunction getFormFieldIndex(parent, formField) {\n  let fieldFormIndex = parent.components.length;\n\n  parent.components.forEach(({ id }, index) => {\n    if (id === formField.id) {\n      fieldFormIndex = index;\n    }\n  });\n\n  return fieldFormIndex;\n}\n\nfunction CreatePreview(props) {\n\n  const { drake } = useContext(DragAndDropContext);\n\n  function handleCloned(clone, original, type) {\n\n    const fieldType = clone.dataset.fieldType;\n\n    const Icon = iconsByType[ fieldType ];\n\n    if (fieldType) {\n      clone.innerHTML = '';\n\n      clone.class = 'gu-mirror';\n\n      render(<Icon />, clone);\n    }\n  }\n\n  useEffect(() => {\n    if (!drake) {\n      return;\n    }\n\n    drake.on('cloned', handleCloned);\n\n    return () => drake.off('cloned', handleCloned);\n  }, [ drake ]);\n\n  return null;\n}\n\n\n// helper //////\n\nfunction defaultPalette(paletteConfig) {\n  return !(paletteConfig && paletteConfig.parent);\n}\n\nfunction defaultPropertiesPanel(propertiesPanelConfig) {\n  return !(propertiesPanelConfig && propertiesPanelConfig.parent);\n}","import { render } from 'preact';\nimport { useState } from 'preact/hooks';\n\nimport FormEditor from './components/FormEditor';\n\nimport { FormEditorContext } from './context';\n\n/**\n * @typedef { { container: Element, compact?: boolean } } RenderConfig\n * @typedef { import('didi').Injector } Injector\n * @typedef { import('../core/EventBus').default } EventBus\n * @typedef { import('../FormEditor').default } FormEditor\n */\n\n/**\n * @param {RenderConfig} renderConfig\n * @param {EventBus} eventBus\n * @param {FormEditor} formEditor\n * @param {Injector} injector\n */\nexport default class Renderer {\n  constructor(renderConfig, eventBus, formEditor, injector) {\n\n    const {\n      container,\n      compact = false\n    } = renderConfig;\n\n    const App = () => {\n      const [ state, setState ] = useState(formEditor._getState());\n\n      const formEditorContext = {\n        getService(type, strict = true) {\n          return injector.get(type, strict);\n        }\n      };\n\n      formEditor.on('changed', (newState) => {\n        setState(newState);\n      });\n\n      const { schema } = state;\n\n      if (!schema) {\n        return null;\n      }\n\n      return (\n        <div class={ `fjs-container fjs-editor-container ${ compact ? 'fjs-editor-compact' : '' }` }>\n          <FormEditorContext.Provider value={ formEditorContext }>\n            <FormEditor />\n          </FormEditorContext.Provider>\n        </div>\n      );\n    };\n\n    eventBus.on('form.init', () => {\n      render(<App />, container);\n    });\n\n    eventBus.on('form.destroy', () => {\n      render(null, container);\n    });\n  }\n}\n\nRenderer.$inject = [ 'config.renderer', 'eventBus', 'formEditor', 'injector' ];","import { FormFields } from '@bpmn-io/form-js-viewer';\n\nimport Renderer from './Renderer';\n\nexport default {\n  __init__: [ 'formFields', 'renderer' ],\n  formFields: [ 'type', FormFields ],\n  renderer: [ 'type', Renderer ]\n};","import EventBus from './EventBus';\nimport DebounceFactory from './Debounce';\nimport FieldFactory from './FieldFactory';\nimport FormFieldRegistry from './FormFieldRegistry';\n\nimport importModule from '../import';\nimport renderModule from '../render';\n\nexport default {\n  __depends__: [\n    importModule,\n    renderModule\n  ],\n  eventBus: [ 'type', EventBus ],\n  formFieldRegistry: [ 'type', FormFieldRegistry ],\n  fieldFactory: [ 'type', FieldFactory ],\n  debounce: [ 'factory', DebounceFactory ]\n};","import {\n  forEach,\n  isArray\n} from 'min-dash';\n\nvar NOT_REGISTERED_ERROR = 'is not a registered action',\n    IS_REGISTERED_ERROR = 'is already registered';\n\n\n/**\n * An interface that provides access to modeling actions by decoupling\n * the one who requests the action to be triggered and the trigger itself.\n *\n * It's possible to add new actions by registering them with ´registerAction´\n * and likewise unregister existing ones with ´unregisterAction´.\n *\n *\n * ## Life-Cycle and configuration\n *\n * The editor actions will wait for diagram initialization before\n * registering default actions _and_ firing an `editorActions.init` event.\n *\n * Interested parties may listen to the `editorActions.init` event with\n * low priority to check, which actions got registered. Other components\n * may use the event to register their own actions via `registerAction`.\n *\n * @param {EventBus} eventBus\n * @param {Injector} injector\n */\nexport default function EditorActions(eventBus, injector) {\n\n  // initialize actions\n  this._actions = {};\n\n  var self = this;\n\n  eventBus.on('diagram.init', function() {\n\n    // all diagram modules got loaded; check which ones\n    // are available and register the respective default actions\n    self._registerDefaultActions(injector);\n\n    // ask interested parties to register available editor\n    // actions on diagram initialization\n    eventBus.fire('editorActions.init', {\n      editorActions: self\n    });\n  });\n\n}\n\nEditorActions.$inject = [\n  'eventBus',\n  'injector'\n];\n\n/**\n * Register default actions.\n *\n * @param {Injector} injector\n */\nEditorActions.prototype._registerDefaultActions = function(injector) {\n\n  // (1) retrieve optional components to integrate with\n\n  var commandStack = injector.get('commandStack', false);\n  var modeling = injector.get('modeling', false);\n  var selection = injector.get('selection', false);\n  var zoomScroll = injector.get('zoomScroll', false);\n  var copyPaste = injector.get('copyPaste', false);\n  var canvas = injector.get('canvas', false);\n  var rules = injector.get('rules', false);\n  var keyboardMove = injector.get('keyboardMove', false);\n  var keyboardMoveSelection = injector.get('keyboardMoveSelection', false);\n\n  // (2) check components and register actions\n\n  if (commandStack) {\n    this.register('undo', function() {\n      commandStack.undo();\n    });\n\n    this.register('redo', function() {\n      commandStack.redo();\n    });\n  }\n\n  if (copyPaste && selection) {\n    this.register('copy', function() {\n      var selectedElements = selection.get();\n\n      copyPaste.copy(selectedElements);\n    });\n  }\n\n  if (copyPaste) {\n    this.register('paste', function() {\n      copyPaste.paste();\n    });\n  }\n\n  if (zoomScroll) {\n    this.register('stepZoom', function(opts) {\n      zoomScroll.stepZoom(opts.value);\n    });\n  }\n\n  if (canvas) {\n    this.register('zoom', function(opts) {\n      canvas.zoom(opts.value);\n    });\n  }\n\n  if (modeling && selection && rules) {\n    this.register('removeSelection', function() {\n\n      var selectedElements = selection.get();\n\n      if (!selectedElements.length) {\n        return;\n      }\n\n      var allowed = rules.allowed('elements.delete', { elements: selectedElements }),\n          removableElements;\n\n      if (allowed === false) {\n        return;\n      }\n      else if (isArray(allowed)) {\n        removableElements = allowed;\n      }\n      else {\n        removableElements = selectedElements;\n      }\n\n      if (removableElements.length) {\n        modeling.removeElements(removableElements.slice());\n      }\n    });\n  }\n\n  if (keyboardMove) {\n    this.register('moveCanvas', function(opts) {\n      keyboardMove.moveCanvas(opts);\n    });\n  }\n\n  if (keyboardMoveSelection) {\n    this.register('moveSelection', function(opts) {\n      keyboardMoveSelection.moveSelection(opts.direction, opts.accelerated);\n    });\n  }\n\n};\n\n\n/**\n * Triggers a registered action\n *\n * @param  {string} action\n * @param  {Object} opts\n *\n * @return {Unknown} Returns what the registered listener returns\n */\nEditorActions.prototype.trigger = function(action, opts) {\n  if (!this._actions[action]) {\n    throw error(action, NOT_REGISTERED_ERROR);\n  }\n\n  return this._actions[action](opts);\n};\n\n\n/**\n * Registers a collections of actions.\n * The key of the object will be the name of the action.\n *\n * @example\n * ´´´\n * var actions = {\n *   spaceTool: function() {\n *     spaceTool.activateSelection();\n *   },\n *   lassoTool: function() {\n *     lassoTool.activateSelection();\n *   }\n * ];\n *\n * editorActions.register(actions);\n *\n * editorActions.isRegistered('spaceTool'); // true\n * ´´´\n *\n * @param  {Object} actions\n */\nEditorActions.prototype.register = function(actions, listener) {\n  var self = this;\n\n  if (typeof actions === 'string') {\n    return this._registerAction(actions, listener);\n  }\n\n  forEach(actions, function(listener, action) {\n    self._registerAction(action, listener);\n  });\n};\n\n/**\n * Registers a listener to an action key\n *\n * @param  {string} action\n * @param  {Function} listener\n */\nEditorActions.prototype._registerAction = function(action, listener) {\n  if (this.isRegistered(action)) {\n    throw error(action, IS_REGISTERED_ERROR);\n  }\n\n  this._actions[action] = listener;\n};\n\n/**\n * Unregister an existing action\n *\n * @param {string} action\n */\nEditorActions.prototype.unregister = function(action) {\n  if (!this.isRegistered(action)) {\n    throw error(action, NOT_REGISTERED_ERROR);\n  }\n\n  this._actions[action] = undefined;\n};\n\n/**\n * Returns the number of actions that are currently registered\n *\n * @return {number}\n */\nEditorActions.prototype.getActions = function() {\n  return Object.keys(this._actions);\n};\n\n/**\n * Checks wether the given action is registered\n *\n * @param {string} action\n *\n * @return {boolean}\n */\nEditorActions.prototype.isRegistered = function(action) {\n  return !!this._actions[action];\n};\n\n\nfunction error(action, message) {\n  return new Error(action + ' ' + message);\n}\n","import EditorActions from './EditorActions';\n\nexport default {\n  __init__: [ 'editorActions' ],\n  editorActions: [ 'type', EditorActions ]\n};\n","import EditorActions from 'diagram-js/lib/features/editor-actions/EditorActions';\n\n\nexport default class FormEditorActions extends EditorActions {\n  constructor(eventBus, injector) {\n    super(eventBus, injector);\n\n    eventBus.on('form.init', () => {\n      this._registerDefaultActions(injector);\n\n      eventBus.fire('editorActions.init', {\n        editorActions: this\n      });\n    });\n  }\n\n  _registerDefaultActions(injector) {\n    const commandStack = injector.get('commandStack', false),\n          formFieldRegistry = injector.get('formFieldRegistry', false),\n          selection = injector.get('selection', false);\n\n    if (commandStack) {\n\n      // @ts-ignore\n      this.register('undo', () => {\n        commandStack.undo();\n      });\n\n      // @ts-ignore\n      this.register('redo', () => {\n        commandStack.redo();\n      });\n    }\n\n    if (formFieldRegistry && selection) {\n\n      // @ts-ignore\n      this.register('selectFormField', (options = {}) => {\n        const { id } = options;\n\n        if (!id) {\n          return;\n        }\n\n        const formField = formFieldRegistry.get(id);\n\n        if (formField) {\n          selection.set(formField);\n        }\n      });\n    }\n  }\n}\n\nFormEditorActions.$inject = [\n  'eventBus',\n  'injector'\n];","import EditorActionsModule from 'diagram-js/lib/features/editor-actions';\n\nimport FormEditorActions from './FormEditorActions';\n\nexport default {\n  __depends__: [\n    EditorActionsModule\n  ],\n  editorActions: [ 'type', FormEditorActions ]\n};\n","import { isArray } from 'min-dash';\r\n\r\n/**\r\n * Returns true if event was triggered with any modifier\r\n * @param {KeyboardEvent} event\r\n */\r\nexport function hasModifier(event) {\r\n  return (event.ctrlKey || event.metaKey || event.shiftKey || event.altKey);\r\n}\r\n\r\n/**\r\n * @param {KeyboardEvent} event\r\n */\r\nexport function isCmd(event) {\r\n\r\n  // ensure we don't react to AltGr\r\n  // (mapped to CTRL + ALT)\r\n  if (event.altKey) {\r\n    return false;\r\n  }\r\n\r\n  return event.ctrlKey || event.metaKey;\r\n}\r\n\r\n/**\r\n * Checks if key pressed is one of provided keys.\r\n *\r\n * @param {string|Array<string>} keys\r\n * @param {KeyboardEvent} event\r\n */\r\nexport function isKey(keys, event) {\r\n  keys = isArray(keys) ? keys : [ keys ];\r\n\r\n  return keys.indexOf(event.key) !== -1 || keys.indexOf(event.keyCode) !== -1;\r\n}\r\n\r\n/**\r\n * @param {KeyboardEvent} event\r\n */\r\nexport function isShift(event) {\r\n  return event.shiftKey;\r\n}","import {\n  isFunction\n} from 'min-dash';\n\nimport {\n  closest as domClosest,\n  event as domEvent,\n  matches as domMatches\n} from 'min-dom';\n\nimport {\n  hasModifier,\n  isCmd,\n  isKey,\n  isShift\n} from './KeyboardUtil';\n\nvar KEYDOWN_EVENT = 'keyboard.keydown',\n    KEYUP_EVENT = 'keyboard.keyup';\n\nvar HANDLE_MODIFIER_ATTRIBUTE = 'input-handle-modified-keys';\n\nvar DEFAULT_PRIORITY = 1000;\n\n/**\n * A keyboard abstraction that may be activated and\n * deactivated by users at will, consuming key events\n * and triggering diagram actions.\n *\n * For keys pressed down, keyboard fires `keyboard.keydown` event.\n * The event context contains one field which is `KeyboardEvent` event.\n *\n * The implementation fires the following key events that allow\n * other components to hook into key handling:\n *\n *  - keyboard.bind\n *  - keyboard.unbind\n *  - keyboard.init\n *  - keyboard.destroy\n *\n * All events contain one field which is node.\n *\n * A default binding for the keyboard may be specified via the\n * `keyboard.bindTo` configuration option.\n *\n * @param {Config} config\n * @param {EventBus} eventBus\n */\nexport default function Keyboard(config, eventBus) {\n  var self = this;\n\n  this._config = config || {};\n  this._eventBus = eventBus;\n\n  this._keydownHandler = this._keydownHandler.bind(this);\n  this._keyupHandler = this._keyupHandler.bind(this);\n\n  // properly clean dom registrations\n  eventBus.on('diagram.destroy', function() {\n    self._fire('destroy');\n\n    self.unbind();\n  });\n\n  eventBus.on('diagram.init', function() {\n    self._fire('init');\n  });\n\n  eventBus.on('attach', function() {\n    if (config && config.bindTo) {\n      self.bind(config.bindTo);\n    }\n  });\n\n  eventBus.on('detach', function() {\n    self.unbind();\n  });\n}\n\nKeyboard.$inject = [\n  'config.keyboard',\n  'eventBus'\n];\n\nKeyboard.prototype._keydownHandler = function(event) {\n  this._keyHandler(event, KEYDOWN_EVENT);\n};\n\nKeyboard.prototype._keyupHandler = function(event) {\n  this._keyHandler(event, KEYUP_EVENT);\n};\n\nKeyboard.prototype._keyHandler = function(event, type) {\n  var eventBusResult;\n\n  if (this._isEventIgnored(event)) {\n    return;\n  }\n\n  var context = {\n    keyEvent: event\n  };\n\n  eventBusResult = this._eventBus.fire(type || KEYDOWN_EVENT, context);\n\n  if (eventBusResult) {\n    event.preventDefault();\n  }\n};\n\nKeyboard.prototype._isEventIgnored = function(event) {\n  return isInput(event.target) && this._isModifiedKeyIgnored(event);\n};\n\nKeyboard.prototype._isModifiedKeyIgnored = function(event) {\n  if (!isCmd(event)) {\n    return true;\n  }\n\n  var allowedModifiers = this._getAllowedModifiers(event.target);\n  return !allowedModifiers.includes(event.key);\n};\n\nKeyboard.prototype._getAllowedModifiers = function(element) {\n  var modifierContainer = domClosest(element, '[' + HANDLE_MODIFIER_ATTRIBUTE + ']', true);\n\n  if (!modifierContainer || (this._node && !this._node.contains(modifierContainer))) {\n    return [];\n  }\n\n  return modifierContainer.getAttribute(HANDLE_MODIFIER_ATTRIBUTE).split(',');\n};\n\nKeyboard.prototype.bind = function(node) {\n\n  // make sure that the keyboard is only bound once to the DOM\n  this.unbind();\n\n  this._node = node;\n\n  // bind key events\n  domEvent.bind(node, 'keydown', this._keydownHandler, true);\n  domEvent.bind(node, 'keyup', this._keyupHandler, true);\n\n  this._fire('bind');\n};\n\nKeyboard.prototype.getBinding = function() {\n  return this._node;\n};\n\nKeyboard.prototype.unbind = function() {\n  var node = this._node;\n\n  if (node) {\n    this._fire('unbind');\n\n    // unbind key events\n    domEvent.unbind(node, 'keydown', this._keydownHandler, true);\n    domEvent.unbind(node, 'keyup', this._keyupHandler, true);\n  }\n\n  this._node = null;\n};\n\nKeyboard.prototype._fire = function(event) {\n  this._eventBus.fire('keyboard.' + event, { node: this._node });\n};\n\n/**\n * Add a listener function that is notified with `KeyboardEvent` whenever\n * the keyboard is bound and the user presses a key. If no priority is\n * provided, the default value of 1000 is used.\n *\n * @param {number} [priority]\n * @param {Function} listener\n * @param {string} type\n */\nKeyboard.prototype.addListener = function(priority, listener, type) {\n  if (isFunction(priority)) {\n    type = listener;\n    listener = priority;\n    priority = DEFAULT_PRIORITY;\n  }\n\n  this._eventBus.on(type || KEYDOWN_EVENT, priority, listener);\n};\n\nKeyboard.prototype.removeListener = function(listener, type) {\n  this._eventBus.off(type || KEYDOWN_EVENT, listener);\n};\n\nKeyboard.prototype.hasModifier = hasModifier;\nKeyboard.prototype.isCmd = isCmd;\nKeyboard.prototype.isShift = isShift;\nKeyboard.prototype.isKey = isKey;\n\n\n\n// helpers ///////\n\nfunction isInput(target) {\n  return target && (domMatches(target, 'input, textarea') || target.contentEditable === 'true');\n}\n","import {\n  isCmd,\n  isKey,\n  isShift\n} from './KeyboardUtil';\n\nvar LOW_PRIORITY = 500;\n\nexport var KEYCODE_C = 67;\nexport var KEYCODE_V = 86;\nexport var KEYCODE_Y = 89;\nexport var KEYCODE_Z = 90;\n\nexport var KEYS_COPY = ['c', 'C', KEYCODE_C ];\nexport var KEYS_PASTE = [ 'v', 'V', KEYCODE_V ];\nexport var KEYS_REDO = [ 'y', 'Y', KEYCODE_Y ];\nexport var KEYS_UNDO = [ 'z', 'Z', KEYCODE_Z ];\n\n\n/**\n * Adds default keyboard bindings.\n *\n * This does not pull in any features will bind only actions that\n * have previously been registered against the editorActions component.\n *\n * @param {EventBus} eventBus\n * @param {Keyboard} keyboard\n */\nexport default function KeyboardBindings(eventBus, keyboard) {\n\n  var self = this;\n\n  eventBus.on('editorActions.init', LOW_PRIORITY, function(event) {\n\n    var editorActions = event.editorActions;\n\n    self.registerBindings(keyboard, editorActions);\n  });\n}\n\nKeyboardBindings.$inject = [\n  'eventBus',\n  'keyboard'\n];\n\n\n/**\n * Register available keyboard bindings.\n *\n * @param {Keyboard} keyboard\n * @param {EditorActions} editorActions\n */\nKeyboardBindings.prototype.registerBindings = function(keyboard, editorActions) {\n\n  /**\n   * Add keyboard binding if respective editor action\n   * is registered.\n   *\n   * @param {string} action name\n   * @param {Function} fn that implements the key binding\n   */\n  function addListener(action, fn) {\n\n    if (editorActions.isRegistered(action)) {\n      keyboard.addListener(fn);\n    }\n  }\n\n\n  // undo\n  // (CTRL|CMD) + Z\n  addListener('undo', function(context) {\n\n    var event = context.keyEvent;\n\n    if (isCmd(event) && !isShift(event) && isKey(KEYS_UNDO, event)) {\n      editorActions.trigger('undo');\n\n      return true;\n    }\n  });\n\n  // redo\n  // CTRL + Y\n  // CMD + SHIFT + Z\n  addListener('redo', function(context) {\n\n    var event = context.keyEvent;\n\n    if (isCmd(event) && (isKey(KEYS_REDO, event) || (isKey(KEYS_UNDO, event) && isShift(event)))) {\n      editorActions.trigger('redo');\n\n      return true;\n    }\n  });\n\n  // copy\n  // CTRL/CMD + C\n  addListener('copy', function(context) {\n\n    var event = context.keyEvent;\n\n    if (isCmd(event) && isKey(KEYS_COPY, event)) {\n      editorActions.trigger('copy');\n\n      return true;\n    }\n  });\n\n  // paste\n  // CTRL/CMD + V\n  addListener('paste', function(context) {\n\n    var event = context.keyEvent;\n\n    if (isCmd(event) && isKey(KEYS_PASTE, event)) {\n      editorActions.trigger('paste');\n\n      return true;\n    }\n  });\n\n  // zoom in one step\n  // CTRL/CMD + +\n  addListener('stepZoom', function(context) {\n\n    var event = context.keyEvent;\n\n    // quirk: it has to be triggered by `=` as well to work on international keyboard layout\n    // cf: https://github.com/bpmn-io/bpmn-js/issues/1362#issuecomment-722989754\n    if (isKey([ '+', 'Add', '=' ], event) && isCmd(event)) {\n      editorActions.trigger('stepZoom', { value: 1 });\n\n      return true;\n    }\n  });\n\n  // zoom out one step\n  // CTRL + -\n  addListener('stepZoom', function(context) {\n\n    var event = context.keyEvent;\n\n    if (isKey([ '-', 'Subtract' ], event) && isCmd(event)) {\n      editorActions.trigger('stepZoom', { value: -1 });\n\n      return true;\n    }\n  });\n\n  // zoom to the default level\n  // CTRL + 0\n  addListener('zoom', function(context) {\n\n    var event = context.keyEvent;\n\n    if (isKey('0', event) && isCmd(event)) {\n      editorActions.trigger('zoom', { value: 1 });\n\n      return true;\n    }\n  });\n\n  // delete selected element\n  // DEL\n  addListener('removeSelection', function(context) {\n\n    var event = context.keyEvent;\n\n    if (isKey(['Backspace', 'Delete', 'Del' ], event)) {\n      editorActions.trigger('removeSelection');\n\n      return true;\n    }\n  });\n};","import Keyboard from './Keyboard';\nimport KeyboardBindings from './KeyboardBindings';\n\nexport default {\n  __init__: [ 'keyboard', 'keyboardBindings' ],\n  keyboard: [ 'type', Keyboard ],\n  keyboardBindings: [ 'type', KeyboardBindings ]\n};\n","import {\n  isCmd,\n  isKey,\n  isShift\n} from 'diagram-js/lib/features/keyboard/KeyboardUtil';\n\nimport {\n  KEYS_REDO,\n  KEYS_UNDO\n} from 'diagram-js/lib/features/keyboard/KeyboardBindings';\n\nconst LOW_PRIORITY = 500;\n\nexport default class FormEditorKeyboardBindings {\n  constructor(eventBus, keyboard) {\n    eventBus.on('editorActions.init', LOW_PRIORITY, (event) => {\n      const { editorActions } = event;\n\n      this.registerBindings(keyboard, editorActions);\n    });\n  }\n\n  registerBindings(keyboard, editorActions) {\n\n    function addListener(action, fn) {\n      if (editorActions.isRegistered(action)) {\n        keyboard.addListener(fn);\n      }\n    }\n\n    // undo\n    // (CTRL|CMD) + Z\n    addListener('undo', (context) => {\n      const { keyEvent } = context;\n\n      if (isCmd(keyEvent) && !isShift(keyEvent) && isKey(KEYS_UNDO, keyEvent)) {\n        editorActions.trigger('undo');\n\n        return true;\n      }\n    });\n\n    // redo\n    // CTRL + Y\n    // CMD + SHIFT + Z\n    addListener('redo', (context) => {\n      const { keyEvent } = context;\n\n      if (isCmd(keyEvent) && (isKey(KEYS_REDO, keyEvent) || (isKey(KEYS_UNDO, keyEvent) && isShift(keyEvent)))) {\n        editorActions.trigger('redo');\n\n        return true;\n      }\n    });\n\n  }\n}\n\nFormEditorKeyboardBindings.$inject = [ 'eventBus', 'keyboard' ];","import KeyboardModule from 'diagram-js/lib/features/keyboard';\n\nimport FormEditorKeyboardBindings from './FormEditorKeyboardBindings';\n\nexport default {\n  __depends__: [\n    KeyboardModule\n  ],\n  __init__: [ 'keyboardBindings' ],\n  keyboardBindings: [ 'type', FormEditorKeyboardBindings ]\n};","export function arrayAdd(array, index, item) {\n  array.splice(index, 0, item);\n\n  return array;\n}\n\nexport { mutate as arrayMove } from 'array-move';\n\nexport function arrayRemove(array, index) {\n  array.splice(index, 1);\n\n  return array;\n}\n\nexport function updatePath(formFieldRegistry, formField, index) {\n  const parent = formFieldRegistry.get(formField._parent);\n\n  formField._path = [ ...parent._path, 'components', index ];\n\n  return formField;\n}","import { get } from 'min-dash';\n\nimport {\n  arrayAdd,\n  arrayRemove,\n  updatePath\n} from './Util';\n\nexport default class AddFormFieldHandler {\n\n  /**\n   * @constructor\n   * @param { import('../../../FormEditor').default } formEditor\n   * @param { import('../../../core/FormFieldRegistry').default } formFieldRegistry\n   */\n  constructor(formEditor, formFieldRegistry) {\n    this._formEditor = formEditor;\n    this._formFieldRegistry = formFieldRegistry;\n  }\n\n  execute(context) {\n    const {\n      formField,\n      targetFormField,\n      targetIndex\n    } = context;\n\n    const { schema } = this._formEditor._getState();\n\n    const targetPath = [ ...targetFormField._path, 'components' ];\n\n    formField._parent = targetFormField.id;\n\n    // (1) Add new form field\n    arrayAdd(get(schema, targetPath), targetIndex, formField);\n\n    // (2) Update paths of new form field and its siblings\n    get(schema, targetPath).forEach((formField, index) => updatePath(this._formFieldRegistry, formField, index));\n\n    // (3) Add new form field to form field registry\n    this._formFieldRegistry.add(formField);\n\n    // TODO: Create updater/change support that automatically updates paths and schema on command execution\n    this._formEditor._setState({ schema });\n  }\n\n  revert(context) {\n    const {\n      formField,\n      targetFormField,\n      targetIndex\n    } = context;\n\n    const { schema } = this._formEditor._getState();\n\n    const targetPath = [ ...targetFormField._path, 'components' ];\n\n    // (1) Remove new form field\n    arrayRemove(get(schema, targetPath), targetIndex);\n\n    // (2) Update paths of new form field and its siblings\n    get(schema, targetPath).forEach((formField, index) => updatePath(this._formFieldRegistry, formField, index));\n\n    // (3) Remove new form field from form field registry\n    this._formFieldRegistry.remove(formField);\n\n    // TODO: Create updater/change support that automatically updates paths and schema on command execution\n    this._formEditor._setState({ schema });\n  }\n}\n\nAddFormFieldHandler.$inject = [ 'formEditor', 'formFieldRegistry' ];","export default class EditFormFieldHandler {\n\n  /**\n   * @constructor\n   * @param { import('../../../FormEditor').default } formEditor\n   * @param { import('../../../core/FormFieldRegistry').default } formFieldRegistry\n   */\n  constructor(formEditor, formFieldRegistry) {\n    this._formEditor = formEditor;\n    this._formFieldRegistry = formFieldRegistry;\n  }\n\n  execute(context) {\n    const {\n      formField,\n      properties\n    } = context;\n\n    let { schema } = this._formEditor._getState();\n\n    const oldProperties = {};\n\n    for (let key in properties) {\n      oldProperties[ key ] = formField[ key ];\n\n      const property = properties[ key ];\n\n      if (key === 'id') {\n        if (property !== formField.id) {\n          this._formFieldRegistry.updateId(formField, property);\n        }\n      } else {\n        formField[ key ] = property;\n      }\n    }\n\n    context.oldProperties = oldProperties;\n\n    // TODO: Create updater/change support that automatically updates paths and schema on command execution\n    this._formEditor._setState({ schema });\n\n    return formField;\n  }\n\n  revert(context) {\n    const {\n      formField,\n      oldProperties\n    } = context;\n\n    let { schema } = this._formEditor._getState();\n\n    for (let key in oldProperties) {\n\n      const property = oldProperties[ key ];\n\n      if (key === 'id') {\n        if (property !== formField.id) {\n          this._formFieldRegistry.updateId(formField, property);\n        }\n      } else {\n        formField[ key ] = property;\n      }\n    }\n\n    // TODO: Create updater/change support that automatically updates paths and schema on command execution\n    this._formEditor._setState({ schema });\n\n    return formField;\n  }\n\n}\n\nEditFormFieldHandler.$inject = [\n  'formEditor',\n  'formFieldRegistry'\n];","import { get } from 'min-dash';\n\nimport {\n  arrayAdd,\n  arrayMove,\n  arrayRemove,\n  updatePath\n} from './Util';\n\nexport default class MoveFormFieldHandler {\n\n  /**\n   * @constructor\n   * @param { import('../../../FormEditor').default } formEditor\n   * @param { import('../../../core/FormFieldRegistry').default } formFieldRegistry\n   */\n  constructor(formEditor, formFieldRegistry) {\n    this._formEditor = formEditor;\n    this._formFieldRegistry = formFieldRegistry;\n  }\n\n  execute(context) {\n    this.moveFormField(context);\n  }\n\n  revert(context) {\n    let {\n      sourceFormField,\n      targetFormField,\n      sourceIndex,\n      targetIndex\n    } = context;\n\n    this.moveFormField({\n      sourceFormField: targetFormField,\n      targetFormField: sourceFormField,\n      sourceIndex: targetIndex,\n      targetIndex: sourceIndex\n    }, true);\n  }\n\n  moveFormField(context, revert) {\n    let {\n      sourceFormField,\n      targetFormField,\n      sourceIndex,\n      targetIndex\n    } = context;\n\n    let { schema } = this._formEditor._getState();\n\n    const sourcePath = [ ...sourceFormField._path, 'components' ];\n\n    if (sourceFormField.id === targetFormField.id) {\n\n      if (revert) {\n        if (sourceIndex > targetIndex) {\n          sourceIndex--;\n        }\n      } else {\n        if (sourceIndex < targetIndex) {\n          targetIndex--;\n        }\n      }\n\n      // (1) Move form field\n      arrayMove(get(schema, sourcePath), sourceIndex, targetIndex);\n\n      // (2) Update paths of new form field and its siblings\n      get(schema, sourcePath).forEach((formField, index) => updatePath(this._formFieldRegistry, formField, index));\n\n    } else {\n      const formField = get(schema, [ ...sourcePath, sourceIndex ]);\n\n      formField._parent = targetFormField.id;\n\n      // (1) Remove form field\n      arrayRemove(get(schema, sourcePath), sourceIndex);\n\n      // (2) Update paths of siblings\n      get(schema, sourcePath).forEach((formField, index) => updatePath(this._formFieldRegistry, formField, index));\n\n      const targetPath = [ ...targetFormField._path, 'components' ];\n\n      // (3) Add form field\n      arrayAdd(get(schema, targetPath), targetIndex, formField);\n\n      // (4) Update paths of siblings\n      get(schema, targetPath).forEach((formField, index) => updatePath(this._formFieldRegistry, formField, index));\n    }\n\n    // TODO: Create updater/change support that automatically updates paths and schema on command execution\n    this._formEditor._setState({ schema });\n  }\n}\n\nMoveFormFieldHandler.$inject = [ 'formEditor', 'formFieldRegistry' ];","import { get } from 'min-dash';\n\nimport {\n  arrayAdd,\n  arrayRemove,\n  updatePath\n} from './Util';\n\nexport default class RemoveFormFieldHandler {\n\n  /**\n   * @constructor\n   * @param { import('../../../FormEditor').default } formEditor\n   * @param { import('../../../core/FormFieldRegistry').default } formFieldRegistry\n   */\n  constructor(formEditor, formFieldRegistry) {\n    this._formEditor = formEditor;\n    this._formFieldRegistry = formFieldRegistry;\n  }\n\n  execute(context) {\n    const {\n      sourceFormField,\n      sourceIndex\n    } = context;\n\n    let { schema } = this._formEditor._getState();\n\n    const sourcePath = [ ...sourceFormField._path, 'components' ];\n\n    const formField = context.formField = get(schema, [ ...sourcePath, sourceIndex ]);\n\n    // (1) Remove form field\n    arrayRemove(get(schema, sourcePath), sourceIndex);\n\n    // (2) Update paths of its siblings\n    get(schema, sourcePath).forEach((formField, index) => updatePath(this._formFieldRegistry, formField, index));\n\n    // (3) Remove form field from form field registry\n    this._formFieldRegistry.remove(formField);\n\n    // TODO: Create updater/change support that automatically updates paths and schema on command execution\n    this._formEditor._setState({ schema });\n  }\n\n  revert(context) {\n    const {\n      formField,\n      sourceFormField,\n      sourceIndex\n    } = context;\n\n    let { schema } = this._formEditor._getState();\n\n    const sourcePath = [ ...sourceFormField._path, 'components' ];\n\n    // (1) Add form field\n    arrayAdd(get(schema, sourcePath), sourceIndex, formField);\n\n    // (2) Update paths of its siblings\n    get(schema, sourcePath).forEach((formField, index) => updatePath(this._formFieldRegistry, formField, index));\n\n    // (3) Add form field to form field registry\n    this._formFieldRegistry.add(formField);\n\n    // TODO: Create updater/change support that automatically updates paths and schema on command execution\n    this._formEditor._setState({ schema });\n  }\n}\n\nRemoveFormFieldHandler.$inject = [ 'formEditor', 'formFieldRegistry' ];","export default class UpdateIdClaimHandler {\n\n  /**\n   * @constructor\n   * @param { import('../../../core/FormFieldRegistry').default } formFieldRegistry\n   */\n  constructor(formFieldRegistry) {\n    this._formFieldRegistry = formFieldRegistry;\n  }\n\n  execute(context) {\n    const {\n      claiming,\n      formField,\n      id\n    } = context;\n\n    if (claiming) {\n      this._formFieldRegistry._ids.claim(id, formField);\n    } else {\n      this._formFieldRegistry._ids.unclaim(id);\n    }\n  }\n\n  revert(context) {\n    const {\n      claiming,\n      formField,\n      id\n    } = context;\n\n    if (claiming) {\n      this._formFieldRegistry._ids.unclaim(id);\n    } else {\n      this._formFieldRegistry._ids.claim(id, formField);\n    }\n  }\n}\n\nUpdateIdClaimHandler.$inject = [ 'formFieldRegistry' ];","export default class UpdateKeyClaimHandler {\n\n  /**\n   * @constructor\n   * @param { import('../../../core/FormFieldRegistry').default } formFieldRegistry\n   */\n  constructor(formFieldRegistry) {\n    this._formFieldRegistry = formFieldRegistry;\n  }\n\n  execute(context) {\n    const {\n      claiming,\n      formField,\n      key\n    } = context;\n\n    if (claiming) {\n      this._formFieldRegistry._keys.claim(key, formField);\n    } else {\n      this._formFieldRegistry._keys.unclaim(key);\n    }\n  }\n\n  revert(context) {\n    const {\n      claiming,\n      formField,\n      key\n    } = context;\n\n    if (claiming) {\n      this._formFieldRegistry._keys.unclaim(key);\n    } else {\n      this._formFieldRegistry._keys.claim(key, formField);\n    }\n  }\n}\n\nUpdateKeyClaimHandler.$inject = [ 'formFieldRegistry' ];","import AddFormFieldHandler from './cmd/AddFormFieldHandler';\nimport EditFormFieldHandler from './cmd/EditFormFieldHandler';\nimport MoveFormFieldHandler from './cmd/MoveFormFieldHandler';\nimport RemoveFormFieldHandler from './cmd/RemoveFormFieldHandler';\nimport UpdateIdClaimHandler from './cmd/UpdateIdClaimHandler';\nimport UpdateKeyClaimHandler from './cmd/UpdateKeyClaimHandler';\n\nimport { isObject } from 'min-dash';\n\n\nexport default class Modeling {\n  constructor(commandStack, eventBus, formEditor, formFieldRegistry, fieldFactory) {\n    this._commandStack = commandStack;\n    this._formEditor = formEditor;\n    this._formFieldRegistry = formFieldRegistry;\n    this._fieldFactory = fieldFactory;\n\n    eventBus.on('form.init', () => {\n      this.registerHandlers();\n    });\n  }\n\n  registerHandlers() {\n    Object.entries(this.getHandlers()).forEach(([ id, handler ]) => {\n      this._commandStack.registerHandler(id, handler);\n    });\n  }\n\n  getHandlers() {\n    return {\n      'formField.add': AddFormFieldHandler,\n      'formField.edit': EditFormFieldHandler,\n      'formField.move': MoveFormFieldHandler,\n      'formField.remove': RemoveFormFieldHandler,\n      'id.updateClaim': UpdateIdClaimHandler,\n      'key.updateClaim': UpdateKeyClaimHandler\n    };\n  }\n\n  addFormField(attrs, targetFormField, targetIndex) {\n\n    const formField = this._fieldFactory.create(attrs);\n\n    const context = {\n      formField,\n      targetFormField,\n      targetIndex\n    };\n\n    this._commandStack.execute('formField.add', context);\n\n    return formField;\n  }\n\n  editFormField(formField, properties, value) {\n    if (!isObject(properties)) {\n      properties = {\n        [ properties ]: value\n      };\n    }\n\n    const context = {\n      formField,\n      properties\n    };\n\n    this._commandStack.execute('formField.edit', context);\n  }\n\n  moveFormField(formField, sourceFormField, targetFormField, sourceIndex, targetIndex) {\n    const context = {\n      formField,\n      sourceFormField,\n      targetFormField,\n      sourceIndex,\n      targetIndex\n    };\n\n    this._commandStack.execute('formField.move', context);\n  }\n\n  removeFormField(formField, sourceFormField, sourceIndex) {\n    const context = {\n      formField,\n      sourceFormField,\n      sourceIndex\n    };\n\n    this._commandStack.execute('formField.remove', context);\n  }\n\n  claimId(formField, id) {\n    const context = {\n      formField,\n      id,\n      claiming: true\n    };\n\n    this._commandStack.execute('id.updateClaim', context);\n  }\n\n  unclaimId(formField, id) {\n    const context = {\n      formField,\n      id,\n      claiming: false\n    };\n\n    this._commandStack.execute('id.updateClaim', context);\n  }\n\n  claimKey(formField, key) {\n    const context = {\n      formField,\n      key,\n      claiming: true\n    };\n\n    this._commandStack.execute('key.updateClaim', context);\n  }\n\n  unclaimKey(formField, key) {\n    const context = {\n      formField,\n      key,\n      claiming: false\n    };\n\n    this._commandStack.execute('key.updateClaim', context);\n  }\n}\n\nModeling.$inject = [\n  'commandStack',\n  'eventBus',\n  'formEditor',\n  'formFieldRegistry',\n  'fieldFactory'\n];","import {\n  forEach,\n  isFunction,\n  isArray,\n  isNumber,\n  isObject\n} from 'min-dash';\n\n\nvar DEFAULT_PRIORITY = 1000;\n\n/**\n * A utility that can be used to plug-in into the command execution for\n * extension and/or validation.\n *\n * @param {EventBus} eventBus\n *\n * @example\n *\n * import inherits from 'inherits';\n *\n * import CommandInterceptor from 'diagram-js/lib/command/CommandInterceptor';\n *\n * function CommandLogger(eventBus) {\n *   CommandInterceptor.call(this, eventBus);\n *\n *   this.preExecute(function(event) {\n *     console.log('command pre-execute', event);\n *   });\n * }\n *\n * inherits(CommandLogger, CommandInterceptor);\n *\n */\nexport default function CommandInterceptor(eventBus) {\n  this._eventBus = eventBus;\n}\n\nCommandInterceptor.$inject = [ 'eventBus' ];\n\nfunction unwrapEvent(fn, that) {\n  return function(event) {\n    return fn.call(that || null, event.context, event.command, event);\n  };\n}\n\n/**\n * Register an interceptor for a command execution\n *\n * @param {string|Array<string>} [events] list of commands to register on\n * @param {string} [hook] command hook, i.e. preExecute, executed to listen on\n * @param {number} [priority] the priority on which to hook into the execution\n * @param {Function} handlerFn interceptor to be invoked with (event)\n * @param {boolean} unwrap if true, unwrap the event and pass (context, command, event) to the\n *                          listener instead\n * @param {Object} [that] Pass context (`this`) to the handler function\n */\nCommandInterceptor.prototype.on = function(events, hook, priority, handlerFn, unwrap, that) {\n\n  if (isFunction(hook) || isNumber(hook)) {\n    that = unwrap;\n    unwrap = handlerFn;\n    handlerFn = priority;\n    priority = hook;\n    hook = null;\n  }\n\n  if (isFunction(priority)) {\n    that = unwrap;\n    unwrap = handlerFn;\n    handlerFn = priority;\n    priority = DEFAULT_PRIORITY;\n  }\n\n  if (isObject(unwrap)) {\n    that = unwrap;\n    unwrap = false;\n  }\n\n  if (!isFunction(handlerFn)) {\n    throw new Error('handlerFn must be a function');\n  }\n\n  if (!isArray(events)) {\n    events = [ events ];\n  }\n\n  var eventBus = this._eventBus;\n\n  forEach(events, function(event) {\n\n    // concat commandStack(.event)?(.hook)?\n    var fullEvent = [ 'commandStack', event, hook ].filter(function(e) { return e; }).join('.');\n\n    eventBus.on(fullEvent, priority, unwrap ? unwrapEvent(handlerFn, that) : handlerFn, that);\n  });\n};\n\n\nvar hooks = [\n  'canExecute',\n  'preExecute',\n  'preExecuted',\n  'execute',\n  'executed',\n  'postExecute',\n  'postExecuted',\n  'revert',\n  'reverted'\n];\n\n/*\n * Install hook shortcuts\n *\n * This will generate the CommandInterceptor#(preExecute|...|reverted) methods\n * which will in term forward to CommandInterceptor#on.\n */\nforEach(hooks, function(hook) {\n\n  /**\n   * {canExecute|preExecute|preExecuted|execute|executed|postExecute|postExecuted|revert|reverted}\n   *\n   * A named hook for plugging into the command execution\n   *\n   * @param {string|Array<string>} [events] list of commands to register on\n   * @param {number} [priority] the priority on which to hook into the execution\n   * @param {Function} handlerFn interceptor to be invoked with (event)\n   * @param {boolean} [unwrap=false] if true, unwrap the event and pass (context, command, event) to the\n   *                          listener instead\n   * @param {Object} [that] Pass context (`this`) to the handler function\n   */\n  CommandInterceptor.prototype[hook] = function(events, priority, handlerFn, unwrap, that) {\n\n    if (isFunction(events) || isNumber(events)) {\n      that = unwrap;\n      unwrap = handlerFn;\n      handlerFn = priority;\n      priority = events;\n      events = null;\n    }\n\n    this.on(events, hook, priority, handlerFn, unwrap, that);\n  };\n});\n","import CommandInterceptor from 'diagram-js/lib/command/CommandInterceptor';\n\nexport default class IdBehavior extends CommandInterceptor {\n  constructor(eventBus, modeling) {\n    super(eventBus);\n\n    // @ts-ignore-next-line\n    this.preExecute('formField.remove', function(context) {\n      const { formField } = context;\n\n      const { id } = formField;\n\n      modeling.unclaimId(formField, id);\n    }, true);\n\n    // @ts-ignore-next-line\n    this.preExecute('formField.edit', function(context) {\n      const {\n        formField,\n        properties\n      } = context;\n\n      if ('id' in properties) {\n        modeling.unclaimId(formField, formField.id);\n\n        modeling.claimId(formField, properties.id);\n      }\n    }, true);\n  }\n}\n\nIdBehavior.$inject = [ 'eventBus', 'modeling' ];","import CommandInterceptor from 'diagram-js/lib/command/CommandInterceptor';\n\nexport default class KeyBehavior extends CommandInterceptor {\n  constructor(eventBus, modeling) {\n    super(eventBus);\n\n    // @ts-ignore-next-line\n    this.preExecute('formField.remove', function(context) {\n      const { formField } = context;\n\n      const { key } = formField;\n\n      if (key) {\n        modeling.unclaimKey(formField, key);\n      }\n    }, true);\n\n    // @ts-ignore-next-line\n    this.preExecute('formField.edit', function(context) {\n      const {\n        formField,\n        properties\n      } = context;\n\n      if ('key' in properties) {\n        modeling.unclaimKey(formField, formField.key);\n\n        modeling.claimKey(formField, properties.key);\n      }\n    }, true);\n  }\n}\n\nKeyBehavior.$inject = [ 'eventBus', 'modeling' ];","import IdBehavior from './IdBehavior';\nimport KeyBehavior from './KeyBehavior';\n\nexport default {\n  __init__: [\n    'idBehavior',\n    'keyBehavior'\n  ],\n  idBehavior: [ 'type', IdBehavior ],\n  keyBehavior: [ 'type', KeyBehavior ]\n};\n","import {\n  uniqueBy,\n  isArray\n} from 'min-dash';\n\n\n/**\n * A service that offers un- and redoable execution of commands.\n *\n * The command stack is responsible for executing modeling actions\n * in a un- and redoable manner. To do this it delegates the actual\n * command execution to {@link CommandHandler}s.\n *\n * Command handlers provide {@link CommandHandler#execute(ctx)} and\n * {@link CommandHandler#revert(ctx)} methods to un- and redo a command\n * identified by a command context.\n *\n *\n * ## Life-Cycle events\n *\n * In the process the command stack fires a number of life-cycle events\n * that other components to participate in the command execution.\n *\n *    * preExecute\n *    * preExecuted\n *    * execute\n *    * executed\n *    * postExecute\n *    * postExecuted\n *    * revert\n *    * reverted\n *\n * A special event is used for validating, whether a command can be\n * performed prior to its execution.\n *\n *    * canExecute\n *\n * Each of the events is fired as `commandStack.{eventName}` and\n * `commandStack.{commandName}.{eventName}`, respectively. This gives\n * components fine grained control on where to hook into.\n *\n * The event object fired transports `command`, the name of the\n * command and `context`, the command context.\n *\n *\n * ## Creating Command Handlers\n *\n * Command handlers should provide the {@link CommandHandler#execute(ctx)}\n * and {@link CommandHandler#revert(ctx)} methods to implement\n * redoing and undoing of a command.\n *\n * A command handler _must_ ensure undo is performed properly in order\n * not to break the undo chain. It must also return the shapes that\n * got changed during the `execute` and `revert` operations.\n *\n * Command handlers may execute other modeling operations (and thus\n * commands) in their `preExecute` and `postExecute` phases. The command\n * stack will properly group all commands together into a logical unit\n * that may be re- and undone atomically.\n *\n * Command handlers must not execute other commands from within their\n * core implementation (`execute`, `revert`).\n *\n *\n * ## Change Tracking\n *\n * During the execution of the CommandStack it will keep track of all\n * elements that have been touched during the command's execution.\n *\n * At the end of the CommandStack execution it will notify interested\n * components via an 'elements.changed' event with all the dirty\n * elements.\n *\n * The event can be picked up by components that are interested in the fact\n * that elements have been changed. One use case for this is updating\n * their graphical representation after moving / resizing or deletion.\n *\n * @see CommandHandler\n *\n * @param {EventBus} eventBus\n * @param {Injector} injector\n */\nexport default function CommandStack(eventBus, injector) {\n\n  /**\n   * A map of all registered command handlers.\n   *\n   * @type {Object}\n   */\n  this._handlerMap = {};\n\n  /**\n   * A stack containing all re/undoable actions on the diagram\n   *\n   * @type {Array<Object>}\n   */\n  this._stack = [];\n\n  /**\n   * The current index on the stack\n   *\n   * @type {number}\n   */\n  this._stackIdx = -1;\n\n  /**\n   * Current active commandStack execution\n   *\n   * @type {Object}\n   * @property {Object[]} actions\n   * @property {Object[]} dirty\n   * @property { 'undo' | 'redo' | 'clear' | 'execute' | null } trigger the cause of the current excecution\n   */\n  this._currentExecution = {\n    actions: [],\n    dirty: [],\n    trigger: null\n  };\n\n\n  this._injector = injector;\n  this._eventBus = eventBus;\n\n  this._uid = 1;\n\n  eventBus.on([\n    'diagram.destroy',\n    'diagram.clear'\n  ], function() {\n    this.clear(false);\n  }, this);\n}\n\nCommandStack.$inject = [ 'eventBus', 'injector' ];\n\n\n/**\n * Execute a command\n *\n * @param {string} command the command to execute\n * @param {Object} context the environment to execute the command in\n */\nCommandStack.prototype.execute = function(command, context) {\n  if (!command) {\n    throw new Error('command required');\n  }\n\n  this._currentExecution.trigger = 'execute';\n\n  var action = { command: command, context: context };\n\n  this._pushAction(action);\n  this._internalExecute(action);\n  this._popAction(action);\n};\n\n\n/**\n * Ask whether a given command can be executed.\n *\n * Implementors may hook into the mechanism on two ways:\n *\n *   * in event listeners:\n *\n *     Users may prevent the execution via an event listener.\n *     It must prevent the default action for `commandStack.(<command>.)canExecute` events.\n *\n *   * in command handlers:\n *\n *     If the method {@link CommandHandler#canExecute} is implemented in a handler\n *     it will be called to figure out whether the execution is allowed.\n *\n * @param  {string} command the command to execute\n * @param  {Object} context the environment to execute the command in\n *\n * @return {boolean} true if the command can be executed\n */\nCommandStack.prototype.canExecute = function(command, context) {\n\n  var action = { command: command, context: context };\n\n  var handler = this._getHandler(command);\n\n  var result = this._fire(command, 'canExecute', action);\n\n  // handler#canExecute will only be called if no listener\n  // decided on a result already\n  if (result === undefined) {\n    if (!handler) {\n      return false;\n    }\n\n    if (handler.canExecute) {\n      result = handler.canExecute(context);\n    }\n  }\n\n  return result;\n};\n\n\n/**\n * Clear the command stack, erasing all undo / redo history\n */\nCommandStack.prototype.clear = function(emit) {\n  this._stack.length = 0;\n  this._stackIdx = -1;\n\n  if (emit !== false) {\n    this._fire('changed', { trigger: 'clear' });\n  }\n};\n\n\n/**\n * Undo last command(s)\n */\nCommandStack.prototype.undo = function() {\n  var action = this._getUndoAction(),\n      next;\n\n  if (action) {\n    this._currentExecution.trigger = 'undo';\n\n    this._pushAction(action);\n\n    while (action) {\n      this._internalUndo(action);\n      next = this._getUndoAction();\n\n      if (!next || next.id !== action.id) {\n        break;\n      }\n\n      action = next;\n    }\n\n    this._popAction();\n  }\n};\n\n\n/**\n * Redo last command(s)\n */\nCommandStack.prototype.redo = function() {\n  var action = this._getRedoAction(),\n      next;\n\n  if (action) {\n    this._currentExecution.trigger = 'redo';\n\n    this._pushAction(action);\n\n    while (action) {\n      this._internalExecute(action, true);\n      next = this._getRedoAction();\n\n      if (!next || next.id !== action.id) {\n        break;\n      }\n\n      action = next;\n    }\n\n    this._popAction();\n  }\n};\n\n\n/**\n * Register a handler instance with the command stack\n *\n * @param {string} command\n * @param {CommandHandler} handler\n */\nCommandStack.prototype.register = function(command, handler) {\n  this._setHandler(command, handler);\n};\n\n\n/**\n * Register a handler type with the command stack\n * by instantiating it and injecting its dependencies.\n *\n * @param {string} command\n * @param {Function} a constructor for a {@link CommandHandler}\n */\nCommandStack.prototype.registerHandler = function(command, handlerCls) {\n\n  if (!command || !handlerCls) {\n    throw new Error('command and handlerCls must be defined');\n  }\n\n  var handler = this._injector.instantiate(handlerCls);\n  this.register(command, handler);\n};\n\nCommandStack.prototype.canUndo = function() {\n  return !!this._getUndoAction();\n};\n\nCommandStack.prototype.canRedo = function() {\n  return !!this._getRedoAction();\n};\n\n// stack access  //////////////////////\n\nCommandStack.prototype._getRedoAction = function() {\n  return this._stack[this._stackIdx + 1];\n};\n\n\nCommandStack.prototype._getUndoAction = function() {\n  return this._stack[this._stackIdx];\n};\n\n\n// internal functionality //////////////////////\n\nCommandStack.prototype._internalUndo = function(action) {\n  var self = this;\n\n  var command = action.command,\n      context = action.context;\n\n  var handler = this._getHandler(command);\n\n  // guard against illegal nested command stack invocations\n  this._atomicDo(function() {\n    self._fire(command, 'revert', action);\n\n    if (handler.revert) {\n      self._markDirty(handler.revert(context));\n    }\n\n    self._revertedAction(action);\n\n    self._fire(command, 'reverted', action);\n  });\n};\n\n\nCommandStack.prototype._fire = function(command, qualifier, event) {\n  if (arguments.length < 3) {\n    event = qualifier;\n    qualifier = null;\n  }\n\n  var names = qualifier ? [ command + '.' + qualifier, qualifier ] : [ command ],\n      i, name, result;\n\n  event = this._eventBus.createEvent(event);\n\n  for (i = 0; (name = names[i]); i++) {\n    result = this._eventBus.fire('commandStack.' + name, event);\n\n    if (event.cancelBubble) {\n      break;\n    }\n  }\n\n  return result;\n};\n\nCommandStack.prototype._createId = function() {\n  return this._uid++;\n};\n\nCommandStack.prototype._atomicDo = function(fn) {\n\n  var execution = this._currentExecution;\n\n  execution.atomic = true;\n\n  try {\n    fn();\n  } finally {\n    execution.atomic = false;\n  }\n};\n\nCommandStack.prototype._internalExecute = function(action, redo) {\n  var self = this;\n\n  var command = action.command,\n      context = action.context;\n\n  var handler = this._getHandler(command);\n\n  if (!handler) {\n    throw new Error('no command handler registered for <' + command + '>');\n  }\n\n  this._pushAction(action);\n\n  if (!redo) {\n    this._fire(command, 'preExecute', action);\n\n    if (handler.preExecute) {\n      handler.preExecute(context);\n    }\n\n    this._fire(command, 'preExecuted', action);\n  }\n\n  // guard against illegal nested command stack invocations\n  this._atomicDo(function() {\n\n    self._fire(command, 'execute', action);\n\n    if (handler.execute) {\n\n      // actual execute + mark return results as dirty\n      self._markDirty(handler.execute(context));\n    }\n\n    // log to stack\n    self._executedAction(action, redo);\n\n    self._fire(command, 'executed', action);\n  });\n\n  if (!redo) {\n    this._fire(command, 'postExecute', action);\n\n    if (handler.postExecute) {\n      handler.postExecute(context);\n    }\n\n    this._fire(command, 'postExecuted', action);\n  }\n\n  this._popAction(action);\n};\n\n\nCommandStack.prototype._pushAction = function(action) {\n\n  var execution = this._currentExecution,\n      actions = execution.actions;\n\n  var baseAction = actions[0];\n\n  if (execution.atomic) {\n    throw new Error('illegal invocation in <execute> or <revert> phase (action: ' + action.command + ')');\n  }\n\n  if (!action.id) {\n    action.id = (baseAction && baseAction.id) || this._createId();\n  }\n\n  actions.push(action);\n};\n\n\nCommandStack.prototype._popAction = function() {\n  var execution = this._currentExecution,\n      trigger = execution.trigger,\n      actions = execution.actions,\n      dirty = execution.dirty;\n\n  actions.pop();\n\n  if (!actions.length) {\n    this._eventBus.fire('elements.changed', { elements: uniqueBy('id', dirty.reverse()) });\n\n    dirty.length = 0;\n\n    this._fire('changed', { trigger: trigger });\n\n    execution.trigger = null;\n  }\n};\n\n\nCommandStack.prototype._markDirty = function(elements) {\n  var execution = this._currentExecution;\n\n  if (!elements) {\n    return;\n  }\n\n  elements = isArray(elements) ? elements : [ elements ];\n\n  execution.dirty = execution.dirty.concat(elements);\n};\n\n\nCommandStack.prototype._executedAction = function(action, redo) {\n  var stackIdx = ++this._stackIdx;\n\n  if (!redo) {\n    this._stack.splice(stackIdx, this._stack.length, action);\n  }\n};\n\n\nCommandStack.prototype._revertedAction = function(action) {\n  this._stackIdx--;\n};\n\n\nCommandStack.prototype._getHandler = function(command) {\n  return this._handlerMap[command];\n};\n\nCommandStack.prototype._setHandler = function(command, handler) {\n  if (!command || !handler) {\n    throw new Error('command and handler required');\n  }\n\n  if (this._handlerMap[command]) {\n    throw new Error('overriding handler for command <' + command + '>');\n  }\n\n  this._handlerMap[command] = handler;\n};\n","import CommandStack from './CommandStack';\n\nexport default {\n  commandStack: [ 'type', CommandStack ]\n};\n","import Modeling from './Modeling';\n\nimport behaviorModule from './behavior';\nimport commandModule from 'diagram-js/lib/command';\n\nexport default {\n  __depends__: [\n    behaviorModule,\n    commandModule\n  ],\n  __init__: [ 'modeling' ],\n  modeling: [ 'type', Modeling ]\n};\n","export default class Selection {\n  constructor(eventBus) {\n    this._eventBus = eventBus;\n    this._selection = null;\n  }\n\n  get() {\n    return this._selection;\n  }\n\n  set(selection) {\n    if (this._selection === selection) {\n      return;\n    }\n\n    this._selection = selection;\n\n    this._eventBus.fire('selection.changed', {\n      selection: this._selection\n    });\n  }\n\n  toggle(selection) {\n    const newSelection = this._selection === selection ? null : selection;\n\n    this.set(newSelection);\n  }\n\n  clear() {\n    this.set(null);\n  }\n\n  isSelected(formField) {\n    return this._selection === formField;\n  }\n}\n\nSelection.$inject = [ 'eventBus' ];","export default class SelectionBehavior {\n  constructor(eventBus, selection) {\n    eventBus.on([\n      'commandStack.formField.add.postExecuted',\n      'commandStack.formField.move.postExecuted'\n    ], ({ context }) => {\n      const { formField } = context;\n\n      selection.set(formField);\n    });\n\n    eventBus.on('commandStack.formField.remove.postExecuted', ({ context }) => {\n      const {\n        sourceFormField,\n        sourceIndex\n      } = context;\n\n      const formField = sourceFormField.components[ sourceIndex ] || sourceFormField.components[ sourceIndex - 1 ];\n\n      if (formField) {\n        selection.set(formField);\n      } else {\n        selection.clear();\n      }\n    });\n\n    eventBus.on('formField.remove', ({ formField }) => {\n      if (selection.isSelected(formField)) {\n        selection.clear();\n      }\n    });\n  }\n}\n\nSelectionBehavior.$inject = [ 'eventBus', 'selection' ];","import Selection from './Selection';\nimport SelectionBehavior from './SelectionBehavior';\n\nexport default {\n  __init__: [ 'selection', 'selectionBehavior' ],\n  selection: [ 'type', Selection ],\n  selectionBehavior: [ 'type', SelectionBehavior ]\n};","import { iconsByType } from '../../../render/components/icons';\n\nconst types = [\n  {\n    label: 'Text Field',\n    type: 'textfield'\n  },\n  {\n    label: 'Number',\n    type: 'number'\n  },\n  {\n    label: 'Checkbox',\n    type: 'checkbox'\n  },\n  {\n    label: 'Checklist',\n    type: 'checklist'\n  },\n  {\n    label: 'Taglist',\n    type: 'taglist'\n  },\n  {\n    label: 'Radio',\n    type: 'radio'\n  },\n  {\n    label: 'Select',\n    type: 'select'\n  },\n  {\n    label: 'Text',\n    type: 'text'\n  },\n  {\n    label: 'Button',\n    type: 'button'\n  }\n];\n\n\nexport default function Palette(props) {\n  return <div class=\"fjs-palette\">\n    <div class=\"fjs-palette-header\" title=\"Form elements library\">\n      <span class=\"fjs-hide-compact\">FORM ELEMENTS </span>LIBRARY\n    </div>\n    <div class=\"fjs-palette-fields fjs-drag-container fjs-no-drop\">\n      {\n        types.map(({ label, type }) => {\n          const Icon = iconsByType[ type ];\n\n          return (\n            <div\n              class=\"fjs-palette-field fjs-drag-copy fjs-no-drop\"\n              data-field-type={ type }\n              title={ `Create a ${ label } element` }\n            >\n              {\n                Icon ? <Icon class=\"fjs-palette-field-icon\" width=\"36\" height=\"36\" viewBox=\"0 0 54 54\" /> : null\n              }\n              <span class=\"fjs-palette-field-text\">{ label }</span>\n            </div>\n          );\n        })\n      }\n    </div>\n  </div>;\n}","import Palette from './components/Palette';\n\nimport {\n  render\n} from 'preact';\n\nimport {\n  domify,\n  query as domQuery\n} from 'min-dom';\n\n\n/**\n * @typedef { { parent: Element } } PaletteConfig\n * @typedef { import('../../core/EventBus').default } EventBus\n */\n\n/**\n * @param {PaletteConfig} paletteConfig\n * @param {EventBus} eventBus\n */\nexport default class PaletteRenderer {\n\n  constructor(paletteConfig, eventBus) {\n    const {\n      parent\n    } = paletteConfig || {};\n\n    this._eventBus = eventBus;\n\n    this._container = domify('<div class=\"fjs-palette-container\"></div>');\n\n    if (parent) {\n      this.attachTo(parent);\n    }\n\n    this._eventBus.once('formEditor.rendered', 500, () => {\n      this._render();\n    });\n  }\n\n\n  /**\n   * Attach the palette to a parent node.\n   *\n   * @param {HTMLElement} container\n   */\n  attachTo(container) {\n    if (!container) {\n      throw new Error('container required');\n    }\n\n    if (typeof container === 'string') {\n      container = domQuery(container);\n    }\n\n    // (1) detach from old parent\n    this.detach();\n\n    // (2) append to parent container\n    container.appendChild(this._container);\n\n    // (3) notify interested parties\n    this._eventBus.fire('palette.attach');\n  }\n\n  /**\n   * Detach the palette from its parent node.\n   */\n  detach() {\n    const parentNode = this._container.parentNode;\n\n    if (parentNode) {\n      parentNode.removeChild(this._container);\n\n      this._eventBus.fire('palette.detach');\n    }\n  }\n\n  _render() {\n    render(\n      <Palette />,\n      this._container\n    );\n\n    this._eventBus.fire('palette.rendered');\n  }\n\n  _destroy() {\n    if (this._container) {\n      render(null, this._container);\n\n      this._eventBus.fire('palette.destroyed');\n    }\n  }\n}\n\nPaletteRenderer.$inject = [ 'config.palette', 'eventBus' ];","import PaletteRenderer from './PaletteRenderer';\n\nexport default {\n  palette: [ 'type', PaletteRenderer ]\n};\n","import { useContext, useEffect, useRef, useMemo, useState, useCallback } from '../preact/hooks';\nimport { isFunction, isArray, get, assign, set, sortBy, find, isNumber, debounce } from 'min-dash';\nimport classnames from 'classnames';\nimport '../preact/compat';\nimport { jsx, jsxs } from '../preact/jsx-runtime';\nimport { query } from 'min-dom';\nimport { createContext, createElement } from '../preact';\n\nvar ArrowIcon = function ArrowIcon(props) {\n  return jsx(\"svg\", { ...props,\n    children: jsx(\"path\", {\n      fillRule: \"evenodd\",\n      d: \"m11.657 8-4.95 4.95a1 1 0 0 1-1.414-1.414L8.828 8 5.293 4.464A1 1 0 1 1 6.707 3.05L11.657 8z\"\n    })\n  });\n};\n\nArrowIcon.defaultProps = {\n  xmlns: \"http://www.w3.org/2000/svg\",\n  width: \"16\",\n  height: \"16\"\n};\n\nvar CreateIcon = function CreateIcon(props) {\n  return jsx(\"svg\", { ...props,\n    children: jsx(\"path\", {\n      fillRule: \"evenodd\",\n      d: \"M9 13V9h4a1 1 0 0 0 0-2H9V3a1 1 0 1 0-2 0v4H3a1 1 0 1 0 0 2h4v4a1 1 0 0 0 2 0z\"\n    })\n  });\n};\n\nCreateIcon.defaultProps = {\n  xmlns: \"http://www.w3.org/2000/svg\",\n  width: \"16\",\n  height: \"16\"\n};\n\nvar DeleteIcon = function DeleteIcon(props) {\n  return jsx(\"svg\", { ...props,\n    children: jsx(\"path\", {\n      fillRule: \"evenodd\",\n      d: \"M12 6v7c0 1.1-.4 1.55-1.5 1.55h-5C4.4 14.55 4 14.1 4 13V6h8zm-1.5 1.5h-5v4.3c0 .66.5 1.2 1.111 1.2H9.39c.611 0 1.111-.54 1.111-1.2V7.5zM13 3h-2l-1-1H6L5 3H3v1.5h10V3z\"\n    })\n  });\n};\n\nDeleteIcon.defaultProps = {\n  xmlns: \"http://www.w3.org/2000/svg\",\n  width: \"16\",\n  height: \"16\"\n};\n\nvar ExternalLinkIcon = function ExternalLinkIcon(props) {\n  return jsx(\"svg\", { ...props,\n    children: jsx(\"path\", {\n      fillRule: \"evenodd\",\n      clipRule: \"evenodd\",\n      d: \"M12.637 12.637v-4.72h1.362v4.721c0 .36-.137.676-.411.95-.275.275-.591.412-.95.412H3.362c-.38 0-.703-.132-.967-.396A1.315 1.315 0 0 1 2 12.638V3.362c0-.38.132-.703.396-.967S2.982 2 3.363 2h4.553v1.363H3.363v9.274h9.274zM14 2H9.28l-.001 1.362h2.408L5.065 9.984l.95.95 6.622-6.622v2.409H14V2z\",\n      fill: \"#818798\"\n    })\n  });\n};\n\nExternalLinkIcon.defaultProps = {\n  width: \"16\",\n  height: \"16\",\n  fill: \"none\",\n  xmlns: \"http://www.w3.org/2000/svg\"\n};\n\nvar FeelRequiredIcon = function FeelRequiredIcon(props) {\n  return jsxs(\"svg\", { ...props,\n    children: [jsx(\"path\", {\n      d: \"M5.8 7.06V5.95h4.307v1.11H5.8zm0 3.071v-1.11h4.307v1.11H5.8z\",\n      fill: \"#505562\"\n    }), jsx(\"path\", {\n      fillRule: \"evenodd\",\n      clipRule: \"evenodd\",\n      d: \"M8 3.268A4.732 4.732 0 1 0 12.732 8H14a6 6 0 1 1-6-6v1.268z\",\n      fill: \"#505562\"\n    }), jsx(\"path\", {\n      d: \"m11.28 6.072-.832-.56 1.016-1.224L10 3.848l.312-.912 1.392.584L11.632 2h1.032l-.072 1.52 1.392-.584.312.912-1.464.44 1.008 1.224-.832.552-.864-1.296-.864 1.304z\",\n      fill: \"#505562\"\n    })]\n  });\n};\n\nFeelRequiredIcon.defaultProps = {\n  viewBox: \"0 0 16 16\",\n  fill: \"none\",\n  xmlns: \"http://www.w3.org/2000/svg\"\n};\n\nvar FeelOptionalIcon = function FeelOptionalIcon(props) {\n  return jsxs(\"svg\", { ...props,\n    children: [jsx(\"path\", {\n      d: \"M5.845 7.04V5.93h4.307v1.11H5.845zm0 3.07V9h4.307v1.11H5.845z\",\n      fill: \"#505562\"\n    }), jsx(\"path\", {\n      fillRule: \"evenodd\",\n      clipRule: \"evenodd\",\n      d: \"M3.286 8a4.714 4.714 0 1 0 9.428 0 4.714 4.714 0 0 0-9.428 0zM8 2a6 6 0 1 0 0 12A6 6 0 0 0 8 2z\",\n      fill: \"#505562\"\n    })]\n  });\n};\n\nFeelOptionalIcon.defaultProps = {\n  viewBox: \"0 0 16 16\",\n  fill: \"none\",\n  xmlns: \"http://www.w3.org/2000/svg\"\n};\n\nfunction Header(props) {\n  const {\n    element,\n    headerProvider\n  } = props;\n  const {\n    getElementIcon,\n    getDocumentationRef,\n    getElementLabel,\n    getTypeLabel\n  } = headerProvider;\n  const label = getElementLabel(element);\n  const type = getTypeLabel(element);\n  const documentationRef = getDocumentationRef && getDocumentationRef(element);\n  const ElementIcon = getElementIcon(element);\n  return jsxs(\"div\", {\n    class: \"bio-properties-panel-header\",\n    children: [jsx(\"div\", {\n      class: \"bio-properties-panel-header-icon\",\n      children: ElementIcon && jsx(ElementIcon, {\n        width: \"32\",\n        height: \"32\",\n        viewBox: \"0 0 32 32\"\n      })\n    }), jsxs(\"div\", {\n      class: \"bio-properties-panel-header-labels\",\n      children: [jsx(\"div\", {\n        title: type,\n        class: \"bio-properties-panel-header-type\",\n        children: type\n      }), label ? jsx(\"div\", {\n        title: label,\n        class: \"bio-properties-panel-header-label\",\n        children: label\n      }) : null]\n    }), jsx(\"div\", {\n      class: \"bio-properties-panel-header-actions\",\n      children: documentationRef ? jsx(\"a\", {\n        rel: \"noopener\",\n        class: \"bio-properties-panel-header-link\",\n        href: documentationRef,\n        title: \"Open documentation\",\n        target: \"_blank\",\n        children: jsx(ExternalLinkIcon, {})\n      }) : null\n    })]\n  });\n}\n\nconst DescriptionContext = createContext({\n  description: {},\n  getDescriptionForId: () => {}\n});\n\n/**\n * @typedef {Function} <propertiesPanel.showEntry> callback\n *\n * @example\n *\n * useEvent('propertiesPanel.showEntry', ({ focus = false, ...rest }) => {\n *   // ...\n * });\n *\n * @param {Object} context\n * @param {boolean} [context.focus]\n *\n * @returns void\n */\nconst EventContext = createContext({\n  eventBus: null\n});\n\nconst LayoutContext = createContext({\n  layout: {},\n  setLayout: () => {},\n  getLayoutForKey: () => {},\n  setLayoutForKey: () => {}\n});\n\n/**\n * Accesses the global DescriptionContext and returns a description for a given id and element.\n *\n * @example\n * ```jsx\n * function TextField(props) {\n *   const description = useDescriptionContext('input1', element);\n * }\n * ```\n *\n * @param {string} id\n * @param {object} element\n *\n * @returns {string}\n */\n\nfunction useDescriptionContext(id, element) {\n  const {\n    getDescriptionForId\n  } = useContext(DescriptionContext);\n  return getDescriptionForId(id, element);\n}\n\nconst DEFAULT_PRIORITY = 1000;\n/**\n * Subscribe to an event.\n *\n * @param {string} event\n * @param {Function} callback\n * @param {number} [priority]\n *\n * @returns {import('preact').Ref}\n */\n\nfunction useEvent(event, callback, priority = DEFAULT_PRIORITY) {\n  const {\n    eventBus\n  } = useContext(EventContext);\n  useEffect(() => {\n    if (!eventBus) {\n      return;\n    }\n\n    eventBus.on(event, priority, callback);\n    return () => eventBus.off(event, callback);\n  }, [callback, event, eventBus, priority]);\n}\n\nconst HIGH_PRIORITY = 10000;\n/**\n * Buffer events and re-fire during passive effect phase.\n *\n * @param {string[]} bufferedEvents\n * @param {Object} [eventBus]\n */\n\nfunction useEventBuffer(bufferedEvents, eventBus) {\n  const buffer = useRef([]),\n        buffering = useRef(true);\n\n  const createCallback = event => data => {\n    if (buffering.current === true) {\n      buffer.current.unshift([event, data]);\n    }\n  }; // (1) buffer events\n\n\n  useEffect(() => {\n    if (!eventBus) {\n      return;\n    }\n\n    const listeners = bufferedEvents.map(event => {\n      return [event, createCallback(event)];\n    });\n    listeners.forEach(([event, callback]) => {\n      eventBus.on(event, HIGH_PRIORITY, callback);\n    });\n    return () => {\n      listeners.forEach(([event, callback]) => {\n        eventBus.off(event, callback);\n      });\n    };\n  }, [bufferedEvents, eventBus]); // (2) re-fire events\n\n  useEffect(() => {\n    if (!eventBus) {\n      return;\n    }\n\n    buffering.current = false;\n\n    while (buffer.current.length) {\n      const [event, data] = buffer.current.pop();\n      eventBus.fire(event, data);\n    }\n\n    buffering.current = true;\n  });\n}\n\nconst KEY_LENGTH = 6;\n/**\n * Create a persistent key factory for plain objects without id.\n *\n * @example\n * ```jsx\n * function List({ objects }) {\n *   const getKey = useKeyFactory();\n *   return (<ol>{\n *     objects.map(obj => {\n *       const key = getKey(obj);\n *       return <li key={key}>obj.name</li>\n *     })\n *   }</ol>);\n * }\n * ```\n *\n * @param {any[]} dependencies\n * @returns {(element: object) => string}\n */\n\nfunction useKeyFactory(dependencies = []) {\n  const map = useMemo(() => new Map(), dependencies);\n\n  const getKey = el => {\n    let key = map.get(el);\n\n    if (!key) {\n      key = Math.random().toString().slice(-KEY_LENGTH);\n      map.set(el, key);\n    }\n\n    return key;\n  };\n\n  return getKey;\n}\n\n/**\n * Creates a state that persists in the global LayoutContext.\n *\n * @example\n * ```jsx\n * function Group(props) {\n *   const [ open, setOpen ] = useLayoutState([ 'groups', 'foo', 'open' ], false);\n * }\n * ```\n *\n * @param {(string|number)[]} path\n * @param {any} [defaultValue]\n *\n * @returns {[ any, Function ]}\n */\n\nfunction useLayoutState(path, defaultValue) {\n  const {\n    getLayoutForKey,\n    setLayoutForKey\n  } = useContext(LayoutContext);\n  const layoutForKey = getLayoutForKey(path, defaultValue);\n  const [value, set] = useState(layoutForKey);\n\n  const setState = newValue => {\n    // (1) set component state\n    set(newValue); // (2) set context\n\n    setLayoutForKey(path, newValue);\n  };\n\n  return [value, setState];\n}\n\n/**\n * @pinussilvestrus: we need to introduce our own hook to persist the previous\n * state on updates.\n *\n * cf. https://reactjs.org/docs/hooks-faq.html#how-to-get-the-previous-props-or-state\n */\n\nfunction usePrevious(value) {\n  const ref = useRef();\n  useEffect(() => {\n    ref.current = value;\n  });\n  return ref.current;\n}\n\n/**\n * Subscribe to `propertiesPanel.showEntry`.\n *\n * @param {Function} show\n *\n * @returns {import('preact').Ref}\n */\n\nfunction useShowEntryEvent(show) {\n  const {\n    onShow\n  } = useContext(LayoutContext);\n  const ref = useRef();\n  const [focus, setFocus] = useState(false);\n  const onShowEntry = useCallback(event => {\n    if (show(event)) {\n      if (isFunction(onShow)) {\n        onShow();\n      }\n\n      if (event.focus && !focus) {\n        setFocus(true);\n      }\n    }\n  }, [show]);\n  useEffect(() => {\n    if (focus && ref.current) {\n      if (isFunction(ref.current.focus)) {\n        ref.current.focus();\n      }\n\n      if (isFunction(ref.current.select)) {\n        ref.current.select();\n      }\n\n      setFocus(false);\n    }\n  }, [focus]);\n  useEvent('propertiesPanel.showEntry', onShowEntry);\n  return ref;\n}\n\n/**\n * Subscribe to `propertiesPanel.showError`. On `propertiesPanel.showError` set\n * temporary error. Fire `propertiesPanel.showEntry` for temporary error to be\n * visible. Unset error on `propertiesPanel.updated`.\n *\n * @param {Function} show\n *\n * @returns {import('preact').Ref}\n */\n\nfunction useShowErrorEvent(show) {\n  const {\n    eventBus\n  } = useContext(EventContext);\n  const [temporaryError, setTemporaryError] = useState(null);\n  const onPropertiesPanelUpdated = useCallback(() => setTemporaryError(null), []);\n  useEvent('propertiesPanel.updated', onPropertiesPanelUpdated);\n  const onShowError = useCallback(event => {\n    setTemporaryError(null);\n\n    if (show(event)) {\n      if (eventBus) {\n        eventBus.fire('propertiesPanel.showEntry', event);\n      }\n\n      setTemporaryError(event.message);\n    }\n  }, [show]);\n  useEvent('propertiesPanel.showError', onShowError);\n  return temporaryError;\n}\n\n/**\n * @callback setSticky\n * @param {boolean} value\n */\n\n/**\n * Use IntersectionObserver to identify when DOM element is in sticky mode.\n * If sticky is observered setSticky(true) will be called.\n * If sticky mode is left, setSticky(false) will be called.\n *\n *\n * @param {Object} ref\n * @param {string} scrollContainerSelector\n * @param {setSticky} setSticky\n */\n\nfunction useStickyIntersectionObserver(ref, scrollContainerSelector, setSticky) {\n  useEffect(() => {\n    // return early if IntersectionObserver is not available\n    if (!IntersectionObserver) {\n      return;\n    }\n\n    let observer;\n\n    if (ref.current) {\n      const scrollContainer = query(scrollContainerSelector);\n      observer = new IntersectionObserver(entries => {\n        if (entries[0].intersectionRatio < 1) {\n          setSticky(true);\n        } else if (entries[0].intersectionRatio === 1) {\n          setSticky(false);\n        }\n      }, {\n        root: scrollContainer,\n        rootMargin: '0px 0px 999999% 0px',\n        // Use bottom margin to avoid stickyness when scrolling out to bottom\n        threshold: [1]\n      });\n      observer.observe(ref.current);\n    } // Unobserve if unmounted\n\n\n    return () => {\n      if (ref.current && observer) {\n        observer.unobserve(ref.current);\n      }\n    };\n  }, [ref]);\n}\n\nfunction Group(props) {\n  const {\n    element,\n    entries = [],\n    id,\n    label,\n    shouldOpen = false\n  } = props;\n  const groupRef = useRef(null);\n  const [open, setOpen] = useLayoutState(['groups', id, 'open'], shouldOpen);\n  const onShow = useCallback(() => setOpen(true), [setOpen]);\n\n  const toggleOpen = () => setOpen(!open);\n\n  const [edited, setEdited] = useState(false);\n  const [sticky, setSticky] = useState(false); // set edited state depending on all entries\n\n  useEffect(() => {\n    const hasOneEditedEntry = entries.find(entry => {\n      const {\n        id,\n        isEdited\n      } = entry;\n      const entryNode = query(`[data-entry-id=\"${id}\"]`);\n\n      if (!isFunction(isEdited) || !entryNode) {\n        return false;\n      }\n\n      const inputNode = query('.bio-properties-panel-input', entryNode);\n      return isEdited(inputNode);\n    });\n    setEdited(hasOneEditedEntry);\n  }, [entries]); // set css class when group is sticky to top\n\n  useStickyIntersectionObserver(groupRef, 'div.bio-properties-panel-scroll-container', setSticky);\n  const propertiesPanelContext = { ...useContext(LayoutContext),\n    onShow\n  };\n  return jsxs(\"div\", {\n    class: \"bio-properties-panel-group\",\n    \"data-group-id\": 'group-' + id,\n    ref: groupRef,\n    children: [jsxs(\"div\", {\n      class: classnames('bio-properties-panel-group-header', edited ? '' : 'empty', open ? 'open' : '', sticky && open ? 'sticky' : ''),\n      onClick: toggleOpen,\n      children: [jsx(\"div\", {\n        title: label,\n        class: \"bio-properties-panel-group-header-title\",\n        children: label\n      }), jsxs(\"div\", {\n        class: \"bio-properties-panel-group-header-buttons\",\n        children: [edited && jsx(DataMarker, {}), jsx(\"button\", {\n          title: \"Toggle section\",\n          class: \"bio-properties-panel-group-header-button bio-properties-panel-arrow\",\n          children: jsx(ArrowIcon, {\n            class: open ? 'bio-properties-panel-arrow-down' : 'bio-properties-panel-arrow-right'\n          })\n        })]\n      })]\n    }), jsx(\"div\", {\n      class: classnames('bio-properties-panel-group-entries', open ? 'open' : ''),\n      children: jsx(LayoutContext.Provider, {\n        value: propertiesPanelContext,\n        children: entries.map(entry => {\n          const {\n            component: Component,\n            id\n          } = entry;\n          return createElement(Component, { ...entry,\n            element: element,\n            key: id\n          });\n        })\n      })\n    })]\n  });\n}\n\nfunction DataMarker() {\n  return jsx(\"div\", {\n    title: \"Section contains data\",\n    class: \"bio-properties-panel-dot\"\n  });\n}\n\n/**\n * @typedef { {\n *  text: (element: object) => string,\n *  icon?: (element: Object) => import('preact').Component\n * } } PlaceholderDefinition\n *\n * @param { PlaceholderDefinition } props\n */\nfunction Placeholder(props) {\n  const {\n    text,\n    icon: Icon\n  } = props;\n  return jsx(\"div\", {\n    class: \"bio-properties-panel open\",\n    children: jsxs(\"section\", {\n      class: \"bio-properties-panel-placeholder\",\n      children: [Icon && jsx(Icon, {\n        class: \"bio-properties-panel-placeholder-icon\"\n      }), jsx(\"p\", {\n        class: \"bio-properties-panel-placeholder-text\",\n        children: text\n      })]\n    })\n  });\n}\n\nconst DEFAULT_LAYOUT = {\n  open: true\n};\nconst DEFAULT_DESCRIPTION = {};\nconst bufferedEvents = ['propertiesPanel.showEntry', 'propertiesPanel.showError'];\n/**\n * @typedef { {\n *    component: import('preact').Component,\n *    id: String,\n *    isEdited?: Function\n * } } EntryDefinition\n *\n * @typedef { {\n *    autoFocusEntry: String,\n *    autoOpen?: Boolean,\n *    entries: Array<EntryDefinition>,\n *    id: String,\n *    label: String,\n *    remove: (event: MouseEvent) => void\n * } } ListItemDefinition\n *\n * @typedef { {\n *    add: (event: MouseEvent) => void,\n *    component: import('preact').Component,\n *    element: Object,\n *    id: String,\n *    items: Array<ListItemDefinition>,\n *    label: String,\n *    shouldSort?: Boolean,\n *    shouldOpen?: Boolean\n * } } ListGroupDefinition\n *\n * @typedef { {\n *    component?: import('preact').Component,\n *    entries: Array<EntryDefinition>,\n *    id: String,\n *    label: String,\n *    shouldOpen?: Boolean\n * } } GroupDefinition\n *\n *  @typedef { {\n *    [id: String]: GetDescriptionFunction\n * } } DescriptionConfig\n *\n * @callback { {\n * @param {string} id\n * @param {Object} element\n * @returns {string}\n * } } GetDescriptionFunction\n *\n * @typedef { {\n *  getEmpty: (element: object) => import('./components/Placeholder').PlaceholderDefinition,\n *  getMultiple: (element: Object) => import('./components/Placeholder').PlaceholderDefinition\n * } } PlaceholderProvider\n *\n */\n\n/**\n * A basic properties panel component. Describes *how* content will be rendered, accepts\n * data from implementor to describe *what* will be rendered.\n *\n * @param {Object} props\n * @param {Object|Array} props.element\n * @param {import('./components/Header').HeaderProvider} props.headerProvider\n * @param {PlaceholderProvider} [props.placeholderProvider]\n * @param {Array<GroupDefinition|ListGroupDefinition>} props.groups\n * @param {Object} [props.layoutConfig]\n * @param {Function} [props.layoutChanged]\n * @param {DescriptionConfig} [props.descriptionConfig]\n * @param {Function} [props.descriptionLoaded]\n * @param {Object} [props.eventBus]\n */\n\nfunction PropertiesPanel(props) {\n  const {\n    element,\n    headerProvider,\n    placeholderProvider,\n    groups,\n    layoutConfig = {},\n    layoutChanged,\n    descriptionConfig = {},\n    descriptionLoaded,\n    eventBus\n  } = props; // set-up layout context\n\n  const [layout, setLayout] = useState(createLayout(layoutConfig));\n  useEffect(() => {\n    if (typeof layoutChanged === 'function') {\n      layoutChanged(layout);\n    }\n  }, [layout, layoutChanged]);\n\n  const getLayoutForKey = (key, defaultValue) => {\n    return get(layout, key, defaultValue);\n  };\n\n  const setLayoutForKey = (key, config) => {\n    const newLayout = assign({}, layout);\n    set(newLayout, key, config);\n    setLayout(newLayout);\n  };\n\n  const layoutContext = {\n    layout,\n    setLayout,\n    getLayoutForKey,\n    setLayoutForKey\n  }; // set-up description context\n\n  const description = createDescriptionContext(descriptionConfig);\n\n  if (typeof descriptionLoaded === 'function') {\n    descriptionLoaded(description);\n  }\n\n  const getDescriptionForId = (id, element) => {\n    return description[id] && description[id](element);\n  };\n\n  const descriptionContext = {\n    description,\n    getDescriptionForId\n  };\n  useEventBuffer(bufferedEvents, eventBus);\n  const eventContext = {\n    eventBus\n  };\n  const propertiesPanelContext = {\n    element\n  }; // empty state\n\n  if (placeholderProvider && !element) {\n    return jsx(Placeholder, { ...placeholderProvider.getEmpty()\n    });\n  } // multiple state\n\n\n  if (placeholderProvider && isArray(element)) {\n    return jsx(Placeholder, { ...placeholderProvider.getMultiple()\n    });\n  }\n\n  return jsx(LayoutContext.Provider, {\n    value: propertiesPanelContext,\n    children: jsx(DescriptionContext.Provider, {\n      value: descriptionContext,\n      children: jsx(LayoutContext.Provider, {\n        value: layoutContext,\n        children: jsx(EventContext.Provider, {\n          value: eventContext,\n          children: jsxs(\"div\", {\n            class: classnames('bio-properties-panel', layout.open ? 'open' : ''),\n            children: [jsx(Header, {\n              element: element,\n              headerProvider: headerProvider\n            }), jsx(\"div\", {\n              class: \"bio-properties-panel-scroll-container\",\n              children: groups.map(group => {\n                const {\n                  component: Component = Group,\n                  id\n                } = group;\n                return createElement(Component, { ...group,\n                  key: id,\n                  element: element\n                });\n              })\n            })]\n          })\n        })\n      })\n    })\n  });\n} // helpers //////////////////\n\nfunction createLayout(overrides) {\n  return { ...DEFAULT_LAYOUT,\n    ...overrides\n  };\n}\n\nfunction createDescriptionContext(overrides) {\n  return { ...DEFAULT_DESCRIPTION,\n    ...overrides\n  };\n}\n\nfunction DropdownButton(props) {\n  const {\n    class: className,\n    children,\n    menuItems = []\n  } = props;\n  const dropdownRef = useRef(null);\n  const menuRef = useRef(null);\n  const [open, setOpen] = useState(false);\n\n  const close = () => setOpen(false);\n\n  function onDropdownToggle(event) {\n    if (menuRef.current && menuRef.current.contains(event.target)) {\n      return;\n    }\n\n    event.stopPropagation();\n    setOpen(open => !open);\n  }\n\n  function onActionClick(event, action) {\n    event.stopPropagation();\n    close();\n    action();\n  }\n\n  useGlobalClick([dropdownRef.current], () => close());\n  return jsxs(\"div\", {\n    class: classnames('bio-properties-panel-dropdown-button', {\n      open\n    }, className),\n    onClick: onDropdownToggle,\n    ref: dropdownRef,\n    children: [children, jsx(\"div\", {\n      class: \"bio-properties-panel-dropdown-button__menu\",\n      ref: menuRef,\n      children: menuItems.map((item, index) => jsx(MenuItem, {\n        onClick: onActionClick,\n        item: item\n      }, index))\n    })]\n  });\n}\n\nfunction MenuItem({\n  item,\n  onClick\n}) {\n  if (item.separator) {\n    return jsx(\"div\", {\n      class: \"bio-properties-panel-dropdown-button__menu-item bio-properties-panel-dropdown-button__menu-item--separator\"\n    });\n  }\n\n  if (item.action) {\n    return jsx(\"button\", {\n      class: \"bio-properties-panel-dropdown-button__menu-item bio-properties-panel-dropdown-button__menu-item--actionable\",\n      onClick: event => onClick(event, item.action),\n      children: item.entry\n    });\n  }\n\n  return jsx(\"div\", {\n    class: \"bio-properties-panel-dropdown-button__menu-item\",\n    children: item.entry\n  });\n}\n/**\n *\n * @param {Array<null | Element>} ignoredElements\n * @param {Function} callback\n */\n\n\nfunction useGlobalClick(ignoredElements, callback) {\n  useEffect(() => {\n    /**\n     * @param {MouseEvent} event\n     */\n    function listener(event) {\n      if (ignoredElements.some(element => element && element.contains(event.target))) {\n        return;\n      }\n\n      callback();\n    }\n\n    document.addEventListener('click', listener, {\n      capture: true\n    });\n    return () => document.removeEventListener('click', listener, {\n      capture: true\n    });\n  }, [...ignoredElements, callback]);\n}\n\nfunction HeaderButton(props) {\n  const {\n    children = null,\n    class: classname,\n    onClick = () => {},\n    ...otherProps\n  } = props;\n  return jsx(\"button\", { ...otherProps,\n    onClick: onClick,\n    class: classnames('bio-properties-panel-group-header-button', classname),\n    children: children\n  });\n}\n\nfunction CollapsibleEntry(props) {\n  const {\n    element,\n    entries = [],\n    id,\n    label,\n    open: shouldOpen,\n    remove\n  } = props;\n  const [open, setOpen] = useState(shouldOpen);\n\n  const toggleOpen = () => setOpen(!open);\n\n  const {\n    onShow\n  } = useContext(LayoutContext);\n  const propertiesPanelContext = { ...useContext(LayoutContext),\n    onShow: useCallback(() => {\n      setOpen(true);\n\n      if (isFunction(onShow)) {\n        onShow();\n      }\n    }, [onShow, setOpen])\n  }; // todo(pinussilvestrus): translate once we have a translate mechanism for the core\n\n  const placeholderLabel = '<empty>';\n  return jsxs(\"div\", {\n    \"data-entry-id\": id,\n    class: classnames('bio-properties-panel-collapsible-entry', open ? 'open' : ''),\n    children: [jsxs(\"div\", {\n      class: \"bio-properties-panel-collapsible-entry-header\",\n      onClick: toggleOpen,\n      children: [jsx(\"div\", {\n        title: label || placeholderLabel,\n        class: classnames('bio-properties-panel-collapsible-entry-header-title', !label && 'empty'),\n        children: label || placeholderLabel\n      }), jsx(\"button\", {\n        title: \"Toggle list item\",\n        class: \"bio-properties-panel-arrow  bio-properties-panel-collapsible-entry-arrow\",\n        children: jsx(ArrowIcon, {\n          class: open ? 'bio-properties-panel-arrow-down' : 'bio-properties-panel-arrow-right'\n        })\n      }), remove ? jsx(\"button\", {\n        title: \"Delete item\",\n        class: \"bio-properties-panel-remove-entry\",\n        onClick: remove,\n        children: jsx(DeleteIcon, {})\n      }) : null]\n    }), jsx(\"div\", {\n      class: classnames('bio-properties-panel-collapsible-entry-entries', open ? 'open' : ''),\n      children: jsx(LayoutContext.Provider, {\n        value: propertiesPanelContext,\n        children: entries.map(entry => {\n          const {\n            component: Component,\n            id\n          } = entry;\n          return createElement(Component, { ...entry,\n            element: element,\n            key: id\n          });\n        })\n      })\n    })]\n  });\n}\n\nfunction ListItem(props) {\n  const {\n    autoFocusEntry,\n    autoOpen\n  } = props; // focus specified entry on auto open\n\n  useEffect(() => {\n    if (autoOpen && autoFocusEntry) {\n      const entry = query(`[data-entry-id=\"${autoFocusEntry}\"]`);\n      const focusableInput = query('.bio-properties-panel-input', entry);\n\n      if (focusableInput) {\n        if (isFunction(focusableInput.select)) {\n          focusableInput.select();\n        } else if (isFunction(focusableInput.focus)) {\n          focusableInput.focus();\n        }\n      }\n    }\n  }, [autoOpen, autoFocusEntry]);\n  return jsx(\"div\", {\n    class: \"bio-properties-panel-list-item\",\n    children: jsx(CollapsibleEntry, { ...props,\n      open: autoOpen\n    })\n  });\n}\n\nconst noop$3 = () => {};\n/**\n * @param {import('../PropertiesPanel').ListGroupDefinition} props\n */\n\n\nfunction ListGroup(props) {\n  const {\n    add,\n    element,\n    id,\n    items,\n    label,\n    shouldOpen = true,\n    shouldSort = true\n  } = props;\n  const groupRef = useRef(null);\n  const [open, setOpen] = useLayoutState(['groups', id, 'open'], false);\n  const [sticky, setSticky] = useState(false);\n  const onShow = useCallback(() => setOpen(true), [setOpen]);\n  const [ordering, setOrdering] = useState([]);\n  const [newItemAdded, setNewItemAdded] = useState(false);\n  const prevItems = usePrevious(items);\n  const prevElement = usePrevious(element);\n  const elementChanged = element !== prevElement;\n  const shouldHandleEffects = !elementChanged && (shouldSort || shouldOpen); // reset initial ordering when element changes (before first render)\n\n  if (elementChanged) {\n    setOrdering(createOrdering(shouldSort ? sortItems(items) : items));\n  } // keep ordering in sync to items - and open changes\n  // (0) set initial ordering from given items\n\n\n  useEffect(() => {\n    if (!prevItems || !shouldSort) {\n      setOrdering(createOrdering(items));\n    }\n  }, [items, element]); // (1) items were added\n\n  useEffect(() => {\n    if (shouldHandleEffects && prevItems && items.length > prevItems.length) {\n      let add = [];\n      items.forEach(item => {\n        if (!ordering.includes(item.id)) {\n          add.push(item.id);\n        }\n      });\n      let newOrdering = ordering; // open if not open and configured\n\n      if (!open && shouldOpen) {\n        toggleOpen(); // if I opened and I should sort, then sort items\n\n        if (shouldSort) {\n          newOrdering = createOrdering(sortItems(items));\n        }\n      } // add new items on top or bottom depending on sorting behavior\n\n\n      newOrdering = newOrdering.filter(item => !add.includes(item));\n\n      if (shouldSort) {\n        newOrdering.unshift(...add);\n      } else {\n        newOrdering.push(...add);\n      }\n\n      setOrdering(newOrdering);\n      setNewItemAdded(true);\n    } else {\n      setNewItemAdded(false);\n    }\n  }, [items, open, shouldHandleEffects]); // (2) sort items on open if shouldSort is set\n\n  useEffect(() => {\n    if (shouldSort && open && !newItemAdded) {\n      setOrdering(createOrdering(sortItems(items)));\n    }\n  }, [open, shouldSort]); // (3) items were deleted\n\n  useEffect(() => {\n    if (shouldHandleEffects && prevItems && items.length < prevItems.length) {\n      let keep = [];\n      ordering.forEach(o => {\n        if (getItem(items, o)) {\n          keep.push(o);\n        }\n      });\n      setOrdering(keep);\n    }\n  }, [items, shouldHandleEffects]); // set css class when group is sticky to top\n\n  useStickyIntersectionObserver(groupRef, 'div.bio-properties-panel-scroll-container', setSticky);\n\n  const toggleOpen = () => setOpen(!open);\n\n  const hasItems = !!items.length;\n  const propertiesPanelContext = { ...useContext(LayoutContext),\n    onShow\n  };\n  return jsxs(\"div\", {\n    class: \"bio-properties-panel-group\",\n    \"data-group-id\": 'group-' + id,\n    ref: groupRef,\n    children: [jsxs(\"div\", {\n      class: classnames('bio-properties-panel-group-header', hasItems ? '' : 'empty', hasItems && open ? 'open' : '', sticky && open ? 'sticky' : ''),\n      onClick: hasItems ? toggleOpen : noop$3,\n      children: [jsx(\"div\", {\n        title: label,\n        class: \"bio-properties-panel-group-header-title\",\n        children: label\n      }), jsxs(\"div\", {\n        class: \"bio-properties-panel-group-header-buttons\",\n        children: [add ? jsxs(\"button\", {\n          title: \"Create new list item\",\n          class: \"bio-properties-panel-group-header-button bio-properties-panel-add-entry\",\n          onClick: add,\n          children: [jsx(CreateIcon, {}), !hasItems ? jsx(\"span\", {\n            class: \"bio-properties-panel-add-entry-label\",\n            children: \"Create\"\n          }) : null]\n        }) : null, hasItems ? jsx(\"div\", {\n          title: `List contains ${items.length} item${items.length != 1 ? 's' : ''}`,\n          class: \"bio-properties-panel-list-badge\",\n          children: items.length\n        }) : null, hasItems ? jsx(\"button\", {\n          title: \"Toggle section\",\n          class: \"bio-properties-panel-group-header-button bio-properties-panel-arrow\",\n          children: jsx(ArrowIcon, {\n            class: open ? 'bio-properties-panel-arrow-down' : 'bio-properties-panel-arrow-right'\n          })\n        }) : null]\n      })]\n    }), jsx(\"div\", {\n      class: classnames('bio-properties-panel-list', open && hasItems ? 'open' : ''),\n      children: jsx(LayoutContext.Provider, {\n        value: propertiesPanelContext,\n        children: ordering.map((o, index) => {\n          const item = getItem(items, o);\n\n          if (!item) {\n            return;\n          }\n\n          const {\n            id\n          } = item; // if item was added, open first or last item based on ordering\n\n          const autoOpen = newItemAdded && (shouldSort ? index === 0 : index === ordering.length - 1);\n          return createElement(ListItem, { ...item,\n            autoOpen: autoOpen,\n            element: element,\n            index: index,\n            key: id\n          });\n        })\n      })\n    })]\n  });\n} // helpers ////////////////////\n\n/**\n * Sorts given items alphanumeric by label\n */\n\nfunction sortItems(items) {\n  return sortBy(items, i => i.label.toLowerCase());\n}\n\nfunction getItem(items, id) {\n  return find(items, i => i.id === id);\n}\n\nfunction createOrdering(items) {\n  return items.map(i => i.id);\n}\n\nfunction Description(props) {\n  const {\n    element,\n    forId,\n    value\n  } = props;\n  const contextDescription = useDescriptionContext(forId, element);\n  const description = value || contextDescription;\n\n  if (description) {\n    return jsx(\"div\", {\n      class: \"bio-properties-panel-description\",\n      children: description\n    });\n  }\n}\n\nconst noop$2 = () => {};\n\nfunction Checkbox(props) {\n  const {\n    id,\n    label,\n    onChange,\n    disabled,\n    value = false,\n    show = noop$2\n  } = props;\n\n  const handleChange = ({\n    target\n  }) => {\n    onChange(target.checked);\n  };\n\n  const ref = useShowEntryEvent(show);\n  return jsxs(\"div\", {\n    class: \"bio-properties-panel-checkbox\",\n    children: [jsx(\"input\", {\n      ref: ref,\n      id: prefixId$6(id),\n      name: id,\n      type: \"checkbox\",\n      class: \"bio-properties-panel-input\",\n      onChange: handleChange,\n      checked: value,\n      disabled: disabled\n    }), jsx(\"label\", {\n      for: prefixId$6(id),\n      class: \"bio-properties-panel-label\",\n      children: label\n    })]\n  });\n}\n/**\n * @param {Object} props\n * @param {Object} props.element\n * @param {String} props.id\n * @param {String} props.description\n * @param {String} props.label\n * @param {Function} props.getValue\n * @param {Function} props.setValue\n * @param {boolean} [props.disabled]\n */\n\n\nfunction CheckboxEntry(props) {\n  const {\n    element,\n    id,\n    description,\n    label,\n    getValue,\n    setValue,\n    disabled,\n    show = noop$2\n  } = props;\n  const value = getValue(element);\n  const error = useShowErrorEvent(show);\n  return jsxs(\"div\", {\n    class: \"bio-properties-panel-entry bio-properties-panel-checkbox-entry\",\n    \"data-entry-id\": id,\n    children: [jsx(Checkbox, {\n      disabled: disabled,\n      id: id,\n      label: label,\n      onChange: setValue,\n      show: show,\n      value: value\n    }), error && jsx(\"div\", {\n      class: \"bio-properties-panel-error\",\n      children: error\n    }), jsx(Description, {\n      forId: id,\n      element: element,\n      value: description\n    })]\n  });\n}\nfunction isEdited$6(node) {\n  return node && !!node.checked;\n} // helpers /////////////////\n\nfunction prefixId$6(id) {\n  return `bio-properties-panel-${id}`;\n}\n\nfunction List(props) {\n  const {\n    id,\n    element,\n    items = [],\n    component,\n    label = '<empty>',\n    open: shouldOpen,\n    onAdd,\n    onRemove,\n    autoFocusEntry,\n    compareFn\n  } = props;\n  const [open, setOpen] = useState(!!shouldOpen);\n  const hasItems = !!items.length;\n\n  const toggleOpen = () => hasItems && setOpen(!open);\n\n  const opening = !usePrevious(open) && open;\n  const elementChanged = usePrevious(element) !== element;\n  const shouldReset = opening || elementChanged;\n  const sortedItems = useSortedItems(items, compareFn, shouldReset);\n  const newItems = useNewItems(items, elementChanged);\n  useEffect(() => {\n    if (open && !hasItems) {\n      setOpen(false);\n    }\n  }, [open, hasItems]);\n  /**\n   * @param {MouseEvent} event\n   */\n\n  function addItem(event) {\n    event.stopPropagation();\n    onAdd();\n\n    if (!open) {\n      setOpen(true);\n    }\n  }\n\n  return jsxs(\"div\", {\n    \"data-entry-id\": id,\n    class: classnames('bio-properties-panel-entry', 'bio-properties-panel-list-entry', hasItems ? '' : 'empty', open ? 'open' : ''),\n    children: [jsxs(\"div\", {\n      class: \"bio-properties-panel-list-entry-header\",\n      onClick: toggleOpen,\n      children: [jsx(\"div\", {\n        title: label,\n        class: classnames('bio-properties-panel-list-entry-header-title', open && 'open'),\n        children: label\n      }), jsxs(\"div\", {\n        class: \"bio-properties-panel-list-entry-header-buttons\",\n        children: [jsxs(\"button\", {\n          title: \"Create new list item\",\n          onClick: addItem,\n          class: \"bio-properties-panel-add-entry\",\n          children: [jsx(CreateIcon, {}), !hasItems ? jsx(\"span\", {\n            class: \"bio-properties-panel-add-entry-label\",\n            children: \"Create\"\n          }) : null]\n        }), hasItems && jsx(\"div\", {\n          title: `List contains ${items.length} item${items.length != 1 ? 's' : ''}`,\n          class: \"bio-properties-panel-list-badge\",\n          children: items.length\n        }), hasItems && jsx(\"button\", {\n          title: \"Toggle list item\",\n          class: \"bio-properties-panel-arrow\",\n          children: jsx(ArrowIcon, {\n            class: open ? 'bio-properties-panel-arrow-down' : 'bio-properties-panel-arrow-right'\n          })\n        })]\n      })]\n    }), hasItems && jsx(ItemsList, {\n      autoFocusEntry: autoFocusEntry,\n      component: component,\n      element: element,\n      id: id,\n      items: sortedItems,\n      newItems: newItems,\n      onRemove: onRemove,\n      open: open\n    })]\n  });\n}\n\nfunction ItemsList(props) {\n  const {\n    autoFocusEntry,\n    component: Component,\n    element,\n    id,\n    items,\n    newItems,\n    onRemove,\n    open\n  } = props;\n  const getKey = useKeyFactory();\n  const newItem = newItems[0];\n  useEffect(() => {\n    if (newItem && autoFocusEntry) {\n      // (0) select the parent entry (containing all list items)\n      const entry = query(`[data-entry-id=\"${id}\"]`); // (1) select the first input or a custom element to be focussed\n\n      const selector = typeof autoFocusEntry === 'boolean' ? '.bio-properties-panel-input' : autoFocusEntry;\n      const focusableInput = query(selector, entry); // (2) set focus\n\n      if (focusableInput) {\n        if (isFunction(focusableInput.select)) {\n          focusableInput.select();\n        } else if (isFunction(focusableInput.focus)) {\n          focusableInput.focus();\n        }\n      }\n    }\n  }, [newItem, autoFocusEntry, id]);\n  return jsx(\"ol\", {\n    class: classnames('bio-properties-panel-list-entry-items', open ? 'open' : ''),\n    children: items.map((item, index) => {\n      const key = getKey(item);\n      return jsxs(\"li\", {\n        class: \"bio-properties-panel-list-entry-item\",\n        children: [jsx(Component, {\n          element: element,\n          id: id,\n          index: index,\n          item: item,\n          open: item === newItem\n        }), onRemove && jsx(\"button\", {\n          type: \"button\",\n          title: \"Delete item\",\n          class: \"bio-properties-panel-remove-entry bio-properties-panel-remove-list-entry\",\n          onClick: () => onRemove && onRemove(item),\n          children: jsx(DeleteIcon, {})\n        })]\n      }, key);\n    })\n  });\n}\n/**\n * Place new items in the beginning of the list and sort the rest with provided function.\n *\n * @template Item\n * @param {Item[]} currentItems\n * @param {(a: Item, b: Item) => 0 | 1 | -1} [compareFn] function used to sort items\n * @param {boolean} [shouldReset=false] set to `true` to reset state of the hook\n * @returns {Item[]}\n */\n\n\nfunction useSortedItems(currentItems, compareFn, shouldReset = false) {\n  const itemsRef = useRef(currentItems.slice()); // (1) Reset and optionally sort.\n\n  if (shouldReset) {\n    itemsRef.current = currentItems.slice();\n\n    if (compareFn) {\n      itemsRef.current.sort(compareFn);\n    }\n  } else {\n    const items = itemsRef.current; // (2) Add new item to the list.\n\n    for (const item of currentItems) {\n      if (!items.includes(item)) {\n        // Unshift or push depending on whether we have a compareFn\n        compareFn ? items.unshift(item) : items.push(item);\n      }\n    } // (3) Filter out removed items.\n\n\n    itemsRef.current = items.filter(item => currentItems.includes(item));\n  }\n\n  return itemsRef.current;\n}\n\nfunction useNewItems(items = [], shouldReset) {\n  const previousItems = usePrevious(items.slice()) || [];\n\n  if (shouldReset) {\n    return [];\n  }\n\n  return previousItems ? items.filter(item => !previousItems.includes(item)) : [];\n}\n\nfunction NumberField(props) {\n  const {\n    debounce,\n    disabled,\n    id,\n    label,\n    max,\n    min,\n    onInput,\n    step,\n    value = ''\n  } = props;\n  const handleInput = useMemo(() => {\n    return debounce(event => {\n      const {\n        validity,\n        value\n      } = event.target;\n\n      if (validity.valid) {\n        onInput(value ? parseFloat(value) : undefined);\n      }\n    });\n  }, [onInput, debounce]);\n  return jsxs(\"div\", {\n    class: \"bio-properties-panel-numberfield\",\n    children: [jsx(\"label\", {\n      for: prefixId$5(id),\n      class: \"bio-properties-panel-label\",\n      children: label\n    }), jsx(\"input\", {\n      id: prefixId$5(id),\n      type: \"number\",\n      name: id,\n      spellCheck: \"false\",\n      autoComplete: \"off\",\n      disabled: disabled,\n      class: \"bio-properties-panel-input\",\n      max: max,\n      min: min,\n      onInput: handleInput,\n      step: step,\n      value: value\n    })]\n  });\n}\n/**\n * @param {Object} props\n * @param {Boolean} props.debounce\n * @param {String} props.description\n * @param {Boolean} props.disabled\n * @param {Object} props.element\n * @param {Function} props.getValue\n * @param {String} props.id\n * @param {String} props.label\n * @param {String} props.max\n * @param {String} props.min\n * @param {Function} props.setValue\n * @param {String} props.step\n */\n\n\nfunction NumberFieldEntry(props) {\n  const {\n    debounce,\n    description,\n    disabled,\n    element,\n    getValue,\n    id,\n    label,\n    max,\n    min,\n    setValue,\n    step\n  } = props;\n  const value = getValue(element);\n  return jsxs(\"div\", {\n    class: \"bio-properties-panel-entry\",\n    \"data-entry-id\": id,\n    children: [jsx(NumberField, {\n      debounce: debounce,\n      disabled: disabled,\n      id: id,\n      label: label,\n      onInput: setValue,\n      max: max,\n      min: min,\n      step: step,\n      value: value\n    }), jsx(Description, {\n      forId: id,\n      element: element,\n      value: description\n    })]\n  });\n}\nfunction isEdited$5(node) {\n  return node && !!node.value;\n} // helpers /////////////////\n\nfunction prefixId$5(id) {\n  return `bio-properties-panel-${id}`;\n}\n\nconst noop$1 = () => {};\n/**\n * @typedef { { value: string, label: string, disabled: boolean } } Option\n */\n\n/**\n * Provides basic select input.\n *\n * @param {object} props\n * @param {string} props.id\n * @param {string[]} props.path\n * @param {string} props.label\n * @param {Function} props.onChange\n * @param {Array<Option>} [props.options]\n * @param {string} props.value\n * @param {boolean} [props.disabled]\n */\n\n\nfunction Select(props) {\n  const {\n    id,\n    label,\n    onChange,\n    options = [],\n    value,\n    disabled,\n    show = noop$1\n  } = props;\n  const ref = useShowEntryEvent(show);\n\n  const handleChange = ({\n    target\n  }) => {\n    onChange(target.value);\n  };\n\n  return jsxs(\"div\", {\n    class: \"bio-properties-panel-select\",\n    children: [jsx(\"label\", {\n      for: prefixId$4(id),\n      class: \"bio-properties-panel-label\",\n      children: label\n    }), jsx(\"select\", {\n      ref: ref,\n      id: prefixId$4(id),\n      name: id,\n      class: \"bio-properties-panel-input\",\n      onInput: handleChange,\n      value: value,\n      disabled: disabled,\n      children: options.map((option, idx) => {\n        return jsx(\"option\", {\n          value: option.value,\n          disabled: option.disabled,\n          children: option.label\n        }, idx);\n      })\n    })]\n  });\n}\n/**\n * @param {object} props\n * @param {object} props.element\n * @param {string} props.id\n * @param {string} [props.description]\n * @param {string} props.label\n * @param {Function} props.getValue\n * @param {Function} props.setValue\n * @param {Function} props.getOptions\n * @param {boolean} [props.disabled]\n */\n\n\nfunction SelectEntry(props) {\n  const {\n    element,\n    id,\n    description,\n    label,\n    getValue,\n    setValue,\n    getOptions,\n    disabled,\n    show = noop$1\n  } = props;\n  const value = getValue(element);\n  const options = getOptions(element);\n  const error = useShowErrorEvent(show);\n  return jsxs(\"div\", {\n    class: classnames('bio-properties-panel-entry', error ? 'has-error' : ''),\n    \"data-entry-id\": id,\n    children: [jsx(Select, {\n      id: id,\n      label: label,\n      value: value,\n      onChange: setValue,\n      options: options,\n      disabled: disabled,\n      show: show\n    }), error && jsx(\"div\", {\n      class: \"bio-properties-panel-error\",\n      children: error\n    }), jsx(Description, {\n      forId: id,\n      element: element,\n      value: description\n    })]\n  });\n}\nfunction isEdited$4(node) {\n  return node && !!node.value;\n} // helpers /////////////////\n\nfunction prefixId$4(id) {\n  return `bio-properties-panel-${id}`;\n}\n\nfunction Simple(props) {\n  const {\n    debounce,\n    disabled,\n    element,\n    getValue,\n    id,\n    onBlur,\n    onFocus,\n    setValue\n  } = props;\n  const handleInput = useMemo(() => {\n    return debounce(({\n      target\n    }) => setValue(target.value.length ? target.value : undefined));\n  }, [setValue, debounce]);\n  const value = getValue(element);\n  return jsx(\"div\", {\n    class: \"bio-properties-panel-simple\",\n    children: jsx(\"input\", {\n      id: prefixId$3(id),\n      type: \"text\",\n      name: id,\n      spellCheck: \"false\",\n      autoComplete: \"off\",\n      disabled: disabled,\n      class: \"bio-properties-panel-input\",\n      onInput: handleInput,\n      \"aria-label\": value || '<empty>',\n      onFocus: onFocus,\n      onBlur: onBlur,\n      value: value || ''\n    })\n  });\n}\nfunction isEdited$3(node) {\n  return node && !!node.value;\n} // helpers /////////////////\n\nfunction prefixId$3(id) {\n  return `bio-properties-panel-${id}`;\n}\n\nfunction FeelIcon(props) {\n  const {\n    label,\n    feel = false\n  } = props;\n  const feelRequiredLabel = ' must be a FEEL expression';\n  const feelOptionalLabel = ' can optionally be a FEEL expression';\n  return jsx(\"i\", {\n    class: \"bio-properties-panel-feel-icon\",\n    title: label + (feel === 'required' ? feelRequiredLabel : feelOptionalLabel),\n    children: feel === 'required' ? jsx(FeelRequiredIcon, {}) : jsx(FeelOptionalIcon, {})\n  });\n}\n\nfunction TextArea(props) {\n  const {\n    id,\n    label,\n    rows = 2,\n    debounce,\n    feel,\n    onInput,\n    value = '',\n    disabled,\n    monospace\n  } = props;\n  const handleInput = useMemo(() => {\n    return debounce(({\n      target\n    }) => onInput(target.value.length ? target.value : undefined));\n  }, [onInput, debounce]);\n  return jsxs(\"div\", {\n    class: \"bio-properties-panel-textarea\",\n    children: [jsxs(\"label\", {\n      for: prefixId$2(id),\n      class: \"bio-properties-panel-label\",\n      children: [label, feel && jsx(FeelIcon, {\n        feel: feel,\n        label: label\n      })]\n    }), jsx(\"textarea\", {\n      id: prefixId$2(id),\n      name: id,\n      spellCheck: \"false\",\n      class: classnames('bio-properties-panel-input', monospace ? 'bio-properties-panel-input-monospace' : ''),\n      onInput: handleInput,\n      onFocus: props.onFocus,\n      onBlur: props.onBlur,\n      rows: rows,\n      value: value,\n      disabled: disabled\n    })]\n  });\n}\n/**\n * @param {object} props\n * @param {object} props.element\n * @param {string} props.id\n * @param {string} props.description\n * @param {boolean} props.debounce\n * @param {string} props.label\n * @param {Function} props.getValue\n * @param {Function} props.setValue\n * @param {number} props.rows\n * @param {boolean} props.monospace\n * @param {boolean} [props.disabled]\n */\n\n\nfunction TextAreaEntry(props) {\n  const {\n    element,\n    id,\n    description,\n    debounce,\n    feel,\n    label,\n    getValue,\n    setValue,\n    rows,\n    monospace,\n    disabled\n  } = props;\n  const value = getValue(element);\n  return jsxs(\"div\", {\n    class: \"bio-properties-panel-entry\",\n    \"data-entry-id\": id,\n    children: [jsx(TextArea, {\n      id: id,\n      label: label,\n      value: value,\n      onInput: setValue,\n      rows: rows,\n      debounce: debounce,\n      monospace: monospace,\n      feel: feel,\n      disabled: disabled\n    }), jsx(Description, {\n      forId: id,\n      element: element,\n      value: description\n    })]\n  });\n}\nfunction isEdited$2(node) {\n  return node && !!node.value;\n} // helpers /////////////////\n\nfunction prefixId$2(id) {\n  return `bio-properties-panel-${id}`;\n}\n\nconst noop = () => {};\n\nfunction Textfield(props) {\n  const {\n    debounce,\n    disabled = false,\n    id,\n    label,\n    onInput,\n    feel = false,\n    value = '',\n    show = noop\n  } = props;\n  const ref = useShowEntryEvent(show);\n  const handleInput = useMemo(() => {\n    return debounce(({\n      target\n    }) => onInput(target.value.length ? target.value : undefined));\n  }, [onInput, debounce]);\n  return jsxs(\"div\", {\n    class: \"bio-properties-panel-textfield\",\n    children: [jsxs(\"label\", {\n      for: prefixId$1(id),\n      class: \"bio-properties-panel-label\",\n      children: [label, feel && jsx(FeelIcon, {\n        feel: feel,\n        label: label\n      })]\n    }), jsx(\"input\", {\n      ref: ref,\n      id: prefixId$1(id),\n      type: \"text\",\n      name: id,\n      spellCheck: \"false\",\n      autoComplete: \"off\",\n      disabled: disabled,\n      class: \"bio-properties-panel-input\",\n      onInput: handleInput,\n      onFocus: props.onFocus,\n      onBlur: props.onBlur,\n      value: value || ''\n    })]\n  });\n}\n/**\n * @param {Object} props\n * @param {Object} props.element\n * @param {String} props.id\n * @param {String} props.description\n * @param {Boolean} props.debounce\n * @param {Boolean} props.disabled\n * @param {String} props.label\n * @param {Function} props.getValue\n * @param {Function} props.setValue\n * @param {Function} props.validate\n */\n\n\nfunction TextfieldEntry(props) {\n  const {\n    element,\n    id,\n    description,\n    debounce,\n    disabled,\n    feel,\n    label,\n    getValue,\n    setValue,\n    validate,\n    show = noop\n  } = props;\n  const [cachedInvalidValue, setCachedInvalidValue] = useState(null);\n  const [validationError, setValidationError] = useState(null);\n  let value = getValue(element);\n  const previousValue = usePrevious(value);\n  useEffect(() => {\n    if (isFunction(validate)) {\n      const newValidationError = validate(value) || null;\n      setValidationError(newValidationError);\n    }\n  }, [value]);\n\n  const onInput = newValue => {\n    let newValidationError = null;\n\n    if (isFunction(validate)) {\n      newValidationError = validate(newValue) || null;\n    }\n\n    if (newValidationError) {\n      setCachedInvalidValue(newValue);\n    } else {\n      setValue(newValue);\n    }\n\n    setValidationError(newValidationError);\n  };\n\n  if (previousValue === value && validationError) {\n    value = cachedInvalidValue;\n  }\n\n  const temporaryError = useShowErrorEvent(show);\n  const error = temporaryError || validationError;\n  return jsxs(\"div\", {\n    class: classnames('bio-properties-panel-entry', error ? 'has-error' : ''),\n    \"data-entry-id\": id,\n    children: [jsx(Textfield, {\n      debounce: debounce,\n      disabled: disabled,\n      feel: feel,\n      id: id,\n      label: label,\n      onInput: onInput,\n      show: show,\n      value: value\n    }), error && jsx(\"div\", {\n      class: \"bio-properties-panel-error\",\n      children: error\n    }), jsx(Description, {\n      forId: id,\n      element: element,\n      value: description\n    })]\n  });\n}\nfunction isEdited$1(node) {\n  return node && !!node.value;\n} // helpers /////////////////\n\nfunction prefixId$1(id) {\n  return `bio-properties-panel-${id}`;\n}\n\nfunction ToggleSwitch(props) {\n  const {\n    id,\n    label,\n    onInput,\n    value,\n    switcherLabel\n  } = props;\n\n  const handleInput = async () => {\n    onInput(!value);\n  };\n\n  return jsxs(\"div\", {\n    class: \"bio-properties-panel-toggle-switch\",\n    children: [jsx(\"label\", {\n      class: \"bio-properties-panel-label\",\n      for: prefixId(id),\n      children: label\n    }), jsxs(\"div\", {\n      class: \"bio-properties-panel-field-wrapper\",\n      children: [jsxs(\"label\", {\n        class: \"bio-properties-panel-toggle-switch__switcher\",\n        children: [jsx(\"input\", {\n          id: prefixId(id),\n          class: \"bio-properties-panel-input\",\n          type: \"checkbox\",\n          name: id,\n          onInput: handleInput,\n          checked: value\n        }), jsx(\"span\", {\n          class: \"bio-properties-panel-toggle-switch__slider\"\n        })]\n      }), jsx(\"p\", {\n        class: \"bio-properties-panel-toggle-switch__label\",\n        children: switcherLabel\n      })]\n    })]\n  });\n}\n/**\n * @param {Object} props\n * @param {Object} props.element\n * @param {String} props.id\n * @param {String} props.description\n * @param {String} props.label\n * @param {String} props.switcherLabel\n * @param {Function} props.getValue\n * @param {Function} props.setValue\n */\n\n\nfunction ToggleSwitchEntry(props) {\n  const {\n    element,\n    id,\n    description,\n    label,\n    switcherLabel,\n    getValue,\n    setValue\n  } = props;\n  const value = getValue(element);\n  return jsxs(\"div\", {\n    class: \"bio-properties-panel-entry bio-properties-panel-toggle-switch-entry\",\n    \"data-entry-id\": id,\n    children: [jsx(ToggleSwitch, {\n      id: id,\n      label: label,\n      value: value,\n      onInput: setValue,\n      switcherLabel: switcherLabel\n    }), jsx(Description, {\n      forId: id,\n      element: element,\n      value: description\n    })]\n  });\n}\nfunction isEdited(node) {\n  return node && !!node.checked;\n} // helpers /////////////////\n\nfunction prefixId(id) {\n  return `bio-properties-panel-${id}`;\n}\n\nconst DEFAULT_DEBOUNCE_TIME = 300;\nfunction debounceInput(debounceDelay) {\n  return function _debounceInput(fn) {\n    if (debounceDelay !== false) {\n      var debounceTime = isNumber(debounceDelay) ? debounceDelay : DEFAULT_DEBOUNCE_TIME;\n      return debounce(fn, debounceTime);\n    } else {\n      return fn;\n    }\n  };\n}\ndebounceInput.$inject = ['config.debounceInput'];\n\nvar index = {\n  debounceInput: ['factory', debounceInput]\n};\n\nexport { ArrowIcon, CheckboxEntry, CollapsibleEntry, CreateIcon, index as DebounceInputModule, DeleteIcon, DescriptionContext, Description as DescriptionEntry, DropdownButton, EventContext, ExternalLinkIcon, FeelOptionalIcon, FeelRequiredIcon, Group, Header, HeaderButton, LayoutContext, List as ListEntry, ListGroup, ListItem, NumberFieldEntry, Placeholder, PropertiesPanel, LayoutContext as PropertiesPanelContext, SelectEntry, Simple as SimpleEntry, TextAreaEntry, TextfieldEntry as TextFieldEntry, ToggleSwitchEntry, isEdited$6 as isCheckboxEntryEdited, isEdited$5 as isNumberFieldEntryEdited, isEdited$4 as isSelectEntryEdited, isEdited$3 as isSimpleEntryEdited, isEdited$2 as isTextAreaEntryEdited, isEdited$1 as isTextFieldEntryEdited, isEdited as isToggleSwitchEntryEdited, useDescriptionContext, useEvent, useEventBuffer, useKeyFactory, useLayoutState, usePrevious, useShowEntryEvent, useShowErrorEvent, useStickyIntersectionObserver };\n//# sourceMappingURL=index.esm.js.map\n","import { createContext } from 'preact';\n\n/**\n * @param {string} type\n * @param {boolean} [strict]\n *\n * @returns {any}\n */\nfunction getService(type, strict) {}\n\nconst PropertiesPanelContext = createContext({\n  getService\n});\n\nexport default PropertiesPanelContext;","export function arrayAdd(array, index, item) {\n  const copy = [ ...array ];\n\n  copy.splice(index, 0, item);\n\n  return copy;\n}\n\nexport function arrayRemove(array, index) {\n  const copy = [ ...array ];\n\n  copy.splice(index, 1);\n\n  return copy;\n}\n\nexport function prefixId(id) {\n  return `fjs-properties-panel-${ id }`;\n}\n\nexport function stopPropagation(listener) {\n  return (event) => {\n    event.stopPropagation();\n\n    listener(event);\n  };\n}\n\nexport function textToLabel(text = '...') {\n  if (text.length > 10) {\n    return `${ text.substring(0, 30) }...`;\n  }\n\n  return text;\n}\n\nexport const INPUTS = [\n  'checkbox',\n  'checklist',\n  'number',\n  'radio',\n  'select',\n  'taglist',\n  'textfield'\n];\n\nexport const VALUES_INPUTS = [\n  'checklist',\n  'radio',\n  'select',\n  'taglist'\n];","import {\n  textToLabel\n} from './Util';\n\nimport { iconsByType } from '../../render/components/icons';\n\nconst labelsByType = {\n  button: 'BUTTON',\n  checkbox: 'CHECKBOX',\n  checklist: 'CHECKLIST',\n  columns: 'COLUMNS',\n  default: 'FORM',\n  number: 'NUMBER',\n  radio: 'RADIO',\n  select: 'SELECT',\n  taglist: 'TAGLIST',\n  text: 'TEXT',\n  textfield: 'TEXT FIELD',\n};\n\nexport const PropertiesPanelHeaderProvider = {\n\n  getElementLabel: (field) => {\n    const {\n      type\n    } = field;\n\n    if (type === 'text') {\n      return textToLabel(field.text);\n    }\n\n    if (type === 'default') {\n      return field.id;\n    }\n\n    return field.label;\n  },\n\n  getElementIcon: (field) => {\n    const {\n      type\n    } = field;\n\n    const Icon = iconsByType[type];\n\n    if (Icon) {\n      return () => <Icon width=\"36\" height=\"36\" viewBox=\"0 0 54 54\" />;\n    }\n  },\n\n  getTypeLabel: (field) => {\n    const {\n      type\n    } = field;\n\n    return labelsByType[type];\n  }\n};","/**\n * Provide placeholders for empty and multiple state.\n */\nexport const PropertiesPanelPlaceholderProvider = {\n\n  getEmpty: () => {\n    return {\n      text: 'Select a form field to edit its properties.'\n    };\n  },\n\n  getMultiple: () => {\n    return {\n      text: 'Multiple form fields are selected. Select a single form field to edit its properties.'\n    };\n  }\n};","import { get } from 'min-dash';\n\nimport { SelectEntry, isSelectEntryEdited } from '@bpmn-io/properties-panel';\n\n\nexport default function ActionEntry(props) {\n  const {\n    editField,\n    field\n  } = props;\n\n  const {\n    type\n  } = field;\n\n  const entries = [];\n\n  if (type === 'button') {\n    entries.push({\n      id: 'action',\n      component: Action,\n      editField: editField,\n      field: field,\n      isEdited: isSelectEntryEdited\n    });\n  }\n\n  return entries;\n}\n\nfunction Action(props) {\n  const {\n    editField,\n    field,\n    id\n  } = props;\n\n  const path = [ 'action' ];\n\n  const getValue = () => {\n    return get(field, path, '');\n  };\n\n  const setValue = (value) => {\n    return editField(field, path, value);\n  };\n\n  const getOptions = () => [\n    {\n      label: 'Submit',\n      value: 'submit'\n    },\n    {\n      label: 'Reset',\n      value: 'reset'\n    }\n  ];\n\n  return SelectEntry({\n    element: field,\n    getOptions,\n    getValue,\n    id,\n    label: 'Action',\n    setValue\n  });\n}","import {\n  useContext\n} from 'preact/hooks';\n\nimport { FormPropertiesPanelContext } from '../context';\n\n\nexport default function(type, strict) {\n  const {\n    getService\n  } = useContext(FormPropertiesPanelContext);\n\n  return getService(type, strict);\n}","import { Default } from '@bpmn-io/form-js-viewer';\n\nimport { useService } from '../hooks';\n\nimport { NumberFieldEntry, isNumberFieldEntryEdited } from '@bpmn-io/properties-panel';\n\n\nexport default function ColumnsEntry(props) {\n  const {\n    editField,\n    field\n  } = props;\n\n  const {\n    type\n  } = field;\n\n  const entries = [];\n\n  if (type === 'columns') {\n    entries.push({\n      id: 'columns',\n      component: Columns,\n      editField: editField,\n      field: field,\n      isEdited: isNumberFieldEntryEdited\n    });\n  }\n\n  return entries;\n}\n\nfunction Columns(props) {\n  const {\n    editField,\n    field,\n    id\n  } = props;\n\n  const debounce = useService('debounce');\n\n  const getValue = () => {\n    return field.components.length;\n  };\n\n  const setValue = (value) => {\n    let components = field.components.slice();\n\n    if (value > components.length) {\n      while (value > components.length) {\n        components.push(Default.create({ _parent: field.id }));\n      }\n    } else {\n      components = components.slice(0, value);\n    }\n\n    editField(field, 'components', components);\n  };\n\n  return NumberFieldEntry({\n    debounce,\n    element: field,\n    getValue,\n    id,\n    label: 'Columns',\n    setValue\n  });\n}","import { get } from 'min-dash';\n\nimport { useService } from '../hooks';\n\nimport { INPUTS } from '../Util';\n\nimport { TextFieldEntry, isTextFieldEntryEdited } from '@bpmn-io/properties-panel';\n\n\nexport default function DescriptionEntry(props) {\n  const {\n    editField,\n    field\n  } = props;\n\n  const {\n    type\n  } = field;\n\n  const entries = [];\n\n  if (INPUTS.includes(type)) {\n    entries.push({\n      id: 'description',\n      component: Description,\n      editField: editField,\n      field: field,\n      isEdited: isTextFieldEntryEdited\n    });\n  }\n\n  return entries;\n}\n\n\nfunction Description(props) {\n  const {\n    editField,\n    field,\n    id\n  } = props;\n\n  const debounce = useService('debounce');\n\n  const path = [ 'description' ];\n\n  const getValue = () => {\n    return get(field, path, '');\n  };\n\n  const setValue = (value) => {\n    return editField(field, path, value);\n  };\n\n  return TextFieldEntry({\n    debounce,\n    element: field,\n    getValue,\n    id,\n    label: 'Field description',\n    setValue\n  });\n}","import {\n  isNumberFieldEntryEdited,\n  isSelectEntryEdited,\n  isTextFieldEntryEdited,\n  NumberFieldEntry,\n  SelectEntry,\n  TextFieldEntry\n} from '@bpmn-io/properties-panel';\n\nimport { get } from 'min-dash';\n\nimport { useService } from '../hooks';\n\nimport { INPUTS, VALUES_INPUTS } from '../Util';\n\n\nexport default function DefaultOptionEntry(props) {\n  const {\n    editField,\n    field\n  } = props;\n\n  const {\n    type\n  } = field;\n\n  const entries = [];\n\n  // Only make default values available when they are statically defined\n  if (!INPUTS.includes(type) || VALUES_INPUTS.includes(type) && !field.values) {\n    return entries;\n  }\n\n  const defaultOptions = {\n    editField,\n    field,\n    id: 'defaultValue',\n    label: 'Default value'\n  };\n\n  if (type === 'checkbox') {\n    entries.push({\n      ...defaultOptions,\n      component: DefaultValueCheckbox,\n      isEdited: isSelectEntryEdited\n    });\n  }\n\n  if (type === 'number') {\n    entries.push({\n      ...defaultOptions,\n      component: DefaultValueNumber,\n      isEdited: isNumberFieldEntryEdited\n    });\n  }\n\n  if (type === 'radio' || type === 'select') {\n    entries.push({\n      ...defaultOptions,\n      component: DefaultValueSingleSelect,\n      isEdited: isSelectEntryEdited\n    });\n  }\n\n  // todo(Skaiir): implement a multiselect equivalent (cf. https://github.com/bpmn-io/form-js/issues/265)\n\n  if (type === 'textfield') {\n    entries.push({\n      ...defaultOptions,\n      component: DefaultValueTextfield,\n      isEdited: isTextFieldEntryEdited\n    });\n  }\n\n  return entries;\n}\n\nfunction DefaultValueCheckbox(props) {\n  const {\n    editField,\n    field,\n    id,\n    label\n  } = props;\n\n  const {\n    defaultValue\n  } = field;\n\n  const path = [ 'defaultValue' ];\n\n  const getOptions = () => {\n    return [\n      {\n        label: 'Checked',\n        value: 'true'\n      },\n      {\n        label: 'Not checked',\n        value: 'false'\n      }\n    ];\n  };\n\n  const setValue = (value) => {\n    return editField(field, path, parseStringToBoolean(value));\n  };\n\n  const getValue = () => {\n    return parseBooleanToString(defaultValue);\n  };\n\n  return SelectEntry({\n    element: field,\n    getOptions,\n    getValue,\n    id,\n    label,\n    setValue\n  });\n}\n\nfunction DefaultValueNumber(props) {\n  const {\n    editField,\n    field,\n    id,\n    label\n  } = props;\n\n  const debounce = useService('debounce');\n\n  const path = [ 'defaultValue' ];\n\n  const getValue = () => {\n    return get(field, path, '');\n  };\n\n  const setValue = (value) => {\n    return editField(field, path, value);\n  };\n\n  return NumberFieldEntry({\n    debounce,\n    element: field,\n    getValue,\n    id,\n    label,\n    setValue\n  });\n}\n\nfunction DefaultValueSingleSelect(props) {\n  const {\n    editField,\n    field,\n    id,\n    label\n  } = props;\n\n  const {\n    defaultValue,\n    values = []\n  } = field;\n\n  const path = [ 'defaultValue' ];\n\n  const getOptions = () => {\n    return [\n      {\n        label: '<none>'\n      },\n      ...values\n    ];\n  };\n\n  const setValue = (value) => {\n    return editField(field, path, value.length ? value : undefined);\n  };\n\n  const getValue = () => {\n    return defaultValue;\n  };\n\n  return SelectEntry({\n    element: field,\n    getOptions,\n    getValue,\n    id,\n    label,\n    setValue\n  });\n}\n\nfunction DefaultValueTextfield(props) {\n  const {\n    editField,\n    field,\n    id,\n    label\n  } = props;\n\n  const debounce = useService('debounce');\n\n  const path = [ 'defaultValue' ];\n\n  const getValue = () => {\n    return get(field, path, '');\n  };\n\n  const setValue = (value) => {\n    return editField(field, path, value);\n  };\n\n  return TextFieldEntry({\n    debounce,\n    element: field,\n    getValue,\n    id,\n    label,\n    setValue\n  });\n}\n\n\n// helpers /////////////////\n\nfunction parseStringToBoolean(value) {\n  if (value === 'true') {\n    return true;\n  }\n\n  return false;\n}\n\nfunction parseBooleanToString(value) {\n  if (value === true) {\n    return 'true';\n  }\n\n  return 'false';\n}","import { get } from 'min-dash';\n\nimport { INPUTS } from '../Util';\n\nimport { CheckboxEntry, isCheckboxEntryEdited } from '@bpmn-io/properties-panel';\n\n\nexport default function DisabledEntry(props) {\n  const {\n    editField,\n    field\n  } = props;\n\n  const {\n    type\n  } = field;\n\n  const entries = [];\n\n  if (INPUTS.includes(type)) {\n    entries.push({\n      id: 'disabled',\n      component: Disabled,\n      editField: editField,\n      field: field,\n      isEdited: isCheckboxEntryEdited\n    });\n  }\n\n  return entries;\n}\n\nfunction Disabled(props) {\n  const {\n    editField,\n    field,\n    id\n  } = props;\n\n  const path = [ 'disabled' ];\n\n  const getValue = () => {\n    return get(field, path, '');\n  };\n\n  const setValue = (value) => {\n    return editField(field, path, value);\n  };\n\n  return CheckboxEntry({\n    element: field,\n    getValue,\n    id,\n    label: 'Disabled',\n    setValue\n  });\n}","import { get, isUndefined } from 'min-dash';\n\nimport { useService } from '../hooks';\n\nimport { TextFieldEntry, isTextFieldEntryEdited } from '@bpmn-io/properties-panel';\n\n\nexport default function IdEntry(props) {\n  const {\n    editField,\n    field\n  } = props;\n\n  const entries = [];\n\n  if (field.type === 'default') {\n    entries.push({\n      id: 'id',\n      component: Id,\n      editField: editField,\n      field: field,\n      isEdited: isTextFieldEntryEdited\n    });\n  }\n\n  return entries;\n}\n\nfunction Id(props) {\n  const {\n    editField,\n    field,\n    id\n  } = props;\n\n  const formFieldRegistry = useService('formFieldRegistry');\n  const debounce = useService('debounce');\n\n  const path = [ 'id' ];\n\n  const getValue = () => {\n    return get(field, path, '');\n  };\n\n  const setValue = (value) => {\n    return editField(field, path, value);\n  };\n\n  const validate = (value) => {\n    if (isUndefined(value) || !value.length) {\n      return 'Must not be empty.';\n    }\n\n    const assigned = formFieldRegistry._ids.assigned(value);\n\n    if (assigned && assigned !== field) {\n      return 'Must be unique.';\n    }\n\n    return validateId(value) || null;\n  };\n\n  return TextFieldEntry({\n    debounce,\n    element: field,\n    getValue,\n    id,\n    label: 'ID',\n    setValue,\n    validate,\n  });\n}\n\n// id structural validation /////////////\n\nconst SPACE_REGEX = /\\s/;\n\n// for QName validation as per http://www.w3.org/TR/REC-xml/#NT-NameChar\nconst QNAME_REGEX = /^([a-z][\\w-.]*:)?[a-z_][\\w-.]*$/i;\n\n// for ID validation as per BPMN Schema (QName - Namespace)\nconst ID_REGEX = /^[a-z_][\\w-.]*$/i;\n\nfunction validateId(idValue) {\n\n  if (containsSpace(idValue)) {\n    return 'Must not contain spaces.';\n  }\n\n  if (!ID_REGEX.test(idValue)) {\n\n    if (QNAME_REGEX.test(idValue)) {\n      return 'Must not contain prefix.';\n    }\n\n    return 'Must be a valid QName.';\n  }\n}\n\nfunction containsSpace(value) {\n  return SPACE_REGEX.test(value);\n}","import { isUndefined } from 'min-dash';\n\nimport { get } from 'min-dash';\n\nimport { INPUTS } from '../Util';\n\nimport { useService } from '../hooks';\n\nimport { TextFieldEntry, isTextFieldEntryEdited } from '@bpmn-io/properties-panel';\n\n\nexport default function KeyEntry(props) {\n  const {\n    editField,\n    field\n  } = props;\n\n  const {\n    type\n  } = field;\n\n  const entries = [];\n\n  if (INPUTS.includes(type)) {\n    entries.push({\n      id: 'key',\n      component: Key,\n      editField: editField,\n      field: field,\n      isEdited: isTextFieldEntryEdited\n    });\n  }\n\n  return entries;\n}\n\nfunction Key(props) {\n  const {\n    editField,\n    field,\n    id\n  } = props;\n\n  const formFieldRegistry = useService('formFieldRegistry');\n\n  const debounce = useService('debounce');\n\n  const path = [ 'key' ];\n\n  const getValue = () => {\n    return get(field, path, '');\n  };\n\n  const setValue = (value) => {\n    return editField(field, path, value);\n  };\n\n  const validate = (value) => {\n    if (isUndefined(value) || !value.length) {\n      return 'Must not be empty.';\n    }\n\n    if (/\\s/.test(value)) {\n      return 'Must not contain spaces.';\n    }\n\n    const assigned = formFieldRegistry._keys.assigned(value);\n\n    if (assigned && assigned !== field) {\n      return 'Must be unique.';\n    }\n\n    return null;\n  };\n\n  return TextFieldEntry({\n    debounce,\n    description: 'Binds to a form variable',\n    element: field,\n    getValue,\n    id,\n    label: 'Key',\n    setValue,\n    validate\n  });\n}","import { get } from 'min-dash';\n\nimport { INPUTS } from '../Util';\n\nimport { useService } from '../hooks';\n\n\nimport { TextFieldEntry, isTextFieldEntryEdited } from '@bpmn-io/properties-panel';\n\n\nexport default function LabelEntry(props) {\n  const {\n    editField,\n    field\n  } = props;\n\n  const {\n    type\n  } = field;\n\n  const entries = [];\n\n  if (INPUTS.includes(type) || type === 'button') {\n    entries.push({\n      id: 'label',\n      component: Label,\n      editField: editField,\n      field: field,\n      isEdited: isTextFieldEntryEdited\n    });\n  }\n\n  return entries;\n}\n\nfunction Label(props) {\n  const {\n    editField,\n    field,\n    id\n  } = props;\n\n  const debounce = useService('debounce');\n\n  const path = [ 'label' ];\n\n  const getValue = () => {\n    return get(field, path, '');\n  };\n\n  const setValue = (value) => {\n    return editField(field, path, value);\n  };\n\n  return TextFieldEntry({\n    debounce,\n    element: field,\n    getValue,\n    id,\n    label: 'Field label',\n    setValue\n  });\n}","import { get } from 'min-dash';\n\nimport { useService } from '../hooks';\n\nimport { TextAreaEntry, isTextAreaEntryEdited } from '@bpmn-io/properties-panel';\n\n\nexport default function TextEntry(props) {\n  const {\n    editField,\n    field\n  } = props;\n\n  const {\n    type\n  } = field;\n\n  const entries = [];\n\n  if (type === 'text') {\n    entries.push({\n      id: 'text',\n      component: Text,\n      editField: editField,\n      field: field,\n      isEdited: isTextAreaEntryEdited\n    });\n  }\n\n  return entries;\n}\n\nfunction Text(props) {\n  const {\n    editField,\n    field,\n    id\n  } = props;\n\n  const debounce = useService('debounce');\n\n  const path = [ 'text' ];\n\n  const getValue = () => {\n    return get(field, path, '');\n  };\n\n  const setValue = (value) => {\n    return editField(field, path, value);\n  };\n\n  return TextAreaEntry({\n    debounce,\n    description: 'Use Markdown or basic HTML to format.',\n    element: field,\n    getValue,\n    id,\n    label: 'Text',\n    rows: 10,\n    setValue\n  });\n}","import {\n  get,\n  set\n} from 'min-dash';\n\nimport { useService } from '../hooks';\n\nimport { TextFieldEntry } from '@bpmn-io/properties-panel';\n\n\nexport default function ValueEntry(props) {\n  const {\n    editField,\n    field,\n    idPrefix,\n    index,\n    validateFactory\n  } = props;\n\n  const entries = [\n    {\n      component: Label,\n      editField,\n      field,\n      id: idPrefix + '-label',\n      idPrefix,\n      index,\n      validateFactory\n    },\n    {\n      component: Value,\n      editField,\n      field,\n      id: idPrefix + '-value',\n      idPrefix,\n      index,\n      validateFactory\n    }\n  ];\n\n  return entries;\n}\n\nfunction Label(props) {\n  const {\n    editField,\n    field,\n    id,\n    index,\n    validateFactory\n  } = props;\n\n  const debounce = useService('debounce');\n\n  const setValue = (value) => {\n    const values = get(field, [ 'values' ]);\n    return editField(field, 'values', set(values, [ index, 'label' ], value));\n  };\n\n  const getValue = () => {\n    return get(field, [ 'values', index, 'label' ]);\n  };\n\n  return TextFieldEntry({\n    debounce,\n    element: field,\n    getValue,\n    id,\n    label: 'Label',\n    setValue,\n    validate: validateFactory(getValue())\n  });\n}\n\nfunction Value(props) {\n  const {\n    editField,\n    field,\n    id,\n    index,\n    validateFactory\n  } = props;\n\n  const debounce = useService('debounce');\n\n  const setValue = (value) => {\n    const values = get(field, [ 'values' ]);\n    return editField(field, 'values', set(values, [ index, 'value' ], value));\n  };\n\n  const getValue = () => {\n    return get(field, [ 'values', index, 'value' ]);\n  };\n\n  return TextFieldEntry({\n    debounce,\n    element: field,\n    getValue,\n    id,\n    label: 'Value',\n    setValue,\n    validate: validateFactory(getValue())\n  });\n}","import { get } from 'min-dash';\n\nimport { useService } from '../hooks';\n\nimport { TextFieldEntry } from '@bpmn-io/properties-panel';\n\n\nexport default function CustomValueEntry(props) {\n  const {\n    editField,\n    field,\n    idPrefix,\n    index,\n    validateFactory\n  } = props;\n\n  const entries = [\n    {\n      component: Key,\n      editField,\n      field,\n      id: idPrefix + '-key',\n      idPrefix,\n      index,\n      validateFactory\n    },\n    {\n      component: Value,\n      editField,\n      field,\n      id: idPrefix + '-value',\n      idPrefix,\n      index,\n      validateFactory\n    }\n  ];\n\n  return entries;\n}\n\nfunction Key(props) {\n  const {\n    editField,\n    field,\n    id,\n    index,\n    validateFactory\n  } = props;\n\n  const debounce = useService('debounce');\n\n  const setValue = (value) => {\n    const properties = get(field, [ 'properties' ]);\n    const key = Object.keys(properties)[ index ];\n    return editField(field, 'properties', updateKey(properties, key, value));\n  };\n\n  const getValue = () => {\n    return Object.keys(get(field, [ 'properties' ]))[ index ];\n  };\n\n  return TextFieldEntry({\n    debounce,\n    element: field,\n    getValue,\n    id,\n    label: 'Key',\n    setValue,\n    validate: validateFactory(getValue())\n  });\n}\n\nfunction Value(props) {\n  const {\n    editField,\n    field,\n    id,\n    index,\n    validateFactory\n  } = props;\n\n  const debounce = useService('debounce');\n\n  const setValue = (value) => {\n    const properties = get(field, [ 'properties' ]);\n    const key = Object.keys(properties)[ index ];\n    editField(field, 'properties', updateValue(properties, key, value));\n  };\n\n  const getValue = () => {\n    const properties = get(field, [ 'properties' ]);\n    const key = Object.keys(properties)[ index ];\n    return get(field, [ 'properties', key ]);\n  };\n\n  return TextFieldEntry({\n    debounce,\n    element: field,\n    getValue,\n    id,\n    label: 'Value',\n    setValue,\n    validate: validateFactory(getValue())\n  });\n}\n\n\n// helpers //////////\n\n/**\n * Returns copy of object with updated value.\n *\n * @param {Object} properties\n * @param {string} key\n * @param {string} value\n *\n * @returns {Object}\n */\nfunction updateValue(properties, key, value) {\n  return {\n    ...properties,\n    [ key ]: value\n  };\n}\n\n/**\n * Returns copy of object with updated key.\n *\n * @param {Object} properties\n * @param {string} oldKey\n * @param {string} newKey\n *\n * @returns {Object}\n */\nfunction updateKey(properties, oldKey, newKey) {\n  return Object.entries(properties).reduce((newProperties, entry) => {\n    const [ key, value ] = entry;\n\n    return {\n      ...newProperties,\n      [ key === oldKey ? newKey : key ]: value\n    };\n  }, {});\n}","import { get } from 'min-dash';\n\n// config  ///////////////////\n\nexport const VALUES_SOURCES = {\n  STATIC: 'static',\n  INPUT: 'input'\n};\n\nexport const VALUES_SOURCE_DEFAULT = VALUES_SOURCES.STATIC;\n\nexport const VALUES_SOURCES_LABELS = {\n  [VALUES_SOURCES.STATIC]: 'Static',\n  [VALUES_SOURCES.INPUT]: 'Input data',\n};\n\nexport const VALUES_SOURCES_PATHS = {\n  [VALUES_SOURCES.STATIC]: [ 'values' ],\n  [VALUES_SOURCES.INPUT]: [ 'valuesKey' ],\n};\n\nexport const VALUES_SOURCES_DEFAULTS = {\n  [VALUES_SOURCES.STATIC]: [],\n  [VALUES_SOURCES.INPUT]: '',\n};\n\n// helpers ///////////////////\n\nexport function getValuesSource(field) {\n\n  for (const source of Object.values(VALUES_SOURCES)) {\n    if (get(field, VALUES_SOURCES_PATHS[source]) !== undefined) {\n      return source;\n    }\n  }\n\n  return VALUES_SOURCE_DEFAULT;\n}\n","import { SelectEntry, isSelectEntryEdited } from '@bpmn-io/properties-panel';\nimport { getValuesSource, VALUES_SOURCES, VALUES_SOURCES_DEFAULTS, VALUES_SOURCES_LABELS, VALUES_SOURCES_PATHS } from './ValuesSourceUtil';\n\nexport default function ValuesSourceSelectEntry(props) {\n  const {\n    editField,\n    field,\n    id\n  } = props;\n\n  return [\n    {\n      id: id + '-select',\n      component: ValuesSourceSelect,\n      isEdited: isSelectEntryEdited,\n      editField,\n      field\n    }\n  ];\n}\n\nfunction ValuesSourceSelect(props) {\n\n  const {\n    editField,\n    field,\n    id\n  } = props;\n\n  const getValue = getValuesSource;\n\n  const setValue = (value) => {\n\n    let newField = field;\n\n    Object.values(VALUES_SOURCES).forEach(source => {\n\n      // Clear all values source definitions and default the newly selected one\n      const newValue = value === source ? VALUES_SOURCES_DEFAULTS[source] : undefined;\n      newField = editField(field, VALUES_SOURCES_PATHS[source], newValue);\n    });\n\n    return newField;\n  };\n\n  const getValuesSourceOptions = () => {\n\n    return Object.values(VALUES_SOURCES).map((valueSource) => ({\n      label: VALUES_SOURCES_LABELS[valueSource],\n      value: valueSource\n    }));\n  };\n\n  return SelectEntry({\n    label: 'Type',\n    element: field,\n    getOptions: getValuesSourceOptions,\n    getValue,\n    id,\n    setValue\n  });\n}\n","import { TextFieldEntry, isTextFieldEntryEdited } from '@bpmn-io/properties-panel';\nimport { get } from 'min-dash';\nimport { useService } from '../hooks';\nimport { VALUES_SOURCES, VALUES_SOURCES_PATHS } from './ValuesSourceUtil';\n\nexport default function InputKeyValuesSourceEntry(props) {\n  const {\n    editField,\n    field,\n    id\n  } = props;\n\n  return [\n    {\n      id: id + '-key',\n      component: InputValuesKey,\n      label: 'Input values key',\n      description: 'Define which input property to populate the values from',\n      isEdited: isTextFieldEntryEdited,\n      editField,\n      field,\n    }\n  ];\n}\n\nfunction InputValuesKey(props) {\n  const {\n    editField,\n    field,\n    id,\n    label,\n    description\n  } = props;\n\n  const debounce = useService('debounce');\n\n  const path = VALUES_SOURCES_PATHS[VALUES_SOURCES.INPUT];\n\n  const getValue = () => get(field, path, '');\n\n  const setValue = (value) => editField(field, path, value || '');\n\n  return TextFieldEntry({\n    debounce,\n    description,\n    element: field,\n    getValue,\n    id,\n    label,\n    setValue\n  });\n}\n","import { isUndefined, without } from 'min-dash';\nimport { arrayAdd } from '../Util';\nimport ValueEntry from './ValueEntry';\nimport { VALUES_SOURCES, VALUES_SOURCES_PATHS } from './ValuesSourceUtil';\n\nexport default function StaticValuesSourceEntry(props) {\n  const {\n    editField,\n    field,\n    id: idPrefix\n  } = props;\n\n  const {\n    values\n  } = field;\n\n  const addEntry = (e) => {\n\n    e.stopPropagation();\n\n    const index = values.length + 1;\n\n    const entry = {\n      label: `Value ${index}`,\n      value: `value${index}`\n    };\n\n    editField(field, VALUES_SOURCES_PATHS[VALUES_SOURCES.STATIC], arrayAdd(values, values.length, entry));\n  };\n\n  const removeEntry = (entry) => {\n    editField(field, VALUES_SOURCES_PATHS[VALUES_SOURCES.STATIC], without(values, entry));\n  };\n\n  const validateFactory = (key) => {\n    return (value) => {\n      if (value === key) {\n        return;\n      }\n\n      if (isUndefined(value) || !value.length) {\n        return 'Must not be empty.';\n      }\n\n      const isValueAssigned = values.find(entry => entry.value === value);\n\n      if (isValueAssigned) {\n        return 'Must be unique.';\n      }\n    };\n  };\n\n  const items = values.map((entry, index) => {\n    const id = idPrefix + '-' + index;\n\n    return {\n      id,\n      label: entry.label,\n      entries: ValueEntry({\n        editField,\n        field,\n        idPrefix: id,\n        index,\n        validateFactory\n      }),\n      autoFocusEntry: id + '-label',\n      remove: () => removeEntry(entry)\n    };\n  });\n\n  return {\n    items,\n    add: addEntry\n  };\n}\n","import {\n  ActionEntry,\n  ColumnsEntry,\n  DescriptionEntry,\n  DefaultValueEntry,\n  DisabledEntry,\n  IdEntry,\n  KeyEntry,\n  LabelEntry,\n  TextEntry\n} from '../entries';\n\n\nexport default function GeneralGroup(field, editField) {\n\n  const entries = [\n    ...IdEntry({ field, editField }),\n    ...LabelEntry({ field, editField }),\n    ...DescriptionEntry({ field, editField }),\n    ...KeyEntry({ field, editField }),\n    ...DefaultValueEntry({ field, editField }),\n    ...ActionEntry({ field, editField }),\n    ...ColumnsEntry({ field, editField }),\n    ...TextEntry({ field, editField }),\n    ...DisabledEntry({ field, editField })\n  ];\n\n  return {\n    id: 'general',\n    label: 'General',\n    entries\n  };\n}","import {\n  get,\n  set\n} from 'min-dash';\n\nimport {\n  CheckboxEntry,\n  isCheckboxEntryEdited,\n  isNumberFieldEntryEdited,\n  isTextFieldEntryEdited,\n  NumberFieldEntry,\n  TextFieldEntry\n} from '@bpmn-io/properties-panel';\n\nimport { useService } from '../hooks';\n\nimport { INPUTS } from '../Util';\n\n\nexport default function ValidationGroup(field, editField) {\n  const { type } = field;\n\n  if (!(INPUTS.includes(type) && type !== 'checkbox' && type !== 'checklist' && type !== 'taglist')) {\n    return null;\n  }\n\n  const onChange = (key) => {\n    return (value) => {\n      const validate = get(field, [ 'validate' ], {});\n\n      editField(field, [ 'validate' ], set(validate, [ key ], value));\n    };\n  };\n\n  const getValue = (key) => {\n    return () => {\n      return get(field, [ 'validate', key ]);\n    };\n  };\n\n  let entries = [\n    {\n      id: 'required',\n      component: Required,\n      getValue,\n      field,\n      isEdited: isCheckboxEntryEdited,\n      onChange\n    }\n  ];\n\n  if (type === 'textfield') {\n    entries.push(\n      {\n        id: 'minLength',\n        component: MinLength,\n        getValue,\n        field,\n        isEdited: isNumberFieldEntryEdited,\n        onChange\n      },\n      {\n        id: 'maxLength',\n        component: MaxLength,\n        getValue,\n        field,\n        isEdited: isNumberFieldEntryEdited,\n        onChange\n      },\n      {\n        id: 'pattern',\n        component: Pattern,\n        getValue,\n        field,\n        isEdited: isTextFieldEntryEdited,\n        onChange\n      }\n    );\n  }\n\n  if (type === 'number') {\n    entries.push(\n      {\n        id: 'min',\n        component: Min,\n        getValue,\n        field,\n        isEdited: isNumberFieldEntryEdited,\n        onChange\n      },\n      {\n        id: 'max',\n        component: Max,\n        getValue,\n        field,\n        isEdited: isNumberFieldEntryEdited,\n        onChange\n      }\n    );\n  }\n\n  return {\n    id: 'validation',\n    label: 'Validation',\n    entries\n  };\n}\n\nfunction Required(props) {\n  const {\n    field,\n    getValue,\n    id,\n    onChange\n  } = props;\n\n  return CheckboxEntry({\n    element: field,\n    getValue: getValue('required'),\n    id,\n    label: 'Required',\n    setValue: onChange('required')\n  });\n}\n\nfunction MinLength(props) {\n  const {\n    field,\n    getValue,\n    id,\n    onChange\n  } = props;\n\n  const debounce = useService('debounce');\n\n  return NumberFieldEntry({\n    debounce,\n    element: field,\n    getValue: getValue('minLength'),\n    id,\n    label: 'Minimum length',\n    min: 0,\n    setValue: onChange('minLength')\n  });\n}\n\nfunction MaxLength(props) {\n  const {\n    field,\n    getValue,\n    id,\n    onChange\n  } = props;\n\n  const debounce = useService('debounce');\n\n  return NumberFieldEntry({\n    debounce,\n    element: field,\n    getValue: getValue('maxLength'),\n    id,\n    label: 'Maximum length',\n    min: 0,\n    setValue: onChange('maxLength')\n  });\n}\n\nfunction Pattern(props) {\n  const {\n    field,\n    getValue,\n    id,\n    onChange\n  } = props;\n\n  const debounce = useService('debounce');\n\n  return TextFieldEntry({\n    debounce,\n    element: field,\n    getValue: getValue('pattern'),\n    id,\n    label: 'Regular expression pattern',\n    setValue: onChange('pattern')\n  });\n}\n\nfunction Min(props) {\n  const {\n    field,\n    getValue,\n    id,\n    onChange\n  } = props;\n\n  const debounce = useService('debounce');\n\n  return NumberFieldEntry({\n    debounce,\n    element: field,\n    getValue: getValue('min'),\n    id,\n    label: 'Minimum',\n    min: 0,\n    setValue: onChange('min')\n  });\n}\n\nfunction Max(props) {\n  const {\n    field,\n    getValue,\n    id,\n    onChange\n  } = props;\n\n  const debounce = useService('debounce');\n\n  return NumberFieldEntry({\n    debounce,\n    element: field,\n    getValue: getValue('max'),\n    id,\n    label: 'Maximum',\n    min: 0,\n    setValue: onChange('max')\n  });\n}","import { ValuesSourceSelectEntry, StaticValuesSourceEntry, InputKeyValuesSourceEntry } from '../entries';\nimport { getValuesSource, VALUES_SOURCES } from '../entries/ValuesSourceUtil';\n\nimport { Group, ListGroup } from '@bpmn-io/properties-panel';\n\nimport {\n  VALUES_INPUTS\n} from '../Util';\n\nexport default function ValuesGroups(field, editField) {\n  const {\n    type,\n    id: fieldId\n  } = field;\n\n  if (!VALUES_INPUTS.includes(type)) {\n    return [];\n  }\n\n  const context = { editField, field };\n  const valuesSourceId = `${fieldId}-valuesSource`;\n\n  /**\n   * @type {Array<Group|ListGroup>}\n   */\n  const groups = [\n    {\n      id: valuesSourceId,\n      label: 'Options source',\n      component: Group,\n      entries: ValuesSourceSelectEntry({ ...context, id: valuesSourceId })\n    }\n  ];\n\n  const valuesSource = getValuesSource(field);\n\n  if (valuesSource === VALUES_SOURCES.INPUT) {\n    const dynamicValuesId = `${fieldId}-dynamicValues`;\n    groups.push({\n      id: dynamicValuesId,\n      label: 'Dynamic options',\n      component: Group,\n      entries: InputKeyValuesSourceEntry({ ...context, id: dynamicValuesId })\n    });\n  }\n  else if (valuesSource === VALUES_SOURCES.STATIC) {\n    const staticValuesId = `${fieldId}-staticValues`;\n    groups.push({\n      id: staticValuesId,\n      label: 'Static options',\n      component: ListGroup,\n      ...StaticValuesSourceEntry({ ...context, id: staticValuesId })\n    });\n  }\n\n  return groups;\n}","import { ListGroup } from '@bpmn-io/properties-panel';\n\nimport {\n  has,\n  isUndefined\n} from 'min-dash';\n\nimport { CustomValueEntry } from '../entries';\n\nexport default function CustomValuesGroup(field, editField) {\n  const {\n    properties = {},\n    type\n  } = field;\n\n  if (type === 'default') {\n    return null;\n  }\n\n  const addEntry = (event) => {\n    event.stopPropagation();\n\n    const index = Object.keys(properties).length + 1;\n\n    const key = `key${ index }`,\n          value = 'value';\n\n    editField(field, [ 'properties' ], { ...properties, [ key ]: value });\n  };\n\n  const validateFactory = (key) => {\n    return (value) => {\n      if (value === key) {\n        return;\n      }\n\n      if (isUndefined(value) || !value.length) {\n        return 'Must not be empty.';\n      }\n\n      if (has(properties, value)) {\n        return 'Must be unique.';\n      }\n    };\n  };\n\n  const items = Object.keys(properties).map((key, index) => {\n    const removeEntry = (event) => {\n      event.stopPropagation();\n\n      return editField(field, [ 'properties' ], removeKey(properties, key));\n    };\n\n    const id = `${ field.id }-property-${ index }`;\n\n    return {\n      autoFocusEntry: id + '-key',\n      entries: CustomValueEntry({\n        editField,\n        field,\n        idPrefix: id,\n        index,\n        validateFactory\n      }),\n      id,\n      label: key || '',\n      remove: removeEntry\n    };\n  });\n\n  return {\n    add: addEntry,\n    component: ListGroup,\n    id: 'custom-values',\n    items,\n    label: 'Custom properties',\n    shouldSort: false\n  };\n}\n\n\n// helpers //////////\n\n/**\n * Returns copy of object without key.\n *\n * @param {Object} properties\n * @param {string} oldKey\n *\n * @returns {Object}\n */\nexport function removeKey(properties, oldKey) {\n  return Object.entries(properties).reduce((newProperties, entry) => {\n    const [ key, value ] = entry;\n\n    if (key === oldKey) {\n      return newProperties;\n    }\n\n    return {\n      ...newProperties,\n      [ key ]: value\n    };\n  }, {});\n}","import { PropertiesPanel } from '@bpmn-io/properties-panel';\n\nimport {\n  useCallback,\n  useState,\n  useLayoutEffect\n} from 'preact/hooks';\n\nimport { FormPropertiesPanelContext } from './context';\n\nimport { PropertiesPanelHeaderProvider } from './PropertiesPanelHeaderProvider';\nimport { PropertiesPanelPlaceholderProvider } from './PropertiesPanelPlaceholderProvider';\n\nimport {\n  CustomValuesGroup,\n  GeneralGroup,\n  ValidationGroup,\n  ValuesGroups\n} from './groups';\n\nfunction getGroups(field, editField) {\n\n  if (!field) {\n    return [];\n  }\n\n  const groups = [\n    GeneralGroup(field, editField),\n    ...ValuesGroups(field, editField),\n    ValidationGroup(field, editField),\n    CustomValuesGroup(field, editField)\n  ];\n\n  // contract: if a group returns null, it should not be displayed at all\n  return groups.filter(group => group !== null);\n}\n\nexport default function FormPropertiesPanel(props) {\n  const {\n    eventBus,\n    injector\n  } = props;\n\n  const formEditor = injector.get('formEditor');\n  const modeling = injector.get('modeling');\n  const selection = injector.get('selection');\n\n  const { schema } = formEditor._getState();\n\n  const [ state, setState ] = useState({\n    selectedFormField: selection.get() || schema\n  });\n\n  const _update = (field) => {\n\n    setState({\n      ...state,\n      selectedFormField: field\n    });\n\n    // notify interested parties on property panel updates\n    eventBus.fire('propertiesPanel.updated', {\n      formField: field\n    });\n  };\n\n  useLayoutEffect(() => {\n    function onSelectionChange(event) {\n      _update(event.selection || schema);\n    }\n\n    eventBus.on('selection.changed', onSelectionChange);\n\n    return () => {\n      eventBus.off('selection.changed', onSelectionChange);\n    };\n  }, []);\n\n  useLayoutEffect(() => {\n    const onFieldChanged = () => {\n\n      /**\n       * TODO(pinussilvestrus): update with actual updated element,\n       * once we have a proper updater/change support\n       */\n      _update(selection.get() || schema);\n    };\n\n    eventBus.on('changed', onFieldChanged);\n\n    return () => {\n      eventBus.off('changed', onFieldChanged);\n    };\n  }, []);\n\n  const selectedFormField = state.selectedFormField;\n\n  const propertiesPanelContext = {\n    getService(type, strict = true) {\n      return injector.get(type, strict);\n    }\n  };\n\n  const onFocus = () => eventBus.fire('propertiesPanel.focusin');\n\n  const onBlur = () => eventBus.fire('propertiesPanel.focusout');\n\n  const editField = useCallback((formField, key, value) => modeling.editFormField(formField, key, value), [ modeling ]);\n\n  return (\n    <div\n      class=\"fjs-properties-panel\"\n      data-field={ selectedFormField && selectedFormField.id }\n      onFocusCapture={ onFocus }\n      onBlurCapture={ onBlur }\n    >\n      <FormPropertiesPanelContext.Provider value={ propertiesPanelContext }>\n        <PropertiesPanel\n          element={ selectedFormField }\n          eventBus={ eventBus }\n          groups={ getGroups(selectedFormField, editField) }\n          headerProvider={ PropertiesPanelHeaderProvider }\n          placeholderProvider={ PropertiesPanelPlaceholderProvider }\n        />\n      </FormPropertiesPanelContext.Provider>\n    </div>\n  );\n}","import PropertiesPanel from './PropertiesPanel';\n\nimport {\n  render\n} from 'preact';\n\nimport {\n  domify,\n  query as domQuery\n} from 'min-dom';\n\n/**\n * @typedef { { parent: Element } } PropertiesPanelConfig\n * @typedef { import('../../core/EventBus').default } EventBus\n * @typedef { import('../../types').Injector } Injector\n */\n\n/**\n * @param {PropertiesPanelConfig} propertiesPanelConfig\n * @param {Injector} injector\n * @param {EventBus} eventBus\n */\nexport default class PropertiesPanelRenderer {\n\n  constructor(propertiesPanelConfig, injector, eventBus) {\n    const {\n      parent\n    } = propertiesPanelConfig || {};\n\n    this._eventBus = eventBus;\n    this._injector = injector;\n\n    this._container = domify('<div class=\"fjs-properties-container\" input-handle-modified-keys=\"y,z\"></div>');\n\n    if (parent) {\n      this.attachTo(parent);\n    }\n\n    this._eventBus.once('formEditor.rendered', 500, () => {\n      this._render();\n    });\n  }\n\n\n  /**\n   * Attach the properties panel to a parent node.\n   *\n   * @param {HTMLElement} container\n   */\n  attachTo(container) {\n    if (!container) {\n      throw new Error('container required');\n    }\n\n    if (typeof container === 'string') {\n      container = domQuery(container);\n    }\n\n    // (1) detach from old parent\n    this.detach();\n\n    // (2) append to parent container\n    container.appendChild(this._container);\n\n    // (3) notify interested parties\n    this._eventBus.fire('propertiesPanel.attach');\n  }\n\n  /**\n   * Detach the properties panel from its parent node.\n   */\n  detach() {\n    const parentNode = this._container.parentNode;\n\n    if (parentNode) {\n      parentNode.removeChild(this._container);\n\n      this._eventBus.fire('propertiesPanel.detach');\n    }\n  }\n\n  _render() {\n    render(\n      <PropertiesPanel\n        eventBus={ this._eventBus }\n        injector={ this._injector }\n      />,\n      this._container\n    );\n\n    this._eventBus.fire('propertiesPanel.rendered');\n  }\n\n  _destroy() {\n    if (this._container) {\n      render(null, this._container);\n\n      this._eventBus.fire('propertiesPanel.destroyed');\n    }\n  }\n}\n\nPropertiesPanelRenderer.$inject = [ 'config.propertiesPanel', 'injector', 'eventBus' ];","import PropertiesPanelRenderer from './PropertiesPanelRenderer';\n\nexport default {\n  __init__: [ 'propertiesPanel' ],\n  propertiesPanel: [ 'type', PropertiesPanelRenderer ]\n};","import { clone, createFormContainer, createInjector, schemaVersion } from '@bpmn-io/form-js-viewer';\nimport Ids from 'ids';\nimport { isString, set } from 'min-dash';\n\nimport core from './core';\n\nimport EditorActionsModule from './features/editor-actions';\nimport KeyboardModule from './features/keyboard';\nimport ModelingModule from './features/modeling';\nimport SelectionModule from './features/selection';\nimport PaletteModule from './features/palette';\nimport PropertiesPanelModule from './features/properties-panel';\n\nconst ids = new Ids([ 32, 36, 1 ]);\n\n/**\n * @typedef { import('./types').Injector } Injector\n * @typedef { import('./types').Module } Module\n * @typedef { import('./types').Schema } Schema\n *\n * @typedef { import('./types').FormEditorOptions } FormEditorOptions\n * @typedef { import('./types').FormEditorProperties } FormEditorProperties\n *\n * @typedef { {\n *   properties: FormEditorProperties,\n *   schema: Schema\n * } } State\n *\n * @typedef { (type:string, priority:number, handler:Function) => void } OnEventWithPriority\n * @typedef { (type:string, handler:Function) => void } OnEventWithOutPriority\n * @typedef { OnEventWithPriority & OnEventWithOutPriority } OnEventType\n */\n\n/**\n * The form editor.\n */\nexport default class FormEditor {\n\n  /**\n   * @constructor\n   * @param {FormEditorOptions} options\n   */\n  constructor(options = {}) {\n\n    /**\n     * @public\n     * @type {OnEventType}\n     */\n    this.on = this._onEvent;\n\n    /**\n     * @public\n     * @type {String}\n     */\n    this._id = ids.next();\n\n    /**\n     * @private\n     * @type {Element}\n     */\n    this._container = createFormContainer();\n\n    this._container.setAttribute('input-handle-modified-keys', 'z,y');\n\n    const {\n      container,\n      exporter,\n      injector = this._createInjector(options, this._container),\n      properties = {}\n    } = options;\n\n    /**\n     * @private\n     * @type {any}\n     */\n    this.exporter = exporter;\n\n    /**\n     * @private\n     * @type {State}\n     */\n    this._state = {\n      properties,\n      schema: null\n    };\n\n    this.get = injector.get;\n\n    this.invoke = injector.invoke;\n\n    this.get('eventBus').fire('form.init');\n\n    if (container) {\n      this.attachTo(container);\n    }\n  }\n\n  clear() {\n\n    // clear form services\n    this._emit('diagram.clear');\n\n    // clear diagram services (e.g. EventBus)\n    this._emit('form.clear');\n  }\n\n  destroy() {\n\n    // destroy form services\n    this.get('eventBus').fire('form.destroy');\n\n    // destroy diagram services (e.g. EventBus)\n    this.get('eventBus').fire('diagram.destroy');\n\n    this._detach(false);\n  }\n\n  /**\n   * @param {Schema} schema\n   *\n   * @return {Promise<{ warnings: Array<any> }>}\n   */\n  importSchema(schema) {\n    return new Promise((resolve, reject) => {\n      try {\n        this.clear();\n\n        const {\n          schema: importedSchema,\n          warnings\n        } = this.get('importer').importSchema(schema);\n\n        this._setState({\n          schema: importedSchema\n        });\n\n        this._emit('import.done', { warnings });\n\n        return resolve({ warnings });\n      } catch (error) {\n        this._emit('import.done', {\n          error: error,\n          warnings: error.warnings || []\n        });\n\n        return reject(error);\n      }\n    });\n  }\n\n  /**\n   * @returns {Schema}\n   */\n  saveSchema() {\n    return this.getSchema();\n  }\n\n  /**\n   * @returns {Schema}\n   */\n  getSchema() {\n    const { schema } = this._getState();\n\n    return exportSchema(\n      schema,\n      this.exporter,\n      schemaVersion\n    );\n  }\n\n  /**\n   * @param {Element|string} parentNode\n   */\n  attachTo(parentNode) {\n    if (!parentNode) {\n      throw new Error('parentNode required');\n    }\n\n    this.detach();\n\n    if (isString(parentNode)) {\n      parentNode = document.querySelector(parentNode);\n    }\n\n    const container = this._container;\n\n    parentNode.appendChild(container);\n\n    this._emit('attach');\n  }\n\n  detach() {\n    this._detach();\n  }\n\n  /**\n   * @internal\n   *\n   * @param {boolean} [emit]\n   */\n  _detach(emit = true) {\n    const container = this._container,\n          parentNode = container.parentNode;\n\n    if (!parentNode) {\n      return;\n    }\n\n    if (emit) {\n      this._emit('detach');\n    }\n\n    parentNode.removeChild(container);\n  }\n\n  /**\n   * @param {any} property\n   * @param {any} value\n   */\n  setProperty(property, value) {\n    const properties = set(this._getState().properties, [ property ], value);\n\n    this._setState({ properties });\n  }\n\n\n  /**\n   * @param {string} type\n   * @param {Function} handler\n   */\n  off(type, handler) {\n    this.get('eventBus').off(type, handler);\n  }\n\n  /**\n   * @internal\n   *\n   * @param {FormEditorOptions} options\n   * @param {Element} container\n   *\n   * @returns {Injector}\n   */\n  _createInjector(options, container) {\n    const {\n      additionalModules = [],\n      modules = this._getModules(),\n      renderer = {}\n    } = options;\n\n    const config = {\n      ...options,\n      renderer: {\n        ...renderer,\n        container\n      }\n    };\n\n    return createInjector([\n      { config: [ 'value', config ] },\n      { formEditor: [ 'value', this ] },\n      core,\n      ...modules,\n      ...additionalModules\n    ]);\n  }\n\n  /**\n   * @internal\n   */\n  _emit(type, data) {\n    this.get('eventBus').fire(type, data);\n  }\n\n  /**\n   * @internal\n   */\n  _getState() {\n    return this._state;\n  }\n\n  /**\n   * @internal\n   */\n  _setState(state) {\n    this._state = {\n      ...this._state,\n      ...state\n    };\n\n    this._emit('changed', this._getState());\n  }\n\n  /**\n   * @internal\n   */\n  _getModules() {\n    return [\n      ModelingModule,\n      EditorActionsModule,\n      KeyboardModule,\n      SelectionModule,\n      PaletteModule,\n      PropertiesPanelModule\n    ];\n  }\n\n  /**\n   * @internal\n   */\n  _onEvent(type, priority, handler) {\n    this.get('eventBus').on(type, priority, handler);\n  }\n\n}\n\n// helpers //////////\n\nexport function exportSchema(schema, exporter, schemaVersion) {\n\n  const exportDetails = exporter ? {\n    exporter\n  } : {};\n\n  const cleanedSchema = clone(schema, (name, value) => {\n    if ([ '_parent', '_path' ].includes(name)) {\n      return undefined;\n    }\n\n    return value;\n  });\n\n  return {\n    ...cleanedSchema,\n    ...exportDetails,\n    schemaVersion\n  };\n}","import FormEditor from './FormEditor';\r\n\r\nimport { schemaVersion } from '@bpmn-io/form-js-viewer';\r\n\r\nexport {\r\n  FormEditor,\r\n  schemaVersion\r\n};\r\n\r\n/**\r\n * @typedef { import('./types').CreateFormEditorOptions } CreateFormEditorOptions\r\n */\r\n\r\n/**\r\n * Create a form editor.\r\n *\r\n * @param {CreateFormEditorOptions} options\r\n *\r\n * @return {Promise<FormEditor>}\r\n */\r\nexport function createFormEditor(options) {\r\n  const {\r\n    schema,\r\n    ...rest\r\n  } = options;\r\n\r\n  const formEditor = new FormEditor(rest);\r\n\r\n  return formEditor.importSchema(schema).then(() => {\r\n    return formEditor;\r\n  });\r\n}"],"names":["FN_REF","DEFAULT_PRIORITY","slice","Array","prototype","EventBus","_listeners","on","_destroy","events","priority","callback","that","isArray","isFunction","isNumber","Error","actualCallback","bind","self","forEach","e","_addListener","next","once","event","wrappedCallback","__isTomb","result","apply","arguments","off","_removeListener","createEvent","data","InternalEvent","init","fire","type","firstListener","returnValue","args","call","originalType","_invokeListeners","undefined","defaultPrevented","handleError","error","listener","cancelBubble","_invokeListener","invokeFunction","stopPropagation","preventDefault","console","newListener","_getListeners","previousListener","_setListeners","name","nextListener","listenerCallback","assign","fn","DebounceFactory","config","timeout","debounce","$inject","FieldFactory","constructor","formFieldRegistry","formFields","_formFieldRegistry","_formFields","create","attrs","applyDefaults","id","key","fieldDefinition","get","_ids","assigned","_keys","labelAttrs","label","field","_ensureId","keyed","_ensureKey","claim","prefix","nextPrefixed","FormFieldRegistry","BaseFieldRegistry","updateId","formField","newId","_validateId","_eventBus","remove","add","component","components","_parent","Importer","fieldFactory","_fieldFactory","importSchema","schema","warnings","importedSchema","importFormField","clone","err","fieldAttrs","parentId","index","parent","path","_path","importFormFields","map","importer","DragAndDropContext","createContext","drake","getService","strict","FormEditorContext","useContext","_extends","React","iconsByType","button","ButtonIcon","checkbox","CheckboxIcon","checklist","ChecklistIcon","columns","ColumnsIcon","number","NumberIcon","radio","RadioIcon","select","SelectIcon","taglist","TaglistIcon","text","TextIcon","textfield","TextfieldIcon","default","FormIcon","ContextPad","props","children","_jsx","Empty","Element","eventBus","useService","formEditor","modeling","selection","ref","useRef","scrollIntoView","current","elementBounds","getBoundingClientRect","containerBounds","_container","top","bottom","useEffect","onClick","toggle","classes","class","push","split","isSelected","onRemove","parentField","getFormFieldIndex","removeFormField","_jsxs","join","Children","FormEditor","injector","palette","paletteConfig","propertiesPanel","propertiesPanelConfig","_getState","paletteRef","propertiesPanelRef","setSelection","useState","handleSelectionChanged","setDrake","dragAndDropContext","createDragulaInstance","dragulaInstance","dragula","isContainer","el","classList","contains","copy","accepts","target","slideFactorX","slideFactorY","source","sibling","targetFormField","dataset","siblingFormField","targetIndex","length","fieldType","addFormField","sourceFormField","sourceIndex","moveFormField","onDetach","destroy","onAttach","formRenderContext","formContext","Map","errors","properties","readOnly","formId","_id","onSubmit","useCallback","onReset","hasDefaultPalette","defaultPalette","attachTo","hasDefaultPropertiesPanel","defaultPropertiesPanel","FormContext","FormRenderContext","FormComponent","fieldFormIndex","CreatePreview","handleCloned","original","Icon","innerHTML","render","Renderer","renderConfig","container","compact","App","state","setState","formEditorContext","newState","__init__","FormFields","renderer","__depends__","importModule","renderModule","NOT_REGISTERED_ERROR","IS_REGISTERED_ERROR","EditorActions","_actions","_registerDefaultActions","editorActions","commandStack","zoomScroll","copyPaste","canvas","rules","keyboardMove","keyboardMoveSelection","register","undo","redo","selectedElements","paste","opts","stepZoom","value","zoom","allowed","elements","removableElements","removeElements","moveCanvas","moveSelection","direction","accelerated","trigger","action","actions","_registerAction","isRegistered","unregister","getActions","Object","keys","message","FormEditorActions","options","set","EditorActionsModule","hasModifier","ctrlKey","metaKey","shiftKey","altKey","isCmd","isKey","indexOf","keyCode","isShift","KEYDOWN_EVENT","KEYUP_EVENT","HANDLE_MODIFIER_ATTRIBUTE","Keyboard","_config","_keydownHandler","_keyupHandler","_fire","unbind","bindTo","_keyHandler","eventBusResult","_isEventIgnored","context","keyEvent","isInput","_isModifiedKeyIgnored","allowedModifiers","_getAllowedModifiers","includes","element","modifierContainer","domClosest","_node","getAttribute","node","domEvent","getBinding","addListener","removeListener","domMatches","contentEditable","LOW_PRIORITY","KEYCODE_C","KEYCODE_V","KEYCODE_Y","KEYCODE_Z","KEYS_COPY","KEYS_PASTE","KEYS_REDO","KEYS_UNDO","KeyboardBindings","keyboard","registerBindings","keyboardBindings","FormEditorKeyboardBindings","KeyboardModule","arrayAdd","array","item","splice","arrayRemove","updatePath","AddFormFieldHandler","_formEditor","execute","targetPath","_setState","revert","EditFormFieldHandler","oldProperties","property","MoveFormFieldHandler","sourcePath","arrayMove","RemoveFormFieldHandler","UpdateIdClaimHandler","claiming","unclaim","UpdateKeyClaimHandler","Modeling","_commandStack","registerHandlers","entries","getHandlers","handler","registerHandler","editFormField","isObject","claimId","unclaimId","claimKey","unclaimKey","CommandInterceptor","unwrapEvent","command","hook","handlerFn","unwrap","fullEvent","filter","hooks","IdBehavior","preExecute","KeyBehavior","idBehavior","keyBehavior","CommandStack","_handlerMap","_stack","_stackIdx","_currentExecution","dirty","_injector","_uid","clear","_pushAction","_internalExecute","_popAction","canExecute","_getHandler","emit","_getUndoAction","_internalUndo","_getRedoAction","_setHandler","handlerCls","instantiate","canUndo","canRedo","_atomicDo","_markDirty","_revertedAction","qualifier","names","i","_createId","execution","atomic","_executedAction","postExecute","baseAction","pop","uniqueBy","reverse","concat","stackIdx","behaviorModule","commandModule","Selection","_selection","newSelection","SelectionBehavior","selectionBehavior","types","Palette","PaletteRenderer","domify","_render","domQuery","detach","appendChild","parentNode","removeChild","Header","headerProvider","getElementIcon","getDocumentationRef","getElementLabel","getTypeLabel","documentationRef","ElementIcon","width","height","viewBox","title","rel","href","ExternalLinkIcon","PropertiesPanelContext","textToLabel","substring","INPUTS","VALUES_INPUTS","labelsByType","PropertiesPanelHeaderProvider","PropertiesPanelPlaceholderProvider","getEmpty","getMultiple","ActionEntry","editField","Action","isEdited","isSelectEntryEdited","getValue","setValue","getOptions","SelectEntry","FormPropertiesPanelContext","ColumnsEntry","Columns","isNumberFieldEntryEdited","Default","NumberFieldEntry","DescriptionEntry","Description","isTextFieldEntryEdited","TextFieldEntry","DefaultOptionEntry","values","defaultOptions","DefaultValueCheckbox","DefaultValueNumber","DefaultValueSingleSelect","DefaultValueTextfield","defaultValue","parseStringToBoolean","parseBooleanToString","DisabledEntry","Disabled","isCheckboxEntryEdited","CheckboxEntry","IdEntry","Id","validate","isUndefined","validateId","SPACE_REGEX","QNAME_REGEX","ID_REGEX","idValue","containsSpace","test","KeyEntry","Key","description","LabelEntry","Label","TextEntry","Text","isTextAreaEntryEdited","TextAreaEntry","rows","ValueEntry","idPrefix","validateFactory","Value","CustomValueEntry","updateKey","updateValue","oldKey","newKey","reduce","newProperties","entry","VALUES_SOURCES","STATIC","INPUT","VALUES_SOURCE_DEFAULT","VALUES_SOURCES_LABELS","VALUES_SOURCES_PATHS","VALUES_SOURCES_DEFAULTS","getValuesSource","ValuesSourceSelectEntry","ValuesSourceSelect","newField","newValue","getValuesSourceOptions","valueSource","InputKeyValuesSourceEntry","InputValuesKey","StaticValuesSourceEntry","addEntry","removeEntry","without","isValueAssigned","find","items","autoFocusEntry","GeneralGroup","DefaultValueEntry","ValidationGroup","onChange","Required","MinLength","MaxLength","Pattern","Min","Max","min","ValuesGroups","fieldId","valuesSourceId","groups","Group","valuesSource","dynamicValuesId","staticValuesId","ListGroup","CustomValuesGroup","has","removeKey","shouldSort","getGroups","group","FormPropertiesPanel","selectedFormField","_update","useLayoutEffect","onSelectionChange","onFieldChanged","propertiesPanelContext","onFocus","onBlur","PropertiesPanelRenderer","PropertiesPanel","ids","Ids","_onEvent","createFormContainer","setAttribute","exporter","_createInjector","_state","invoke","_emit","_detach","Promise","resolve","reject","saveSchema","getSchema","exportSchema","schemaVersion","isString","document","querySelector","setProperty","additionalModules","modules","_getModules","createInjector","core","ModelingModule","SelectionModule","PaletteModule","PropertiesPanelModule","exportDetails","cleanedSchema","createFormEditor","rest","then"],"mappings":";;;;;;;;;;;;;;;;;;;;;;;AAQA,IAAIA,MAAM,GAAG,MAAb;AAEA,IAAIC,kBAAgB,GAAG,IAAvB;AAEA,IAAIC,KAAK,GAAGC,KAAK,CAACC,SAAN,CAAgBF,KAA5B;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AACe,SAASG,QAAT,GAAoB;EACjC,KAAKC,UAAL,GAAkB,EAAlB,CADiC;;;EAKjC,KAAKC,EAAL,CAAQ,iBAAR,EAA2B,CAA3B,EAA8B,KAAKC,QAAnC,EAA6C,IAA7C;AACD;AAGD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AACAH,QAAQ,CAACD,SAAT,CAAmBG,EAAnB,GAAwB,UAASE,MAAT,EAAiBC,QAAjB,EAA2BC,QAA3B,EAAqCC,IAArC,EAA2C;EAEjEH,MAAM,GAAGI,eAAO,CAACJ,MAAD,CAAP,GAAkBA,MAAlB,GAA2B,CAAEA,MAAF,CAApC;;EAEA,IAAIK,kBAAU,CAACJ,QAAD,CAAd,EAA0B;IACxBE,IAAI,GAAGD,QAAP;IACAA,QAAQ,GAAGD,QAAX;IACAA,QAAQ,GAAGT,kBAAX;;;EAGF,IAAI,CAACc,gBAAQ,CAACL,QAAD,CAAb,EAAyB;IACvB,MAAM,IAAIM,KAAJ,CAAU,2BAAV,CAAN;;;EAGF,IAAIC,cAAc,GAAGN,QAArB;;EAEA,IAAIC,IAAJ,EAAU;IACRK,cAAc,GAAGC,YA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QAPc,GAShB;MArBE;IAAR;AAyBD;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AC3DD;AACA;AACA;AACA;AACA;AACA;;AACA,SAAShC,UAAT,CAAoB3F,IAApB,EAA0B4F,MAA1B,EAAkC;;AAElC,MAAMiX,sBAAsB,GAAGpX,oBAAa,CAAC;EAC3CE;AAD2C,CAAD,CAA5C;;ACVO,SAASwP,QAAT,CAAkBC,KAAlB,EAAyBnQ,KAAzB,EAAgCoQ,IAAhC,EAAsC;EAC3C,MAAMpK,IAAI,GAAG,CAAE,GAAGmK,KAAL,CAAb;EAEAnK,IAAI,CAACqK,MAAL,CAAYrQ,KAAZ,EAAmB,CAAnB,EAAsBoQ,IAAtB;EAEA,OAAOpK,IAAP;AACD;AAsBM,SAAS6R,WAAT,CAAqB5V,IAAI,GAAG,KAA5B,EAAmC;EACxC,IAAIA,IAAI,CAAC0E,MAAL,GAAc,EAAlB,EAAsB;IACpB,OAAQ,GAAG1E,IAAI,CAAC6V,SAAL,CAAe,CAAf,EAAkB,EAAlB,CAAuB,KAAlC;;;EAGF,OAAO7V,IAAP;AACD;AAEM,MAAM8V,MAAM,GAAG,CACpB,UADoB,EAEpB,WAFoB,EAGpB,QAHoB,EAIpB,OAJoB,EAKpB,QALoB,EAMpB,SANoB,EAOpB,WAPoB,CAAf;AAUA,MAAMC,aAAa,GAAG,CAC3B,WAD2B,EAE3B,OAF2B,EAG3B,QAH2B,EAI3B,SAJ2B,CAAtB;;ACxCP,MAAMC,YAAY,GAAG;EACnBhX,MAAM,EAAE,QADW;EAEnBE,QAAQ,EAAE,UAFS;EAGnBE,SAAS,EAAE,WAHQ;EAInBE,OAAO,EAAE,SAJU;EAKnBc,OAAO,EAAE,MALU;EAMnBZ,MAAM,EAAE,QANW;EAOnBE,KAAK,EAAE,OAPY;EAQnBE,MAAM,EAAE,QARW;EASnBE,OAAO,EAAE,SATU;EAUnBE,IAAI,EAAE,MAVa;EAWnBE,SAAS,EAAE;AAXQ,CAArB;AAcO,MAAM+V,6BAA6B,GAAG;EAE3CjB,eAAe,EAAGhZ,KAAD,IAAW;IAC1B,MAAM;MACJlD;QACEkD,KAFJ;;IAIA,IAAIlD,IAAI,KAAK,MAAb,EAAqB;MACnB,OAAO8c,WAAW,CAAC5Z,KAAK,CAACgE,IAAP,CAAlB;;;IAGF,IAAIlH,IAAI,KAAK,SAAb,EAAwB;MACtB,OAAOkD,KAAK,CAACT,EAAb;;;IAGF,OAAOS,KAAK,CAACD,KAAb;GAfyC;EAkB3C+Y,cAAc,EAAG9Y,KAAD,IAAW;IACzB,MAAM;MACJlD;QACEkD,KAFJ;IAIA,MAAM0K,IAAI,GAAG3H,WAAW,CAACjG,IAAD,CAAxB;;IAEA,IAAI4N,IAAJ,EAAU;MACR,OAAO,MAAMjG,eAAC,IAAD;QAAM,KAAK,EAAC,IAAZ;QAAiB,MAAM,EAAC,IAAxB;QAA6B,OAAO,EAAC;QAAlD;;GA1BuC;EA8B3CwU,YAAY,EAAGjZ,KAAD,IAAW;IACvB,MAAM;MACJlD;QACEkD,KAFJ;IAIA,OAAOga,YAAY,CAACld,IAAD,CAAnB;;AAnCyC,CAAtC;;ACpBP;AACA;AACA;AACO,MAAMod,kCAAkC,GAAG;EAEhDC,QAAQ,EAAE,MAAM;IACd,OAAO;MACLnW,IAAI,EAAE;KADR;GAH8C;EAQhDoW,WAAW,EAAE,MAAM;IACjB,OAAO;MACLpW,IAAI,EAAE;KADR;;AAT8C,CAA3C;;ACEQ,SAASqW,WAAT,CAAqB9V,KAArB,EAA4B;EACzC,MAAM;IACJ+V,SADI;IAEJta;MACEuE,KAHJ;EAKA,MAAM;IACJzH;MACEkD,KAFJ;EAIA,MAAM2T,OAAO,GAAG,EAAhB;;EAEA,IAAI7W,IAAI,KAAK,QAAb,EAAuB;IACrB6W,OAAO,CAAC3N,IAAR,CAAa;MACXzG,EAAE,EAAE,QADO;MAEXyB,SAAS,EAAEuZ,MAFA;MAGXD,SAAS,EAAEA,SAHA;MAIXta,KAAK,EAAEA,KAJI;MAKXwa,QAAQ,EAAEC;KALZ;;;EASF,OAAO9G,OAAP;AACD;;AAED,SAAS4G,MAAT,CAAgBhW,KAAhB,EAAuB;EACrB,MAAM;IACJ+V,SADI;IAEJta,KAFI;IAGJT;MACEgF,KAJJ;EAMA,MAAMtC,IAAI,GAAG,CAAE,QAAF,CAAb;;EAEA,MAAMyY,QAAQ,GAAG,MAAM;IACrB,OAAOhb,WAAG,CAACM,KAAD,EAAQiC,IAAR,EAAc,EAAd,CAAV;GADF;;EAIA,MAAM0Y,QAAQ,GAAI3N,KAAD,IAAW;IAC1B,OAAOsN,SAAS,CAACta,KAAD,EAAQiC,IAAR,EAAc+K,KAAd,CAAhB;GADF;;EAIA,MAAM4N,UAAU,GAAG,MAAM,CACvB;IACE7a,KAAK,EAAE,QADT;IAEEiN,KAAK,EAAE;GAHc,EAKvB;IACEjN,KAAK,EAAE,OADT;IAEEiN,KAAK,EAAE;GAPc,CAAzB;;EAWA,OAAO6N,WAAW,CAAC;IACjBvK,OAAO,EAAEtQ,KADQ;IAEjB4a,UAFiB;IAGjBF,QAHiB;IAIjBnb,EAJiB;IAKjBQ,KAAK,EAAE,QALU;IAMjB4a;GANgB,CAAlB;AAQD;;AC3Dc,qBAAS7d,IAAT,EAAe4F,MAAf,EAAuB;EACpC,MAAM;IACJD;MACEG,kBAAU,CAACkY,sBAAD,CAFd;EAIA,OAAOrY,UAAU,CAAC3F,IAAD,EAAO4F,MAAP,CAAjB;AACD;;ACNc,SAASqY,YAAT,CAAsBxW,KAAtB,EAA6B;EAC1C,MAAM;IACJ+V,SADI;IAEJta;MACEuE,KAHJ;EAKA,MAAM;IACJzH;MACEkD,KAFJ;EAIA,MAAM2T,OAAO,GAAG,EAAhB;;EAEA,IAAI7W,IAAI,KAAK,SAAb,EAAwB;IACtB6W,OAAO,CAAC3N,IAAR,CAAa;MACXzG,EAAE,EAAE,SADO;MAEXyB,SAAS,EAAEga,OAFA;MAGXV,SAAS,EAAEA,SAHA;MAIXta,KAAK,EAAEA,KAJI;MAKXwa,QAAQ,EAAES;KALZ;;;EASF,OAAOtH,OAAP;AACD;;AAED,SAASqH,OAAT,CAAiBzW,KAAjB,EAAwB;EACtB,MAAM;IACJ+V,SADI;IAEJta,KAFI;IAGJT;MACEgF,KAJJ;EAMA,MAAM3F,QAAQ,GAAGiG,UAAU,CAAC,UAAD,CAA3B;;EAEA,MAAM6V,QAAQ,GAAG,MAAM;IACrB,OAAO1a,KAAK,CAACiB,UAAN,CAAiByH,MAAxB;GADF;;EAIA,MAAMiS,QAAQ,GAAI3N,KAAD,IAAW;IAC1B,IAAI/L,UAAU,GAAGjB,KAAK,CAACiB,UAAN,CAAiBvG,KAAjB,EAAjB;;IAEA,IAAIsS,KAAK,GAAG/L,UAAU,CAACyH,MAAvB,EAA+B;MAC7B,OAAOsE,KAAK,GAAG/L,UAAU,CAACyH,MAA1B,EAAkC;QAChCzH,UAAU,CAAC+E,IAAX,CAAgBkV,oBAAO,CAAC9b,MAAR,CAAe;UAAE8B,OAAO,EAAElB,KAAK,CAACT;SAAhC,CAAhB;;KAFJ,MAIO;MACL0B,UAAU,GAAGA,UAAU,CAACvG,KAAX,CAAiB,CAAjB,EAAoBsS,KAApB,CAAb;;;IAGFsN,SAAS,CAACta,KAAD,EAAQ,YAAR,EAAsBiB,UAAtB,CAAT;GAXF;;EAcA,OAAOka,gBAAgB,CAAC;IACtBvc,QADsB;IAEtB0R,OAAO,EAAEtQ,KAFa;IAGtB0a,QAHsB;IAItBnb,EAJsB;IAKtBQ,KAAK,EAAE,SALe;IAMtB4a;GANqB,CAAvB;AAQD;;AC1Dc,SAASS,gBAAT,CAA0B7W,KAA1B,EAAiC;EAC9C,MAAM;IACJ+V,SADI;IAEJta;MACEuE,KAHJ;EAKA,MAAM;IACJzH;MACEkD,KAFJ;EAIA,MAAM2T,OAAO,GAAG,EAAhB;;EAEA,IAAImG,MAAM,CAACzJ,QAAP,CAAgBvT,IAAhB,CAAJ,EAA2B;IACzB6W,OAAO,CAAC3N,IAAR,CAAa;MACXzG,EAAE,EAAE,aADO;MAEXyB,SAAS,EAAEqa,WAFA;MAGXf,SAAS,EAAEA,SAHA;MAIXta,KAAK,EAAEA,KAJI;MAKXwa,QAAQ,EAAEc;KALZ;;;EASF,OAAO3H,OAAP;AACD;;AAGD,SAAS0H,WAAT,CAAqB9W,KAArB,EAA4B;EAC1B,MAAM;IACJ+V,SADI;IAEJta,KAFI;IAGJT;MACEgF,KAJJ;EAMA,MAAM3F,QAAQ,GAAGiG,UAAU,CAAC,UAAD,CAA3B;EAEA,MAAM5C,IAAI,GAAG,CAAE,aAAF,CAAb;;EAEA,MAAMyY,QAAQ,GAAG,MAAM;IACrB,OAAOhb,WAAG,CAACM,KAAD,EAAQiC,IAAR,EAAc,EAAd,CAAV;GADF;;EAIA,MAAM0Y,QAAQ,GAAI3N,KAAD,IAAW;IAC1B,OAAOsN,SAAS,CAACta,KAAD,EAAQiC,IAAR,EAAc+K,KAAd,CAAhB;GADF;;EAIA,OAAOuO,cAAc,CAAC;IACpB3c,QADoB;IAEpB0R,OAAO,EAAEtQ,KAFW;IAGpB0a,QAHoB;IAIpBnb,EAJoB;IAKpBQ,KAAK,EAAE,mBALa;IAMpB4a;GANmB,CAArB;AAQD;;AC9Cc,SAASa,kBAAT,CAA4BjX,KAA5B,EAAmC;EAChD,MAAM;IACJ+V,SADI;IAEJta;MACEuE,KAHJ;EAKA,MAAM;IACJzH;MACEkD,KAFJ;EAIA,MAAM2T,OAAO,GAAG,EAAhB,CAVgD;;EAahD,IAAI,CAACmG,MAAM,CAACzJ,QAAP,CAAgBvT,IAAhB,CAAD,IAA0Bid,aAAa,CAAC1J,QAAd,CAAuBvT,IAAvB,KAAgC,CAACkD,KAAK,CAACyb,MAArE,EAA6E;IAC3E,OAAO9H,OAAP;;;EAGF,MAAM+H,cAAc,GAAG;IACrBpB,SADqB;IAErBta,KAFqB;IAGrBT,EAAE,EAAE,cAHiB;IAIrBQ,KAAK,EAAE;GAJT;;EAOA,IAAIjD,IAAI,KAAK,UAAb,EAAyB;IACvB6W,OAAO,CAAC3N,IAAR,CAAa,EACX,GAAG0V,cADQ;MAEX1a,SAAS,EAAE2a,oBAFA;MAGXnB,QAAQ,EAAEC;KAHZ;;;EAOF,IAAI3d,IAAI,KAAK,QAAb,EAAuB;IACrB6W,OAAO,CAAC3N,IAAR,CAAa,EACX,GAAG0V,cADQ;MAEX1a,SAAS,EAAE4a,kBAFA;MAGXpB,QAAQ,EAAES;KAHZ;;;EAOF,IAAIne,IAAI,KAAK,OAAT,IAAoBA,IAAI,KAAK,QAAjC,EAA2C;IACzC6W,OAAO,CAAC3N,IAAR,CAAa,EACX,GAAG0V,cADQ;MAEX1a,SAAS,EAAE6a,wBAFA;MAGXrB,QAAQ,EAAEC;KAHZ;GAzC8C;;;EAkDhD,IAAI3d,IAAI,KAAK,WAAb,EAA0B;IACxB6W,OAAO,CAAC3N,IAAR,CAAa,EACX,GAAG0V,cADQ;MAEX1a,SAAS,EAAE8a,qBAFA;MAGXtB,QAAQ,EAAEc;KAHZ;;;EAOF,OAAO3H,OAAP;AACD;;AAED,SAASgI,oBAAT,CAA8BpX,KAA9B,EAAqC;EACnC,MAAM;IACJ+V,SADI;IAEJta,KAFI;IAGJT,EAHI;IAIJQ;MACEwE,KALJ;EAOA,MAAM;IACJwX;MACE/b,KAFJ;EAIA,MAAMiC,IAAI,GAAG,CAAE,cAAF,CAAb;;EAEA,MAAM2Y,UAAU,GAAG,MAAM;IACvB,OAAO,CACL;MACE7a,KAAK,EAAE,SADT;MAEEiN,KAAK,EAAE;KAHJ,EAKL;MACEjN,KAAK,EAAE,aADT;MAEEiN,KAAK,EAAE;KAPJ,CAAP;GADF;;EAaA,MAAM2N,QAAQ,GAAI3N,KAAD,IAAW;IAC1B,OAAOsN,SAAS,CAACta,KAAD,EAAQiC,IAAR,EAAc+Z,oBAAoB,CAAChP,KAAD,CAAlC,CAAhB;GADF;;EAIA,MAAM0N,QAAQ,GAAG,MAAM;IACrB,OAAOuB,oBAAoB,CAACF,YAAD,CAA3B;GADF;;EAIA,OAAOlB,WAAW,CAAC;IACjBvK,OAAO,EAAEtQ,KADQ;IAEjB4a,UAFiB;IAGjBF,QAHiB;IAIjBnb,EAJiB;IAKjBQ,KALiB;IAMjB4a;GANgB,CAAlB;AAQD;;AAED,SAASiB,kBAAT,CAA4BrX,KAA5B,EAAmC;EACjC,MAAM;IACJ+V,SADI;IAEJta,KAFI;IAGJT,EAHI;IAIJQ;MACEwE,KALJ;EAOA,MAAM3F,QAAQ,GAAGiG,UAAU,CAAC,UAAD,CAA3B;EAEA,MAAM5C,IAAI,GAAG,CAAE,cAAF,CAAb;;EAEA,MAAMyY,QAAQ,GAAG,MAAM;IACrB,OAAOhb,WAAG,CAACM,KAAD,EAAQiC,IAAR,EAAc,EAAd,CAAV;GADF;;EAIA,MAAM0Y,QAAQ,GAAI3N,KAAD,IAAW;IAC1B,OAAOsN,SAAS,CAACta,KAAD,EAAQiC,IAAR,EAAc+K,KAAd,CAAhB;GADF;;EAIA,OAAOmO,gBAAgB,CAAC;IACtBvc,QADsB;IAEtB0R,OAAO,EAAEtQ,KAFa;IAGtB0a,QAHsB;IAItBnb,EAJsB;IAKtBQ,KALsB;IAMtB4a;GANqB,CAAvB;AAQD;;AAED,SAASkB,wBAAT,CAAkCtX,KAAlC,EAAyC;EACvC,MAAM;IACJ+V,SADI;IAEJta,KAFI;IAGJT,EAHI;IAIJQ;MACEwE,KALJ;EAOA,MAAM;IACJwX,YADI;IAEJN,MAAM,GAAG;MACPzb,KAHJ;EAKA,MAAMiC,IAAI,GAAG,CAAE,cAAF,CAAb;;EAEA,MAAM2Y,UAAU,GAAG,MAAM;IACvB,OAAO,CACL;MACE7a,KAAK,EAAE;KAFJ,EAIL,GAAG0b,MAJE,CAAP;GADF;;EASA,MAAMd,QAAQ,GAAI3N,KAAD,IAAW;IAC1B,OAAOsN,SAAS,CAACta,KAAD,EAAQiC,IAAR,EAAc+K,KAAK,CAACtE,MAAN,GAAesE,KAAf,GAAuB3P,SAArC,CAAhB;GADF;;EAIA,MAAMqd,QAAQ,GAAG,MAAM;IACrB,OAAOqB,YAAP;GADF;;EAIA,OAAOlB,WAAW,CAAC;IACjBvK,OAAO,EAAEtQ,KADQ;IAEjB4a,UAFiB;IAGjBF,QAHiB;IAIjBnb,EAJiB;IAKjBQ,KALiB;IAMjB4a;GANgB,CAAlB;AAQD;;AAED,SAASmB,qBAAT,CAA+BvX,KAA/B,EAAsC;EACpC,MAAM;IACJ+V,SADI;IAEJta,KAFI;IAGJT,EAHI;IAIJQ;MACEwE,KALJ;EAOA,MAAM3F,QAAQ,GAAGiG,UAAU,CAAC,UAAD,CAA3B;EAEA,MAAM5C,IAAI,GAAG,CAAE,cAAF,CAAb;;EAEA,MAAMyY,QAAQ,GAAG,MAAM;IACrB,OAAOhb,WAAG,CAACM,KAAD,EAAQiC,IAAR,EAAc,EAAd,CAAV;GADF;;EAIA,MAAM0Y,QAAQ,GAAI3N,KAAD,IAAW;IAC1B,OAAOsN,SAAS,CAACta,KAAD,EAAQiC,IAAR,EAAc+K,KAAd,CAAhB;GADF;;EAIA,OAAOuO,cAAc,CAAC;IACpB3c,QADoB;IAEpB0R,OAAO,EAAEtQ,KAFW;IAGpB0a,QAHoB;IAIpBnb,EAJoB;IAKpBQ,KALoB;IAMpB4a;GANmB,CAArB;AAQD;;;AAKD,SAASqB,oBAAT,CAA8BhP,KAA9B,EAAqC;EACnC,IAAIA,KAAK,KAAK,MAAd,EAAsB;IACpB,OAAO,IAAP;;;EAGF,OAAO,KAAP;AACD;;AAED,SAASiP,oBAAT,CAA8BjP,KAA9B,EAAqC;EACnC,IAAIA,KAAK,KAAK,IAAd,EAAoB;IAClB,OAAO,MAAP;;;EAGF,OAAO,OAAP;AACD;;AC1Oc,SAASkP,aAAT,CAAuB3X,KAAvB,EAA8B;EAC3C,MAAM;IACJ+V,SADI;IAEJta;MACEuE,KAHJ;EAKA,MAAM;IACJzH;MACEkD,KAFJ;EAIA,MAAM2T,OAAO,GAAG,EAAhB;;EAEA,IAAImG,MAAM,CAACzJ,QAAP,CAAgBvT,IAAhB,CAAJ,EAA2B;IACzB6W,OAAO,CAAC3N,IAAR,CAAa;MACXzG,EAAE,EAAE,UADO;MAEXyB,SAAS,EAAEmb,QAFA;MAGX7B,SAAS,EAAEA,SAHA;MAIXta,KAAK,EAAEA,KAJI;MAKXwa,QAAQ,EAAE4B;KALZ;;;EASF,OAAOzI,OAAP;AACD;;AAED,SAASwI,QAAT,CAAkB5X,KAAlB,EAAyB;EACvB,MAAM;IACJ+V,SADI;IAEJta,KAFI;IAGJT;MACEgF,KAJJ;EAMA,MAAMtC,IAAI,GAAG,CAAE,UAAF,CAAb;;EAEA,MAAMyY,QAAQ,GAAG,MAAM;IACrB,OAAOhb,WAAG,CAACM,KAAD,EAAQiC,IAAR,EAAc,EAAd,CAAV;GADF;;EAIA,MAAM0Y,QAAQ,GAAI3N,KAAD,IAAW;IAC1B,OAAOsN,SAAS,CAACta,KAAD,EAAQiC,IAAR,EAAc+K,KAAd,CAAhB;GADF;;EAIA,OAAOqP,aAAa,CAAC;IACnB/L,OAAO,EAAEtQ,KADU;IAEnB0a,QAFmB;IAGnBnb,EAHmB;IAInBQ,KAAK,EAAE,UAJY;IAKnB4a;GALkB,CAApB;AAOD;;ACjDc,SAAS2B,OAAT,CAAiB/X,KAAjB,EAAwB;EACrC,MAAM;IACJ+V,SADI;IAEJta;MACEuE,KAHJ;EAKA,MAAMoP,OAAO,GAAG,EAAhB;;EAEA,IAAI3T,KAAK,CAAClD,IAAN,KAAe,SAAnB,EAA8B;IAC5B6W,OAAO,CAAC3N,IAAR,CAAa;MACXzG,EAAE,EAAE,IADO;MAEXyB,SAAS,EAAEub,EAFA;MAGXjC,SAAS,EAAEA,SAHA;MAIXta,KAAK,EAAEA,KAJI;MAKXwa,QAAQ,EAAEc;KALZ;;;EASF,OAAO3H,OAAP;AACD;;AAED,SAAS4I,EAAT,CAAYhY,KAAZ,EAAmB;EACjB,MAAM;IACJ+V,SADI;IAEJta,KAFI;IAGJT;MACEgF,KAJJ;EAMA,MAAMvF,iBAAiB,GAAG6F,UAAU,CAAC,mBAAD,CAApC;EACA,MAAMjG,QAAQ,GAAGiG,UAAU,CAAC,UAAD,CAA3B;EAEA,MAAM5C,IAAI,GAAG,CAAE,IAAF,CAAb;;EAEA,MAAMyY,QAAQ,GAAG,MAAM;IACrB,OAAOhb,WAAG,CAACM,KAAD,EAAQiC,IAAR,EAAc,EAAd,CAAV;GADF;;EAIA,MAAM0Y,QAAQ,GAAI3N,KAAD,IAAW;IAC1B,OAAOsN,SAAS,CAACta,KAAD,EAAQiC,IAAR,EAAc+K,KAAd,CAAhB;GADF;;EAIA,MAAMwP,QAAQ,GAAIxP,KAAD,IAAW;IAC1B,IAAIyP,mBAAW,CAACzP,KAAD,CAAX,IAAsB,CAACA,KAAK,CAACtE,MAAjC,EAAyC;MACvC,OAAO,oBAAP;;;IAGF,MAAM9I,QAAQ,GAAGZ,iBAAiB,CAACW,IAAlB,CAAuBC,QAAvB,CAAgCoN,KAAhC,CAAjB;;IAEA,IAAIpN,QAAQ,IAAIA,QAAQ,KAAKI,KAA7B,EAAoC;MAClC,OAAO,iBAAP;;;IAGF,OAAO0c,UAAU,CAAC1P,KAAD,CAAV,IAAqB,IAA5B;GAXF;;EAcA,OAAOuO,cAAc,CAAC;IACpB3c,QADoB;IAEpB0R,OAAO,EAAEtQ,KAFW;IAGpB0a,QAHoB;IAIpBnb,EAJoB;IAKpBQ,KAAK,EAAE,IALa;IAMpB4a,QANoB;IAOpB6B;GAPmB,CAArB;AASD;;;AAID,MAAMG,WAAW,GAAG,IAApB;;AAGA,MAAMC,WAAW,GAAG,kCAApB;;AAGA,MAAMC,QAAQ,GAAG,kBAAjB;;AAEA,SAASH,UAAT,CAAoBI,OAApB,EAA6B;EAE3B,IAAIC,aAAa,CAACD,OAAD,CAAjB,EAA4B;IAC1B,OAAO,0BAAP;;;EAGF,IAAI,CAACD,QAAQ,CAACG,IAAT,CAAcF,OAAd,CAAL,EAA6B;IAE3B,IAAIF,WAAW,CAACI,IAAZ,CAAiBF,OAAjB,CAAJ,EAA+B;MAC7B,OAAO,0BAAP;;;IAGF,OAAO,wBAAP;;AAEH;;AAED,SAASC,aAAT,CAAuB/P,KAAvB,EAA8B;EAC5B,OAAO2P,WAAW,CAACK,IAAZ,CAAiBhQ,KAAjB,CAAP;AACD;;AC1Fc,SAASiQ,QAAT,CAAkB1Y,KAAlB,EAAyB;EACtC,MAAM;IACJ+V,SADI;IAEJta;MACEuE,KAHJ;EAKA,MAAM;IACJzH;MACEkD,KAFJ;EAIA,MAAM2T,OAAO,GAAG,EAAhB;;EAEA,IAAImG,MAAM,CAACzJ,QAAP,CAAgBvT,IAAhB,CAAJ,EAA2B;IACzB6W,OAAO,CAAC3N,IAAR,CAAa;MACXzG,EAAE,EAAE,KADO;MAEXyB,SAAS,EAAEkc,KAFA;MAGX5C,SAAS,EAAEA,SAHA;MAIXta,KAAK,EAAEA,KAJI;MAKXwa,QAAQ,EAAEc;KALZ;;;EASF,OAAO3H,OAAP;AACD;;AAED,SAASuJ,KAAT,CAAa3Y,KAAb,EAAoB;EAClB,MAAM;IACJ+V,SADI;IAEJta,KAFI;IAGJT;MACEgF,KAJJ;EAMA,MAAMvF,iBAAiB,GAAG6F,UAAU,CAAC,mBAAD,CAApC;EAEA,MAAMjG,QAAQ,GAAGiG,UAAU,CAAC,UAAD,CAA3B;EAEA,MAAM5C,IAAI,GAAG,CAAE,KAAF,CAAb;;EAEA,MAAMyY,QAAQ,GAAG,MAAM;IACrB,OAAOhb,WAAG,CAACM,KAAD,EAAQiC,IAAR,EAAc,EAAd,CAAV;GADF;;EAIA,MAAM0Y,QAAQ,GAAI3N,KAAD,IAAW;IAC1B,OAAOsN,SAAS,CAACta,KAAD,EAAQiC,IAAR,EAAc+K,KAAd,CAAhB;GADF;;EAIA,MAAMwP,QAAQ,GAAIxP,KAAD,IAAW;IAC1B,IAAIyP,mBAAW,CAACzP,KAAD,CAAX,IAAsB,CAACA,KAAK,CAACtE,MAAjC,EAAyC;MACvC,OAAO,oBAAP;;;IAGF,IAAI,KAAKsU,IAAL,CAAUhQ,KAAV,CAAJ,EAAsB;MACpB,OAAO,0BAAP;;;IAGF,MAAMpN,QAAQ,GAAGZ,iBAAiB,CAACa,KAAlB,CAAwBD,QAAxB,CAAiCoN,KAAjC,CAAjB;;IAEA,IAAIpN,QAAQ,IAAIA,QAAQ,KAAKI,KAA7B,EAAoC;MAClC,OAAO,iBAAP;;;IAGF,OAAO,IAAP;GAfF;;EAkBA,OAAOub,cAAc,CAAC;IACpB3c,QADoB;IAEpBue,WAAW,EAAE,0BAFO;IAGpB7M,OAAO,EAAEtQ,KAHW;IAIpB0a,QAJoB;IAKpBnb,EALoB;IAMpBQ,KAAK,EAAE,KANa;IAOpB4a,QAPoB;IAQpB6B;GARmB,CAArB;AAUD;;AC3Ec,SAASY,UAAT,CAAoB7Y,KAApB,EAA2B;EACxC,MAAM;IACJ+V,SADI;IAEJta;MACEuE,KAHJ;EAKA,MAAM;IACJzH;MACEkD,KAFJ;EAIA,MAAM2T,OAAO,GAAG,EAAhB;;EAEA,IAAImG,MAAM,CAACzJ,QAAP,CAAgBvT,IAAhB,KAAyBA,IAAI,KAAK,QAAtC,EAAgD;IAC9C6W,OAAO,CAAC3N,IAAR,CAAa;MACXzG,EAAE,EAAE,OADO;MAEXyB,SAAS,EAAEqc,OAFA;MAGX/C,SAAS,EAAEA,SAHA;MAIXta,KAAK,EAAEA,KAJI;MAKXwa,QAAQ,EAAEc;KALZ;;;EASF,OAAO3H,OAAP;AACD;;AAED,SAAS0J,OAAT,CAAe9Y,KAAf,EAAsB;EACpB,MAAM;IACJ+V,SADI;IAEJta,KAFI;IAGJT;MACEgF,KAJJ;EAMA,MAAM3F,QAAQ,GAAGiG,UAAU,CAAC,UAAD,CAA3B;EAEA,MAAM5C,IAAI,GAAG,CAAE,OAAF,CAAb;;EAEA,MAAMyY,QAAQ,GAAG,MAAM;IACrB,OAAOhb,WAAG,CAACM,KAAD,EAAQiC,IAAR,EAAc,EAAd,CAAV;GADF;;EAIA,MAAM0Y,QAAQ,GAAI3N,KAAD,IAAW;IAC1B,OAAOsN,SAAS,CAACta,KAAD,EAAQiC,IAAR,EAAc+K,KAAd,CAAhB;GADF;;EAIA,OAAOuO,cAAc,CAAC;IACpB3c,QADoB;IAEpB0R,OAAO,EAAEtQ,KAFW;IAGpB0a,QAHoB;IAIpBnb,EAJoB;IAKpBQ,KAAK,EAAE,aALa;IAMpB4a;GANmB,CAArB;AAQD;;ACvDc,SAAS2C,SAAT,CAAmB/Y,KAAnB,EAA0B;EACvC,MAAM;IACJ+V,SADI;IAEJta;MACEuE,KAHJ;EAKA,MAAM;IACJzH;MACEkD,KAFJ;EAIA,MAAM2T,OAAO,GAAG,EAAhB;;EAEA,IAAI7W,IAAI,KAAK,MAAb,EAAqB;IACnB6W,OAAO,CAAC3N,IAAR,CAAa;MACXzG,EAAE,EAAE,MADO;MAEXyB,SAAS,EAAEuc,IAFA;MAGXjD,SAAS,EAAEA,SAHA;MAIXta,KAAK,EAAEA,KAJI;MAKXwa,QAAQ,EAAEgD;KALZ;;;EASF,OAAO7J,OAAP;AACD;;AAED,SAAS4J,IAAT,CAAchZ,KAAd,EAAqB;EACnB,MAAM;IACJ+V,SADI;IAEJta,KAFI;IAGJT;MACEgF,KAJJ;EAMA,MAAM3F,QAAQ,GAAGiG,UAAU,CAAC,UAAD,CAA3B;EAEA,MAAM5C,IAAI,GAAG,CAAE,MAAF,CAAb;;EAEA,MAAMyY,QAAQ,GAAG,MAAM;IACrB,OAAOhb,WAAG,CAACM,KAAD,EAAQiC,IAAR,EAAc,EAAd,CAAV;GADF;;EAIA,MAAM0Y,QAAQ,GAAI3N,KAAD,IAAW;IAC1B,OAAOsN,SAAS,CAACta,KAAD,EAAQiC,IAAR,EAAc+K,KAAd,CAAhB;GADF;;EAIA,OAAOyQ,aAAa,CAAC;IACnB7e,QADmB;IAEnBue,WAAW,EAAE,uCAFM;IAGnB7M,OAAO,EAAEtQ,KAHU;IAInB0a,QAJmB;IAKnBnb,EALmB;IAMnBQ,KAAK,EAAE,MANY;IAOnB2d,IAAI,EAAE,EAPa;IAQnB/C;GARkB,CAApB;AAUD;;ACnDc,SAASgD,UAAT,CAAoBpZ,KAApB,EAA2B;EACxC,MAAM;IACJ+V,SADI;IAEJta,KAFI;IAGJ4d,QAHI;IAIJ7b,KAJI;IAKJ8b;MACEtZ,KANJ;EAQA,MAAMoP,OAAO,GAAG,CACd;IACE3S,SAAS,EAAEqc,KADb;IAEE/C,SAFF;IAGEta,KAHF;IAIET,EAAE,EAAEqe,QAAQ,GAAG,QAJjB;IAKEA,QALF;IAME7b,KANF;IAOE8b;GARY,EAUd;IACE7c,SAAS,EAAE8c,OADb;IAEExD,SAFF;IAGEta,KAHF;IAIET,EAAE,EAAEqe,QAAQ,GAAG,QAJjB;IAKEA,QALF;IAME7b,KANF;IAOE8b;GAjBY,CAAhB;EAqBA,OAAOlK,OAAP;AACD;;AAED,SAAS0J,KAAT,CAAe9Y,KAAf,EAAsB;EACpB,MAAM;IACJ+V,SADI;IAEJta,KAFI;IAGJT,EAHI;IAIJwC,KAJI;IAKJ8b;MACEtZ,KANJ;EAQA,MAAM3F,QAAQ,GAAGiG,UAAU,CAAC,UAAD,CAA3B;;EAEA,MAAM8V,QAAQ,GAAI3N,KAAD,IAAW;IAC1B,MAAMyO,MAAM,GAAG/b,WAAG,CAACM,KAAD,EAAQ,CAAE,QAAF,CAAR,CAAlB;IACA,OAAOsa,SAAS,CAACta,KAAD,EAAQ,QAAR,EAAkBsO,WAAG,CAACmN,MAAD,EAAS,CAAE1Z,KAAF,EAAS,OAAT,CAAT,EAA6BiL,KAA7B,CAArB,CAAhB;GAFF;;EAKA,MAAM0N,QAAQ,GAAG,MAAM;IACrB,OAAOhb,WAAG,CAACM,KAAD,EAAQ,CAAE,QAAF,EAAY+B,KAAZ,EAAmB,OAAnB,CAAR,CAAV;GADF;;EAIA,OAAOwZ,cAAc,CAAC;IACpB3c,QADoB;IAEpB0R,OAAO,EAAEtQ,KAFW;IAGpB0a,QAHoB;IAIpBnb,EAJoB;IAKpBQ,KAAK,EAAE,OALa;IAMpB4a,QANoB;IAOpB6B,QAAQ,EAAEqB,eAAe,CAACnD,QAAQ,EAAT;GAPN,CAArB;AASD;;AAED,SAASoD,OAAT,CAAevZ,KAAf,EAAsB;EACpB,MAAM;IACJ+V,SADI;IAEJta,KAFI;IAGJT,EAHI;IAIJwC,KAJI;IAKJ8b;MACEtZ,KANJ;EAQA,MAAM3F,QAAQ,GAAGiG,UAAU,CAAC,UAAD,CAA3B;;EAEA,MAAM8V,QAAQ,GAAI3N,KAAD,IAAW;IAC1B,MAAMyO,MAAM,GAAG/b,WAAG,CAACM,KAAD,EAAQ,CAAE,QAAF,CAAR,CAAlB;IACA,OAAOsa,SAAS,CAACta,KAAD,EAAQ,QAAR,EAAkBsO,WAAG,CAACmN,MAAD,EAAS,CAAE1Z,KAAF,EAAS,OAAT,CAAT,EAA6BiL,KAA7B,CAArB,CAAhB;GAFF;;EAKA,MAAM0N,QAAQ,GAAG,MAAM;IACrB,OAAOhb,WAAG,CAACM,KAAD,EAAQ,CAAE,QAAF,EAAY+B,KAAZ,EAAmB,OAAnB,CAAR,CAAV;GADF;;EAIA,OAAOwZ,cAAc,CAAC;IACpB3c,QADoB;IAEpB0R,OAAO,EAAEtQ,KAFW;IAGpB0a,QAHoB;IAIpBnb,EAJoB;IAKpBQ,KAAK,EAAE,OALa;IAMpB4a,QANoB;IAOpB6B,QAAQ,EAAEqB,eAAe,CAACnD,QAAQ,EAAT;GAPN,CAArB;AASD;;AChGc,SAASqD,gBAAT,CAA0BxZ,KAA1B,EAAiC;EAC9C,MAAM;IACJ+V,SADI;IAEJta,KAFI;IAGJ4d,QAHI;IAIJ7b,KAJI;IAKJ8b;MACEtZ,KANJ;EAQA,MAAMoP,OAAO,GAAG,CACd;IACE3S,SAAS,EAAEkc,GADb;IAEE5C,SAFF;IAGEta,KAHF;IAIET,EAAE,EAAEqe,QAAQ,GAAG,MAJjB;IAKEA,QALF;IAME7b,KANF;IAOE8b;GARY,EAUd;IACE7c,SAAS,EAAE8c,KADb;IAEExD,SAFF;IAGEta,KAHF;IAIET,EAAE,EAAEqe,QAAQ,GAAG,QAJjB;IAKEA,QALF;IAME7b,KANF;IAOE8b;GAjBY,CAAhB;EAqBA,OAAOlK,OAAP;AACD;;AAED,SAASuJ,GAAT,CAAa3Y,KAAb,EAAoB;EAClB,MAAM;IACJ+V,SADI;IAEJta,KAFI;IAGJT,EAHI;IAIJwC,KAJI;IAKJ8b;MACEtZ,KANJ;EAQA,MAAM3F,QAAQ,GAAGiG,UAAU,CAAC,UAAD,CAA3B;;EAEA,MAAM8V,QAAQ,GAAI3N,KAAD,IAAW;IAC1B,MAAMzD,UAAU,GAAG7J,WAAG,CAACM,KAAD,EAAQ,CAAE,YAAF,CAAR,CAAtB;IACA,MAAMR,GAAG,GAAGyO,MAAM,CAACC,IAAP,CAAY3E,UAAZ,EAAyBxH,KAAzB,CAAZ;IACA,OAAOuY,SAAS,CAACta,KAAD,EAAQ,YAAR,EAAsBge,SAAS,CAACzU,UAAD,EAAa/J,GAAb,EAAkBwN,KAAlB,CAA/B,CAAhB;GAHF;;EAMA,MAAM0N,QAAQ,GAAG,MAAM;IACrB,OAAOzM,MAAM,CAACC,IAAP,CAAYxO,WAAG,CAACM,KAAD,EAAQ,CAAE,YAAF,CAAR,CAAf,EAA2C+B,KAA3C,CAAP;GADF;;EAIA,OAAOwZ,cAAc,CAAC;IACpB3c,QADoB;IAEpB0R,OAAO,EAAEtQ,KAFW;IAGpB0a,QAHoB;IAIpBnb,EAJoB;IAKpBQ,KAAK,EAAE,KALa;IAMpB4a,QANoB;IAOpB6B,QAAQ,EAAEqB,eAAe,CAACnD,QAAQ,EAAT;GAPN,CAArB;AASD;;AAED,SAASoD,KAAT,CAAevZ,KAAf,EAAsB;EACpB,MAAM;IACJ+V,SADI;IAEJta,KAFI;IAGJT,EAHI;IAIJwC,KAJI;IAKJ8b;MACEtZ,KANJ;EAQA,MAAM3F,QAAQ,GAAGiG,UAAU,CAAC,UAAD,CAA3B;;EAEA,MAAM8V,QAAQ,GAAI3N,KAAD,IAAW;IAC1B,MAAMzD,UAAU,GAAG7J,WAAG,CAACM,KAAD,EAAQ,CAAE,YAAF,CAAR,CAAtB;IACA,MAAMR,GAAG,GAAGyO,MAAM,CAACC,IAAP,CAAY3E,UAAZ,EAAyBxH,KAAzB,CAAZ;IACAuY,SAAS,CAACta,KAAD,EAAQ,YAAR,EAAsBie,WAAW,CAAC1U,UAAD,EAAa/J,GAAb,EAAkBwN,KAAlB,CAAjC,CAAT;GAHF;;EAMA,MAAM0N,QAAQ,GAAG,MAAM;IACrB,MAAMnR,UAAU,GAAG7J,WAAG,CAACM,KAAD,EAAQ,CAAE,YAAF,CAAR,CAAtB;IACA,MAAMR,GAAG,GAAGyO,MAAM,CAACC,IAAP,CAAY3E,UAAZ,EAAyBxH,KAAzB,CAAZ;IACA,OAAOrC,WAAG,CAACM,KAAD,EAAQ,CAAE,YAAF,EAAgBR,GAAhB,CAAR,CAAV;GAHF;;EAMA,OAAO+b,cAAc,CAAC;IACpB3c,QADoB;IAEpB0R,OAAO,EAAEtQ,KAFW;IAGpB0a,QAHoB;IAIpBnb,EAJoB;IAKpBQ,KAAK,EAAE,OALa;IAMpB4a,QANoB;IAOpB6B,QAAQ,EAAEqB,eAAe,CAACnD,QAAQ,EAAT;GAPN,CAArB;AASD;;AAKD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;AACA,SAASuD,WAAT,CAAqB1U,UAArB,EAAiC/J,GAAjC,EAAsCwN,KAAtC,EAA6C;EAC3C,OAAO,EACL,GAAGzD,UADE;IAEL,CAAE/J,GAAF,GAASwN;GAFX;AAID;AAED;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;AACA,SAASgR,SAAT,CAAmBzU,UAAnB,EAA+B2U,MAA/B,EAAuCC,MAAvC,EAA+C;EAC7C,OAAOlQ,MAAM,CAAC0F,OAAP,CAAepK,UAAf,EAA2B6U,MAA3B,CAAkC,CAACC,aAAD,EAAgBC,KAAhB,KAA0B;IACjE,MAAM,CAAE9e,GAAF,EAAOwN,KAAP,IAAiBsR,KAAvB;IAEA,OAAO,EACL,GAAGD,aADE;MAEL,CAAE7e,GAAG,KAAK0e,MAAR,GAAiBC,MAAjB,GAA0B3e,GAA5B,GAAmCwN;KAFrC;GAHK,EAOJ,EAPI,CAAP;AAQD;;AC3IM,MAAMuR,cAAc,GAAG;EAC5BC,MAAM,EAAE,QADoB;EAE5BC,KAAK,EAAE;AAFqB,CAAvB;AAKA,MAAMC,qBAAqB,GAAGH,cAAc,CAACC,MAA7C;AAEA,MAAMG,qBAAqB,GAAG;EACnC,CAACJ,cAAc,CAACC,MAAhB,GAAyB,QADU;EAEnC,CAACD,cAAc,CAACE,KAAhB,GAAwB;AAFW,CAA9B;AAKA,MAAMG,oBAAoB,GAAG;EAClC,CAACL,cAAc,CAACC,MAAhB,GAAyB,CAAE,QAAF,CADS;EAElC,CAACD,cAAc,CAACE,KAAhB,GAAwB,CAAE,WAAF;AAFU,CAA7B;AAKA,MAAMI,uBAAuB,GAAG;EACrC,CAACN,cAAc,CAACC,MAAhB,GAAyB,EADY;EAErC,CAACD,cAAc,CAACE,KAAhB,GAAwB;AAFa,CAAhC;;AAOA,SAASK,eAAT,CAAyB9e,KAAzB,EAAgC;EAErC,KAAK,MAAMoI,MAAX,IAAqB6F,MAAM,CAACwN,MAAP,CAAc8C,cAAd,CAArB,EAAoD;IAClD,IAAI7e,WAAG,CAACM,KAAD,EAAQ4e,oBAAoB,CAACxW,MAAD,CAA5B,CAAH,KAA6C/K,SAAjD,EAA4D;MAC1D,OAAO+K,MAAP;;;;EAIJ,OAAOsW,qBAAP;AACD;;AClCc,SAASK,uBAAT,CAAiCxa,KAAjC,EAAwC;EACrD,MAAM;IACJ+V,SADI;IAEJta,KAFI;IAGJT;MACEgF,KAJJ;EAMA,OAAO,CACL;IACEhF,EAAE,EAAEA,EAAE,GAAG,SADX;IAEEyB,SAAS,EAAEge,kBAFb;IAGExE,QAAQ,EAAEC,UAHZ;IAIEH,SAJF;IAKEta;GANG,CAAP;AASD;;AAED,SAASgf,kBAAT,CAA4Bza,KAA5B,EAAmC;EAEjC,MAAM;IACJ+V,SADI;IAEJta,KAFI;IAGJT;MACEgF,KAJJ;EAMA,MAAMmW,QAAQ,GAAGoE,eAAjB;;EAEA,MAAMnE,QAAQ,GAAI3N,KAAD,IAAW;IAE1B,IAAIiS,QAAQ,GAAGjf,KAAf;IAEAiO,MAAM,CAACwN,MAAP,CAAc8C,cAAd,EAA8B3iB,OAA9B,CAAsCwM,MAAM,IAAI;;MAG9C,MAAM8W,QAAQ,GAAGlS,KAAK,KAAK5E,MAAV,GAAmByW,uBAAuB,CAACzW,MAAD,CAA1C,GAAqD/K,SAAtE;MACA4hB,QAAQ,GAAG3E,SAAS,CAACta,KAAD,EAAQ4e,oBAAoB,CAACxW,MAAD,CAA5B,EAAsC8W,QAAtC,CAApB;KAJF;IAOA,OAAOD,QAAP;GAXF;;EAcA,MAAME,sBAAsB,GAAG,MAAM;IAEnC,OAAOlR,MAAM,CAACwN,MAAP,CAAc8C,cAAd,EAA8Bnc,GAA9B,CAAmCgd,WAAD,KAAkB;MACzDrf,KAAK,EAAE4e,qBAAqB,CAACS,WAAD,CAD6B;MAEzDpS,KAAK,EAAEoS;KAFgC,CAAlC,CAAP;GAFF;;EAQA,OAAOvE,WAAW,CAAC;IACjB9a,KAAK,EAAE,MADU;IAEjBuQ,OAAO,EAAEtQ,KAFQ;IAGjB4a,UAAU,EAAEuE,sBAHK;IAIjBzE,QAJiB;IAKjBnb,EALiB;IAMjBob;GANgB,CAAlB;AAQD;;ACxDc,SAAS0E,yBAAT,CAAmC9a,KAAnC,EAA0C;EACvD,MAAM;IACJ+V,SADI;IAEJta,KAFI;IAGJT;MACEgF,KAJJ;EAMA,OAAO,CACL;IACEhF,EAAE,EAAEA,EAAE,GAAG,MADX;IAEEyB,SAAS,EAAEse,cAFb;IAGEvf,KAAK,EAAE,kBAHT;IAIEod,WAAW,EAAE,yDAJf;IAKE3C,QAAQ,EAAEc,UALZ;IAMEhB,SANF;IAOEta;GARG,CAAP;AAWD;;AAED,SAASsf,cAAT,CAAwB/a,KAAxB,EAA+B;EAC7B,MAAM;IACJ+V,SADI;IAEJta,KAFI;IAGJT,EAHI;IAIJQ,KAJI;IAKJod;MACE5Y,KANJ;EAQA,MAAM3F,QAAQ,GAAGiG,UAAU,CAAC,UAAD,CAA3B;EAEA,MAAM5C,IAAI,GAAG2c,oBAAoB,CAACL,cAAc,CAACE,KAAhB,CAAjC;;EAEA,MAAM/D,QAAQ,GAAG,MAAMhb,WAAG,CAACM,KAAD,EAAQiC,IAAR,EAAc,EAAd,CAA1B;;EAEA,MAAM0Y,QAAQ,GAAI3N,KAAD,IAAWsN,SAAS,CAACta,KAAD,EAAQiC,IAAR,EAAc+K,KAAK,IAAI,EAAvB,CAArC;;EAEA,OAAOuO,cAAc,CAAC;IACpB3c,QADoB;IAEpBue,WAFoB;IAGpB7M,OAAO,EAAEtQ,KAHW;IAIpB0a,QAJoB;IAKpBnb,EALoB;IAMpBQ,KANoB;IAOpB4a;GAPmB,CAArB;AASD;;AC9Cc,SAAS4E,uBAAT,CAAiChb,KAAjC,EAAwC;EACrD,MAAM;IACJ+V,SADI;IAEJta,KAFI;IAGJT,EAAE,EAAEqe;MACFrZ,KAJJ;EAMA,MAAM;IACJkX;MACEzb,KAFJ;;EAIA,MAAMwf,QAAQ,GAAI3jB,CAAD,IAAO;IAEtBA,CAAC,CAACgC,eAAF;IAEA,MAAMkE,KAAK,GAAG0Z,MAAM,CAAC/S,MAAP,GAAgB,CAA9B;IAEA,MAAM4V,KAAK,GAAG;MACZve,KAAK,EAAG,SAAQgC,KAAM,EADV;MAEZiL,KAAK,EAAG,QAAOjL,KAAM;KAFvB;IAKAuY,SAAS,CAACta,KAAD,EAAQ4e,oBAAoB,CAACL,cAAc,CAACC,MAAhB,CAA5B,EAAqDvM,QAAQ,CAACwJ,MAAD,EAASA,MAAM,CAAC/S,MAAhB,EAAwB4V,KAAxB,CAA7D,CAAT;GAXF;;EAcA,MAAMmB,WAAW,GAAInB,KAAD,IAAW;IAC7BhE,SAAS,CAACta,KAAD,EAAQ4e,oBAAoB,CAACL,cAAc,CAACC,MAAhB,CAA5B,EAAqDkB,eAAO,CAACjE,MAAD,EAAS6C,KAAT,CAA5D,CAAT;GADF;;EAIA,MAAMT,eAAe,GAAIre,GAAD,IAAS;IAC/B,OAAQwN,KAAD,IAAW;MAChB,IAAIA,KAAK,KAAKxN,GAAd,EAAmB;QACjB;;;MAGF,IAAIid,mBAAW,CAACzP,KAAD,CAAX,IAAsB,CAACA,KAAK,CAACtE,MAAjC,EAAyC;QACvC,OAAO,oBAAP;;;MAGF,MAAMiX,eAAe,GAAGlE,MAAM,CAACmE,IAAP,CAAYtB,KAAK,IAAIA,KAAK,CAACtR,KAAN,KAAgBA,KAArC,CAAxB;;MAEA,IAAI2S,eAAJ,EAAqB;QACnB,OAAO,iBAAP;;KAZJ;GADF;;EAkBA,MAAME,KAAK,GAAGpE,MAAM,CAACrZ,GAAP,CAAW,CAACkc,KAAD,EAAQvc,KAAR,KAAkB;IACzC,MAAMxC,EAAE,GAAGqe,QAAQ,GAAG,GAAX,GAAiB7b,KAA5B;IAEA,OAAO;MACLxC,EADK;MAELQ,KAAK,EAAEue,KAAK,CAACve,KAFR;MAGL4T,OAAO,EAAEgK,UAAU,CAAC;QAClBrD,SADkB;QAElBta,KAFkB;QAGlB4d,QAAQ,EAAEre,EAHQ;QAIlBwC,KAJkB;QAKlB8b;OALiB,CAHd;MAULiC,cAAc,EAAEvgB,EAAE,GAAG,QAVhB;MAWLuB,MAAM,EAAE,MAAM2e,WAAW,CAACnB,KAAD;KAX3B;GAHY,CAAd;EAkBA,OAAO;IACLuB,KADK;IAEL9e,GAAG,EAAEye;GAFP;AAID;;AC7Dc,SAASO,YAAT,CAAsB/f,KAAtB,EAA6Bsa,SAA7B,EAAwC;EAErD,MAAM3G,OAAO,GAAG,CACd,GAAG2I,OAAO,CAAC;IAAEtc,KAAF;IAASsa;GAAV,CADI,EAEd,GAAG8C,UAAU,CAAC;IAAEpd,KAAF;IAASsa;GAAV,CAFC,EAGd,GAAGc,gBAAgB,CAAC;IAAEpb,KAAF;IAASsa;GAAV,CAHL,EAId,GAAG2C,QAAQ,CAAC;IAAEjd,KAAF;IAASsa;GAAV,CAJG,EAKd,GAAG0F,kBAAiB,CAAC;IAAEhgB,KAAF;IAASsa;GAAV,CALN,EAMd,GAAGD,WAAW,CAAC;IAAEra,KAAF;IAASsa;GAAV,CANA,EAOd,GAAGS,YAAY,CAAC;IAAE/a,KAAF;IAASsa;GAAV,CAPD,EAQd,GAAGgD,SAAS,CAAC;IAAEtd,KAAF;IAASsa;GAAV,CARE,EASd,GAAG4B,aAAa,CAAC;IAAElc,KAAF;IAASsa;GAAV,CATF,CAAhB;EAYA,OAAO;IACL/a,EAAE,EAAE,SADC;IAELQ,KAAK,EAAE,SAFF;IAGL4T;GAHF;AAKD;;ACbc,SAASsM,eAAT,CAAyBjgB,KAAzB,EAAgCsa,SAAhC,EAA2C;EACxD,MAAM;IAAExd;MAASkD,KAAjB;;EAEA,IAAI,EAAE8Z,MAAM,CAACzJ,QAAP,CAAgBvT,IAAhB,KAAyBA,IAAI,KAAK,UAAlC,IAAgDA,IAAI,KAAK,WAAzD,IAAwEA,IAAI,KAAK,SAAnF,CAAJ,EAAmG;IACjG,OAAO,IAAP;;;EAGF,MAAMojB,QAAQ,GAAI1gB,GAAD,IAAS;IACxB,OAAQwN,KAAD,IAAW;MAChB,MAAMwP,QAAQ,GAAG9c,WAAG,CAACM,KAAD,EAAQ,CAAE,UAAF,CAAR,EAAwB,EAAxB,CAApB;MAEAsa,SAAS,CAACta,KAAD,EAAQ,CAAE,UAAF,CAAR,EAAwBsO,WAAG,CAACkO,QAAD,EAAW,CAAEhd,GAAF,CAAX,EAAoBwN,KAApB,CAA3B,CAAT;KAHF;GADF;;EAQA,MAAM0N,QAAQ,GAAIlb,GAAD,IAAS;IACxB,OAAO,MAAM;MACX,OAAOE,WAAG,CAACM,KAAD,EAAQ,CAAE,UAAF,EAAcR,GAAd,CAAR,CAAV;KADF;GADF;;EAMA,IAAImU,OAAO,GAAG,CACZ;IACEpU,EAAE,EAAE,UADN;IAEEyB,SAAS,EAAEmf,QAFb;IAGEzF,QAHF;IAIE1a,KAJF;IAKEwa,QAAQ,EAAE4B,UALZ;IAME8D;GAPU,CAAd;;EAWA,IAAIpjB,IAAI,KAAK,WAAb,EAA0B;IACxB6W,OAAO,CAAC3N,IAAR,CACE;MACEzG,EAAE,EAAE,WADN;MAEEyB,SAAS,EAAEof,SAFb;MAGE1F,QAHF;MAIE1a,KAJF;MAKEwa,QAAQ,EAAES,UALZ;MAMEiF;KAPJ,EASE;MACE3gB,EAAE,EAAE,WADN;MAEEyB,SAAS,EAAEqf,SAFb;MAGE3F,QAHF;MAIE1a,KAJF;MAKEwa,QAAQ,EAAES,UALZ;MAMEiF;KAfJ,EAiBE;MACE3gB,EAAE,EAAE,SADN;MAEEyB,SAAS,EAAEsf,OAFb;MAGE5F,QAHF;MAIE1a,KAJF;MAKEwa,QAAQ,EAAEc,UALZ;MAME4E;KAvBJ;;;EA4BF,IAAIpjB,IAAI,KAAK,QAAb,EAAuB;IACrB6W,OAAO,CAAC3N,IAAR,CACE;MACEzG,EAAE,EAAE,KADN;MAEEyB,SAAS,EAAEuf,GAFb;MAGE7F,QAHF;MAIE1a,KAJF;MAKEwa,QAAQ,EAAES,UALZ;MAMEiF;KAPJ,EASE;MACE3gB,EAAE,EAAE,KADN;MAEEyB,SAAS,EAAEwf,GAFb;MAGE9F,QAHF;MAIE1a,KAJF;MAKEwa,QAAQ,EAAES,UALZ;MAMEiF;KAfJ;;;EAoBF,OAAO;IACL3gB,EAAE,EAAE,YADC;IAELQ,KAAK,EAAE,YAFF;IAGL4T;GAHF;AAKD;;AAED,SAASwM,QAAT,CAAkB5b,KAAlB,EAAyB;EACvB,MAAM;IACJvE,KADI;IAEJ0a,QAFI;IAGJnb,EAHI;IAIJ2gB;MACE3b,KALJ;EAOA,OAAO8X,aAAa,CAAC;IACnB/L,OAAO,EAAEtQ,KADU;IAEnB0a,QAAQ,EAAEA,QAAQ,CAAC,UAAD,CAFC;IAGnBnb,EAHmB;IAInBQ,KAAK,EAAE,UAJY;IAKnB4a,QAAQ,EAAEuF,QAAQ,CAAC,UAAD;GALA,CAApB;AAOD;;AAED,SAASE,SAAT,CAAmB7b,KAAnB,EAA0B;EACxB,MAAM;IACJvE,KADI;IAEJ0a,QAFI;IAGJnb,EAHI;IAIJ2gB;MACE3b,KALJ;EAOA,MAAM3F,QAAQ,GAAGiG,UAAU,CAAC,UAAD,CAA3B;EAEA,OAAOsW,gBAAgB,CAAC;IACtBvc,QADsB;IAEtB0R,OAAO,EAAEtQ,KAFa;IAGtB0a,QAAQ,EAAEA,QAAQ,CAAC,WAAD,CAHI;IAItBnb,EAJsB;IAKtBQ,KAAK,EAAE,gBALe;IAMtB0gB,GAAG,EAAE,CANiB;IAOtB9F,QAAQ,EAAEuF,QAAQ,CAAC,WAAD;GAPG,CAAvB;AASD;;AAED,SAASG,SAAT,CAAmB9b,KAAnB,EAA0B;EACxB,MAAM;IACJvE,KADI;IAEJ0a,QAFI;IAGJnb,EAHI;IAIJ2gB;MACE3b,KALJ;EAOA,MAAM3F,QAAQ,GAAGiG,UAAU,CAAC,UAAD,CAA3B;EAEA,OAAOsW,gBAAgB,CAAC;IACtBvc,QADsB;IAEtB0R,OAAO,EAAEtQ,KAFa;IAGtB0a,QAAQ,EAAEA,QAAQ,CAAC,WAAD,CAHI;IAItBnb,EAJsB;IAKtBQ,KAAK,EAAE,gBALe;IAMtB0gB,GAAG,EAAE,CANiB;IAOtB9F,QAAQ,EAAEuF,QAAQ,CAAC,WAAD;GAPG,CAAvB;AASD;;AAED,SAASI,OAAT,CAAiB/b,KAAjB,EAAwB;EACtB,MAAM;IACJvE,KADI;IAEJ0a,QAFI;IAGJnb,EAHI;IAIJ2gB;MACE3b,KALJ;EAOA,MAAM3F,QAAQ,GAAGiG,UAAU,CAAC,UAAD,CAA3B;EAEA,OAAO0W,cAAc,CAAC;IACpB3c,QADoB;IAEpB0R,OAAO,EAAEtQ,KAFW;IAGpB0a,QAAQ,EAAEA,QAAQ,CAAC,SAAD,CAHE;IAIpBnb,EAJoB;IAKpBQ,KAAK,EAAE,4BALa;IAMpB4a,QAAQ,EAAEuF,QAAQ,CAAC,SAAD;GANC,CAArB;AAQD;;AAED,SAASK,GAAT,CAAahc,KAAb,EAAoB;EAClB,MAAM;IACJvE,KADI;IAEJ0a,QAFI;IAGJnb,EAHI;IAIJ2gB;MACE3b,KALJ;EAOA,MAAM3F,QAAQ,GAAGiG,UAAU,CAAC,UAAD,CAA3B;EAEA,OAAOsW,gBAAgB,CAAC;IACtBvc,QADsB;IAEtB0R,OAAO,EAAEtQ,KAFa;IAGtB0a,QAAQ,EAAEA,QAAQ,CAAC,KAAD,CAHI;IAItBnb,EAJsB;IAKtBQ,KAAK,EAAE,SALe;IAMtB0gB,GAAG,EAAE,CANiB;IAOtB9F,QAAQ,EAAEuF,QAAQ,CAAC,KAAD;GAPG,CAAvB;AASD;;AAED,SAASM,GAAT,CAAajc,KAAb,EAAoB;EAClB,MAAM;IACJvE,KADI;IAEJ0a,QAFI;IAGJnb,EAHI;IAIJ2gB;MACE3b,KALJ;EAOA,MAAM3F,QAAQ,GAAGiG,UAAU,CAAC,UAAD,CAA3B;EAEA,OAAOsW,gBAAgB,CAAC;IACtBvc,QADsB;IAEtB0R,OAAO,EAAEtQ,KAFa;IAGtB0a,QAAQ,EAAEA,QAAQ,CAAC,KAAD,CAHI;IAItBnb,EAJsB;IAKtBQ,KAAK,EAAE,SALe;IAMtB0gB,GAAG,EAAE,CANiB;IAOtB9F,QAAQ,EAAEuF,QAAQ,CAAC,KAAD;GAPG,CAAvB;AASD;;AC1Nc,SAASQ,YAAT,CAAsB1gB,KAAtB,EAA6Bsa,SAA7B,EAAwC;EACrD,MAAM;IACJxd,IADI;IAEJyC,EAAE,EAAEohB;MACF3gB,KAHJ;;EAKA,IAAI,CAAC+Z,aAAa,CAAC1J,QAAd,CAAuBvT,IAAvB,CAAL,EAAmC;IACjC,OAAO,EAAP;;;EAGF,MAAMiT,OAAO,GAAG;IAAEuK,SAAF;IAAata;GAA7B;EACA,MAAM4gB,cAAc,GAAI,GAAED,OAAQ,eAAlC;;AAGF;AACA;;EACE,MAAME,MAAM,GAAG,CACb;IACEthB,EAAE,EAAEqhB,cADN;IAEE7gB,KAAK,EAAE,gBAFT;IAGEiB,SAAS,EAAE8f,KAHb;IAIEnN,OAAO,EAAEoL,uBAAuB,CAAC,EAAE,GAAGhP,OAAL;MAAcxQ,EAAE,EAAEqhB;KAAnB;GALrB,CAAf;EASA,MAAMG,YAAY,GAAGjC,eAAe,CAAC9e,KAAD,CAApC;;EAEA,IAAI+gB,YAAY,KAAKxC,cAAc,CAACE,KAApC,EAA2C;IACzC,MAAMuC,eAAe,GAAI,GAAEL,OAAQ,gBAAnC;IACAE,MAAM,CAAC7a,IAAP,CAAY;MACVzG,EAAE,EAAEyhB,eADM;MAEVjhB,KAAK,EAAE,iBAFG;MAGViB,SAAS,EAAE8f,KAHD;MAIVnN,OAAO,EAAE0L,yBAAyB,CAAC,EAAE,GAAGtP,OAAL;QAAcxQ,EAAE,EAAEyhB;OAAnB;KAJpC;GAFF,MASK,IAAID,YAAY,KAAKxC,cAAc,CAACC,MAApC,EAA4C;IAC/C,MAAMyC,cAAc,GAAI,GAAEN,OAAQ,eAAlC;IACAE,MAAM,CAAC7a,IAAP,CAAY;MACVzG,EAAE,EAAE0hB,cADM;MAEVlhB,KAAK,EAAE,gBAFG;MAGViB,SAAS,EAAEkgB,SAHD;MAIV,GAAG3B,uBAAuB,CAAC,EAAE,GAAGxP,OAAL;QAAcxQ,EAAE,EAAE0hB;OAAnB;KAJ5B;;;EAQF,OAAOJ,MAAP;AACD;;AC/Cc,SAASM,iBAAT,CAA2BnhB,KAA3B,EAAkCsa,SAAlC,EAA6C;EAC1D,MAAM;IACJ/Q,UAAU,GAAG,EADT;IAEJzM;MACEkD,KAHJ;;EAKA,IAAIlD,IAAI,KAAK,SAAb,EAAwB;IACtB,OAAO,IAAP;;;EAGF,MAAM0iB,QAAQ,GAAIvjB,KAAD,IAAW;IAC1BA,KAAK,CAAC4B,eAAN;IAEA,MAAMkE,KAAK,GAAGkM,MAAM,CAACC,IAAP,CAAY3E,UAAZ,EAAwBb,MAAxB,GAAiC,CAA/C;IAEA,MAAMlJ,GAAG,GAAI,MAAMuC,KAAO,EAA1B;UACMiL,KAAK,GAAG,OADd;IAGAsN,SAAS,CAACta,KAAD,EAAQ,CAAE,YAAF,CAAR,EAA0B,EAAE,GAAGuJ,UAAL;MAAiB,CAAE/J,GAAF,GAASwN;KAApD,CAAT;GARF;;EAWA,MAAM6Q,eAAe,GAAIre,GAAD,IAAS;IAC/B,OAAQwN,KAAD,IAAW;MAChB,IAAIA,KAAK,KAAKxN,GAAd,EAAmB;QACjB;;;MAGF,IAAIid,mBAAW,CAACzP,KAAD,CAAX,IAAsB,CAACA,KAAK,CAACtE,MAAjC,EAAyC;QACvC,OAAO,oBAAP;;;MAGF,IAAI0Y,WAAG,CAAC7X,UAAD,EAAayD,KAAb,CAAP,EAA4B;QAC1B,OAAO,iBAAP;;KAVJ;GADF;;EAgBA,MAAM6S,KAAK,GAAG5R,MAAM,CAACC,IAAP,CAAY3E,UAAZ,EAAwBnH,GAAxB,CAA4B,CAAC5C,GAAD,EAAMuC,KAAN,KAAgB;IACxD,MAAM0d,WAAW,GAAIxjB,KAAD,IAAW;MAC7BA,KAAK,CAAC4B,eAAN;MAEA,OAAOyc,SAAS,CAACta,KAAD,EAAQ,CAAE,YAAF,CAAR,EAA0BqhB,SAAS,CAAC9X,UAAD,EAAa/J,GAAb,CAAnC,CAAhB;KAHF;;IAMA,MAAMD,EAAE,GAAI,GAAGS,KAAK,CAACT,EAAI,aAAawC,KAAO,EAA7C;IAEA,OAAO;MACL+d,cAAc,EAAEvgB,EAAE,GAAG,MADhB;MAELoU,OAAO,EAAEoK,gBAAgB,CAAC;QACxBzD,SADwB;QAExBta,KAFwB;QAGxB4d,QAAQ,EAAEre,EAHc;QAIxBwC,KAJwB;QAKxB8b;OALuB,CAFpB;MASLte,EATK;MAULQ,KAAK,EAAEP,GAAG,IAAI,EAVT;MAWLsB,MAAM,EAAE2e;KAXV;GATY,CAAd;EAwBA,OAAO;IACL1e,GAAG,EAAEye,QADA;IAELxe,SAAS,EAAEkgB,SAFN;IAGL3hB,EAAE,EAAE,eAHC;IAILsgB,KAJK;IAKL9f,KAAK,EAAE,mBALF;IAMLuhB,UAAU,EAAE;GANd;AAQD;;AAKD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AACO,SAASD,SAAT,CAAmB9X,UAAnB,EAA+B2U,MAA/B,EAAuC;EAC5C,OAAOjQ,MAAM,CAAC0F,OAAP,CAAepK,UAAf,EAA2B6U,MAA3B,CAAkC,CAACC,aAAD,EAAgBC,KAAhB,KAA0B;IACjE,MAAM,CAAE9e,GAAF,EAAOwN,KAAP,IAAiBsR,KAAvB;;IAEA,IAAI9e,GAAG,KAAK0e,MAAZ,EAAoB;MAClB,OAAOG,aAAP;;;IAGF,OAAO,EACL,GAAGA,aADE;MAEL,CAAE7e,GAAF,GAASwN;KAFX;GAPK,EAWJ,EAXI,CAAP;AAYD;;ACpFD,SAASuU,SAAT,CAAmBvhB,KAAnB,EAA0Bsa,SAA1B,EAAqC;EAEnC,IAAI,CAACta,KAAL,EAAY;IACV,OAAO,EAAP;;;EAGF,MAAM6gB,MAAM,GAAG,CACbd,YAAY,CAAC/f,KAAD,EAAQsa,SAAR,CADC,EAEb,GAAGoG,YAAY,CAAC1gB,KAAD,EAAQsa,SAAR,CAFF,EAGb2F,eAAe,CAACjgB,KAAD,EAAQsa,SAAR,CAHF,EAIb6G,iBAAiB,CAACnhB,KAAD,EAAQsa,SAAR,CAJJ,CAAf,CANmC;;EAcnC,OAAOuG,MAAM,CAACjM,MAAP,CAAc4M,KAAK,IAAIA,KAAK,KAAK,IAAjC,CAAP;AACD;;AAEc,SAASC,mBAAT,CAA6Bld,KAA7B,EAAoC;EACjD,MAAM;IACJK,QADI;IAEJ+B;MACEpC,KAHJ;EAKA,MAAMO,UAAU,GAAG6B,QAAQ,CAACjH,GAAT,CAAa,YAAb,CAAnB;EACA,MAAMqF,QAAQ,GAAG4B,QAAQ,CAACjH,GAAT,CAAa,UAAb,CAAjB;EACA,MAAMsF,SAAS,GAAG2B,QAAQ,CAACjH,GAAT,CAAa,WAAb,CAAlB;;EAEA,MAAM;IAAE6B;MAAWuD,UAAU,CAACkC,SAAX,EAAnB;;EAEA,MAAM,CAAEkE,KAAF,EAASC,QAAT,IAAsB/D,gBAAQ,CAAC;IACnCsa,iBAAiB,EAAE1c,SAAS,CAACtF,GAAV,MAAmB6B;GADJ,CAApC;;EAIA,MAAMogB,OAAO,GAAI3hB,KAAD,IAAW;IAEzBmL,QAAQ,CAAC,EACP,GAAGD,KADI;MAEPwW,iBAAiB,EAAE1hB;KAFb,CAAR,CAFyB;;IAQzB4E,QAAQ,CAAC/H,IAAT,CAAc,yBAAd,EAAyC;MACvC6D,SAAS,EAAEV;KADb;GARF;;EAaA4hB,uBAAe,CAAC,MAAM;IACpB,SAASC,iBAAT,CAA2B5lB,KAA3B,EAAkC;MAChC0lB,OAAO,CAAC1lB,KAAK,CAAC+I,SAAN,IAAmBzD,MAApB,CAAP;;;IAGFqD,QAAQ,CAAC7J,EAAT,CAAY,mBAAZ,EAAiC8mB,iBAAjC;IAEA,OAAO,MAAM;MACXjd,QAAQ,CAACrI,GAAT,CAAa,mBAAb,EAAkCslB,iBAAlC;KADF;GAPa,EAUZ,EAVY,CAAf;EAYAD,uBAAe,CAAC,MAAM;IACpB,MAAME,cAAc,GAAG,MAAM;;AAGjC;AACA;AACA;MACMH,OAAO,CAAC3c,SAAS,CAACtF,GAAV,MAAmB6B,MAApB,CAAP;KANF;;IASAqD,QAAQ,CAAC7J,EAAT,CAAY,SAAZ,EAAuB+mB,cAAvB;IAEA,OAAO,MAAM;MACXld,QAAQ,CAACrI,GAAT,CAAa,SAAb,EAAwBulB,cAAxB;KADF;GAZa,EAeZ,EAfY,CAAf;EAiBA,MAAMJ,iBAAiB,GAAGxW,KAAK,CAACwW,iBAAhC;EAEA,MAAMK,sBAAsB,GAAG;IAC7Btf,UAAU,CAAC3F,IAAD,EAAO4F,MAAM,GAAG,IAAhB,EAAsB;MAC9B,OAAOiE,QAAQ,CAACjH,GAAT,CAAa5C,IAAb,EAAmB4F,MAAnB,CAAP;;;GAFJ;;EAMA,MAAMsf,OAAO,GAAG,MAAMpd,QAAQ,CAAC/H,IAAT,CAAc,yBAAd,CAAtB;;EAEA,MAAMolB,MAAM,GAAG,MAAMrd,QAAQ,CAAC/H,IAAT,CAAc,0BAAd,CAArB;;EAEA,MAAMyd,SAAS,GAAG1Q,mBAAW,CAAC,CAAClJ,SAAD,EAAYlB,GAAZ,EAAiBwN,KAAjB,KAA2BjI,QAAQ,CAACgP,aAAT,CAAuBrT,SAAvB,EAAkClB,GAAlC,EAAuCwN,KAAvC,CAA5B,EAA2E,CAAEjI,QAAF,CAA3E,CAA7B;EAEA,OACEN;IACE,KAAK,EAAC,sBADR;IAEE,cAAaid,iBAAiB,IAAIA,iBAAiB,CAACniB,EAFtD;IAGE,cAAc,EAAGyiB,OAHnB;IAIE,aAAa,EAAGC,MAJlB;IAAA,UAMExd,eAACqW,sBAAD,CAA4B,QAA5B;MAAqC,KAAK,EAAGiH,sBAA7C;MAAA,UACEtd,eAAC,eAAD;QACE,OAAO,EAAGid,iBADZ;QAEE,QAAQ,EAAG9c,QAFb;QAGE,MAAM,EAAG2c,SAAS,CAACG,iBAAD,EAAoBpH,SAApB,CAHpB;QAIE,cAAc,EAAGL,6BAJnB;QAKE,mBAAmB,EAAGC;;;IAb9B;AAkBD;;ACzGc,MAAMgI,uBAAN,CAA8B;EAE3CnjB,WAAW,CAACgI,qBAAD,EAAwBJ,QAAxB,EAAkC/B,QAAlC,EAA4C;IACrD,MAAM;MACJ5C;QACE+E,qBAAqB,IAAI,EAF7B;IAIA,KAAKlG,SAAL,GAAiB+D,QAAjB;IACA,KAAK6Q,SAAL,GAAiB9O,QAAjB;IAEA,KAAKnB,UAAL,GAAkB6S,aAAM,CAAC,+EAAD,CAAxB;;IAEA,IAAIrW,MAAJ,EAAY;MACV,KAAKgI,QAAL,CAAchI,MAAd;;;IAGF,KAAKnB,SAAL,CAAe7E,IAAf,CAAoB,qBAApB,EAA2C,GAA3C,EAAgD,MAAM;MACpD,KAAKsc,OAAL;KADF;;;AAOJ;AACA;AACA;AACA;;;EACEtO,QAAQ,CAACe,SAAD,EAAY;IAClB,IAAI,CAACA,SAAL,EAAgB;MACd,MAAM,IAAIvP,KAAJ,CAAU,oBAAV,CAAN;;;IAGF,IAAI,OAAOuP,SAAP,KAAqB,QAAzB,EAAmC;MACjCA,SAAS,GAAGwN,YAAQ,CAACxN,SAAD,CAApB;KANgB;;;IAUlB,KAAKyN,MAAL,GAVkB;;IAalBzN,SAAS,CAAC0N,WAAV,CAAsB,KAAKjT,UAA3B,EAbkB;;IAgBlB,KAAK3E,SAAL,CAAehE,IAAf,CAAoB,wBAApB;;;AAIJ;AACA;;;EACE2b,MAAM,GAAG;IACP,MAAME,UAAU,GAAG,KAAKlT,UAAL,CAAgBkT,UAAnC;;IAEA,IAAIA,UAAJ,EAAgB;MACdA,UAAU,CAACC,WAAX,CAAuB,KAAKnT,UAA5B;;MAEA,KAAK3E,SAAL,CAAehE,IAAf,CAAoB,wBAApB;;;;EAIJyb,OAAO,GAAG;IACR1N,aAAM,CACJnG,eAAC0d,mBAAD;MACE,QAAQ,EAAG,KAAKthB,SADlB;MAEE,QAAQ,EAAG,KAAK4U;MAHd,EAKJ,KAAKjQ,UALD,CAAN;;IAQA,KAAK3E,SAAL,CAAehE,IAAf,CAAoB,0BAApB;;;EAGF7B,QAAQ,GAAG;IACT,IAAI,KAAKwK,UAAT,EAAqB;MACnBoF,aAAM,CAAC,IAAD,EAAO,KAAKpF,UAAZ,CAAN;;MAEA,KAAK3E,SAAL,CAAehE,IAAf,CAAoB,2BAApB;;;;AA3EuC;AAgF7CqlB,uBAAuB,CAACrjB,OAAxB,GAAkC,CAAE,wBAAF,EAA4B,UAA5B,EAAwC,UAAxC,CAAlC;;ACpGA,4BAAe;EACbyM,QAAQ,EAAE,CAAE,iBAAF,CADG;EAEbxE,eAAe,EAAE,CAAE,MAAF,EAAUob,uBAAV;AAFJ,CAAf;;ACWA,MAAME,GAAG,GAAG,IAAIC,uBAAJ,CAAQ,CAAE,EAAF,EAAM,EAAN,EAAU,CAAV,CAAR,CAAZ;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AACe,MAAM3b,UAAN,CAAiB;;AAGhC;AACA;AACA;EACE3H,WAAW,CAACsP,OAAO,GAAG,EAAX,EAAe;;AAG5B;AACA;AACA;IACI,KAAKtT,EAAL,GAAU,KAAKunB,QAAf;;AAGJ;AACA;AACA;;IACI,KAAK5Y,GAAL,GAAW0Y,GAAG,CAACrmB,IAAJ,EAAX;;AAGJ;AACA;AACA;;IACI,KAAKyJ,UAAL,GAAkB+c,gCAAmB,EAArC;;IAEA,KAAK/c,UAAL,CAAgBgd,YAAhB,CAA6B,4BAA7B,EAA2D,KAA3D;;IAEA,MAAM;MACJzX,SADI;MAEJ0X,QAFI;MAGJ9b,QAAQ,GAAG,KAAK+b,eAAL,CAAqBrU,OAArB,EAA8B,KAAK7I,UAAnC,CAHP;MAIJ+D,UAAU,GAAG;QACX8E,OALJ;;AAQJ;AACA;AACA;;IACI,KAAKoU,QAAL,GAAgBA,QAAhB;;AAGJ;AACA;AACA;;IACI,KAAKE,MAAL,GAAc;MACZpZ,UADY;MAEZhI,MAAM,EAAE;KAFV;IAKA,KAAK7B,GAAL,GAAWiH,QAAQ,CAACjH,GAApB;IAEA,KAAKkjB,MAAL,GAAcjc,QAAQ,CAACic,MAAvB;IAEA,KAAKljB,GAAL,CAAS,UAAT,EAAqB7C,IAArB,CAA0B,WAA1B;;IAEA,IAAIkO,SAAJ,EAAe;MACb,KAAKf,QAAL,CAAce,SAAd;;;;EAIJ4K,KAAK,GAAG;;IAGN,KAAKkN,KAAL,CAAW,eAAX,EAHM;;;IAMN,KAAKA,KAAL,CAAW,YAAX;;;EAGF5Z,OAAO,GAAG;;IAGR,KAAKvJ,GAAL,CAAS,UAAT,EAAqB7C,IAArB,CAA0B,cAA1B,EAHQ;;IAMR,KAAK6C,GAAL,CAAS,UAAT,EAAqB7C,IAArB,CAA0B,iBAA1B;;IAEA,KAAKimB,OAAL,CAAa,KAAb;;;AAIJ;AACA;AACA;AACA;;;EACExhB,YAAY,CAACC,MAAD,EAAS;IACnB,OAAO,IAAIwhB,OAAJ,CAAY,CAACC,OAAD,EAAUC,MAAV,KAAqB;MACtC,IAAI;QACF,KAAKtN,KAAL;QAEA,MAAM;UACJpU,MAAM,EAAEE,cADJ;UAEJD;YACE,KAAK9B,GAAL,CAAS,UAAT,EAAqB4B,YAArB,CAAkCC,MAAlC,CAHJ;;QAKA,KAAKoR,SAAL,CAAe;UACbpR,MAAM,EAAEE;SADV;;QAIA,KAAKohB,KAAL,CAAW,aAAX,EAA0B;UAAErhB;SAA5B;;QAEA,OAAOwhB,OAAO,CAAC;UAAExhB;SAAH,CAAd;OAdF,CAeE,OAAOhE,KAAP,EAAc;QACd,KAAKqlB,KAAL,CAAW,aAAX,EAA0B;UACxBrlB,KAAK,EAAEA,KADiB;UAExBgE,QAAQ,EAAEhE,KAAK,CAACgE,QAAN,IAAkB;SAF9B;;QAKA,OAAOyhB,MAAM,CAACzlB,KAAD,CAAb;;KAtBG,CAAP;;;AA4BJ;AACA;;;EACE0lB,UAAU,GAAG;IACX,OAAO,KAAKC,SAAL,EAAP;;;AAIJ;AACA;;;EACEA,SAAS,GAAG;IACV,MAAM;MAAE5hB;QAAW,KAAKyF,SAAL,EAAnB;;IAEA,OAAOoc,YAAY,CACjB7hB,MADiB,EAEjB,KAAKkhB,QAFY,EAGjBY,0BAHiB,CAAnB;;;AAQJ;AACA;;;EACErZ,QAAQ,CAAC0O,UAAD,EAAa;IACnB,IAAI,CAACA,UAAL,EAAiB;MACf,MAAM,IAAIld,KAAJ,CAAU,qBAAV,CAAN;;;IAGF,KAAKgd,MAAL;;IAEA,IAAI8K,gBAAQ,CAAC5K,UAAD,CAAZ,EAA0B;MACxBA,UAAU,GAAG6K,QAAQ,CAACC,aAAT,CAAuB9K,UAAvB,CAAb;;;IAGF,MAAM3N,SAAS,GAAG,KAAKvF,UAAvB;IAEAkT,UAAU,CAACD,WAAX,CAAuB1N,SAAvB;;IAEA,KAAK8X,KAAL,CAAW,QAAX;;;EAGFrK,MAAM,GAAG;IACP,KAAKsK,OAAL;;;AAIJ;AACA;AACA;AACA;;;EACEA,OAAO,CAAC7M,IAAI,GAAG,IAAR,EAAc;IACnB,MAAMlL,SAAS,GAAG,KAAKvF,UAAvB;UACMkT,UAAU,GAAG3N,SAAS,CAAC2N,UAD7B;;IAGA,IAAI,CAACA,UAAL,EAAiB;MACf;;;IAGF,IAAIzC,IAAJ,EAAU;MACR,KAAK4M,KAAL,CAAW,QAAX;;;IAGFnK,UAAU,CAACC,WAAX,CAAuB5N,SAAvB;;;AAIJ;AACA;AACA;;;EACE0Y,WAAW,CAAC1Q,QAAD,EAAW/F,KAAX,EAAkB;IAC3B,MAAMzD,UAAU,GAAG+E,WAAG,CAAC,KAAKtH,SAAL,GAAiBuC,UAAlB,EAA8B,CAAEwJ,QAAF,CAA9B,EAA4C/F,KAA5C,CAAtB;;IAEA,KAAK2F,SAAL,CAAe;MAAEpJ;KAAjB;;;AAKJ;AACA;AACA;;;EACEhN,GAAG,CAACO,IAAD,EAAO+W,OAAP,EAAgB;IACjB,KAAKnU,GAAL,CAAS,UAAT,EAAqBnD,GAArB,CAAyBO,IAAzB,EAA+B+W,OAA/B;;;AAIJ;AACA;AACA;AACA;AACA;AACA;AACA;;;EACE6O,eAAe,CAACrU,OAAD,EAAUtD,SAAV,EAAqB;IAClC,MAAM;MACJ2Y,iBAAiB,GAAG,EADhB;MAEJC,OAAO,GAAG,KAAKC,WAAL,EAFN;MAGJpY,QAAQ,GAAG;QACT6C,OAJJ;IAMA,MAAM3P,MAAM,GAAG,EACb,GAAG2P,OADU;MAEb7C,QAAQ,EAAE,EACR,GAAGA,QADK;QAERT;;KAJJ;IAQA,OAAO8Y,2BAAc,CAAC,CACpB;MAAEnlB,MAAM,EAAE,CAAE,OAAF,EAAWA,MAAX;KADU,EAEpB;MAAEoG,UAAU,EAAE,CAAE,OAAF,EAAW,IAAX;KAFM,EAGpBgf,IAHoB,EAIpB,GAAGH,OAJiB,EAKpB,GAAGD,iBALiB,CAAD,CAArB;;;AAUJ;AACA;;;EACEb,KAAK,CAAC/lB,IAAD,EAAOJ,IAAP,EAAa;IAChB,KAAKgD,GAAL,CAAS,UAAT,EAAqB7C,IAArB,CAA0BC,IAA1B,EAAgCJ,IAAhC;;;AAIJ;AACA;;;EACEsK,SAAS,GAAG;IACV,OAAO,KAAK2b,MAAZ;;;AAIJ;AACA;;;EACEhQ,SAAS,CAACzH,KAAD,EAAQ;IACf,KAAKyX,MAAL,GAAc,EACZ,GAAG,KAAKA,MADI;MAEZ,GAAGzX;KAFL;;IAKA,KAAK2X,KAAL,CAAW,SAAX,EAAsB,KAAK7b,SAAL,EAAtB;;;AAIJ;AACA;;;EACE4c,WAAW,GAAG;IACZ,OAAO,CACLG,cADK,EAELxV,mBAFK,EAGLyD,cAHK,EAILgS,eAJK,EAKLC,aALK,EAMLC,qBANK,CAAP;;;AAWJ;AACA;;;EACE5B,QAAQ,CAACxlB,IAAD,EAAO5B,QAAP,EAAiB2Y,OAAjB,EAA0B;IAChC,KAAKnU,GAAL,CAAS,UAAT,EAAqB3E,EAArB,CAAwB+B,IAAxB,EAA8B5B,QAA9B,EAAwC2Y,OAAxC;;;AAlR4B;;AAyRzB,SAASuP,YAAT,CAAsB7hB,MAAtB,EAA8BkhB,QAA9B,EAAwCY,aAAxC,EAAuD;EAE5D,MAAMc,aAAa,GAAG1B,QAAQ,GAAG;IAC/BA;GAD4B,GAE1B,EAFJ;EAIA,MAAM2B,aAAa,GAAGziB,kBAAK,CAACJ,MAAD,EAAS,CAACnD,IAAD,EAAO4O,KAAP,KAAiB;IACnD,IAAI,CAAE,SAAF,EAAa,OAAb,EAAuBqD,QAAvB,CAAgCjS,IAAhC,CAAJ,EAA2C;MACzC,OAAOf,SAAP;;;IAGF,OAAO2P,KAAP;GALyB,CAA3B;EAQA,OAAO,EACL,GAAGoX,aADE;IAEL,GAAGD,aAFE;IAGLd;GAHF;AAKD;;ACvUD;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AACO,SAASgB,gBAAT,CAA0BhW,OAA1B,EAAmC;EACxC,MAAM;IACJ9M,MADI;IAEJ,GAAG+iB;MACDjW,OAHJ;EAKA,MAAMvJ,UAAU,GAAG,IAAI4B,UAAJ,CAAe4d,IAAf,CAAnB;EAEA,OAAOxf,UAAU,CAACxD,YAAX,CAAwBC,MAAxB,EAAgCgjB,IAAhC,CAAqC,MAAM;IAChD,OAAOzf,UAAP;GADK,CAAP;AAGD;;;;;;;;;;;"}